{"version":3,"sources":["components/BackButton.tsx","containers/StyledBox.tsx","containers/InfiniteScrollFetch.tsx","utils/useIntersectionHook.tsx","components/FilterAds/Order.tsx","components/Cards/CardWine.tsx","components/FilterAds/index.tsx","utils/multiFilter.ts","pages/MyAds.tsx"],"names":["BackButton","aria-label","color","size","startIcon","onClick","navigate","StyledBox","props","sellColor","notActive","buyColor","boxShadow","p","m","mt","px","pt","width","typeAd","TypeAd","Sell","borderColor","bgcolor","borderRadius","children","useStyles","makeStyles","createStyles","root","display","flexDirection","alignItems","InfiniteScroll","classes","message","useLocation","pathname","split","rootMargin","threshold","React","entry","setEntry","node","setNode","observer","current","disconnect","window","IntersectionObserver","currentObserver","observe","useIntersect","ref","isOk","setIsOk","intersectionRatio","fetchMore","setIsLoading","isVisible","className","id","isLoading","CircularProgress","style","height","Order","fullWidth","htmlFor","native","value","order","onChange","event","setOrder","target","inputProps","name","QueryOrderBy","CreatedAtDesc","CreatedAtAsc","isAds","PriceDesc","PriceAsc","CardWine","ad","theme","useTheme","useMediaQuery","breakpoints","up","isBuy","Buy","pointerEvent","isActive","data-testid","pointerEvents","component","RouterLink","to","_id","underline","variant","wineName","align","harvest","abv","litersTo","priceFrom","datePosted","PurpleCheckbox","withStyles","deepPurple","checked","Checkbox","Filter","searchedWineCache","searchedWine","isShowAll","setIsShowAll","showFilter","setShowFilter","priceTo","price","liters","filterAds","setFilterAds","list","length","filtredAds","array","filters","filterKeys","Object","keys","filter","item","every","key","multiFilter","setFilteredList","Button","Collapse","in","Divider","FormControlLabel","control","label","MyAds","me","myInfo","undefined","active","setActive","ads","setAds","adsFiltered","setAdsFiltered","hideNotActive","setHideNotActive","useAdsForUserLazyQuery","variables","offset","limit","orderBy","user","onError","error","console","log","query","data","loading","adsForUser","catch","e","a","handleFetchMore","maxWidth","pageCount","map"],"mappings":"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","file":"static/js/10.a51e153e.chunk.js","sourcesContent":["import Button from '@material-ui/core/Button';\nimport * as React from 'react';\n// import { searchedWine } from '../cache';\nimport { navigate } from '@reach/router';\nimport ArrowBackIosIcon from '@material-ui/icons/ArrowBackIos';\n// import { TypeAd } from '../generated/graphql';\n\nexport const BackButton: React.FC = () => {\n  // // const searchedWineCache = searchedWine();\n  // // const { pathname } = useLocation();\n  // // if (searchedWineCache?.typeAd === TypeAd.Buy && pathname !== '/buy') {\n  // //   return (\n  // //     <Button\n  // //       component={Link}\n  // //       to='/buy'\n  // //       //variant='contained'\n  // //       color='primary'\n  // //       size='large'\n  // //       startIcon={<ArrowBackIosIcon />}\n  // //     >\n  // //       Compra\n  // //     </Button>\n  // //   );\n  // // } else if (\n  // //   searchedWineCache?.typeAd === TypeAd.Sell &&\n  // //   pathname !== '/sell'\n  // // ) {\n  //   return (\n  //     <Button\n  //       component={Link}\n  //       to='/sell'\n  //       //variant='contained'\n  //       color='primary'\n  //       size='large'\n  //       startIcon={<ArrowBackIosIcon />}\n  //     >\n  //       Vendi\n  //     </Button>\n  //   );\n  // } else\n  return (\n    <Button\n      aria-label='previous-page'\n      color='primary'\n      size='large'\n      startIcon={<ArrowBackIosIcon />}\n      onClick={() => navigate(-1)}\n    >\n      Torna indietro\n    </Button>\n  );\n};\n","import * as React from 'react';\nimport Box from '@material-ui/core/Box';\nimport { TypeAd } from '../generated/graphql';\n\ninterface BoxProps {\n  width: number;\n  typeAd: TypeAd;\n  children: React.ReactNode;\n  notActive?: boolean;\n}\n\nexport const StyledBox: React.FC<BoxProps> = (props) => {\n  const sellColor = props.notActive ? '#b2b2b2' : 'white';\n  const buyColor = props.notActive ? '#8a425a' : 'primary.main';\n\n  return (\n    <Box\n      boxShadow={3}\n      p={2}\n      m={2}\n      mt={2}\n      px={2}\n      pt={2}\n      width={props.width}\n      color={props.typeAd === TypeAd.Sell ? 'primary.main' : 'white'}\n      borderColor={props.typeAd === TypeAd.Sell ? 'white' : 'primary.main'}\n      bgcolor={props.typeAd === TypeAd.Sell ? sellColor : buyColor}\n      borderRadius={16}\n    >\n      {props.children}\n    </Box>\n  );\n};\n","import { useLocation } from '@reach/router';\nimport * as React from 'react';\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\nimport { useIntersect } from '../utils/useIntersectionHook';\nimport { makeStyles, createStyles } from '@material-ui/core';\nimport CircularProgress from '@material-ui/core/CircularProgress';\n\ninterface InfiniteScrollProps {\n  children: React.ReactNode;\n  fetchMore: () => void;\n  isVisible: boolean;\n  isLoading: boolean;\n  setIsLoading?: React.Dispatch<React.SetStateAction<boolean>>;\n}\n\nconst useStyles = makeStyles(() =>\n  createStyles({\n    root: {\n      display: 'flex',\n      flexDirection: 'column',\n      alignItems: 'center',\n    },\n  })\n);\n\nexport const InfiniteScroll: React.FC<InfiniteScrollProps> = (props) => {\n  const classes = useStyles();\n  const { pathname } = useLocation();\n  const message = pathname.split('/')[1] === 'messaggi';\n  const [ref, entry] = useIntersect({ threshold: 0 });\n  const [isOk, setIsOk] = React.useState<boolean>(true);\n  React.useEffect(() => {\n    if (entry && entry?.intersectionRatio >= 0.5 && isOk) {\n      void props.fetchMore();\n      props.setIsLoading && props.setIsLoading(true);\n      setIsOk(false);\n    } else if (entry?.intersectionRatio === 0 && !isOk) {\n      setIsOk(true);\n      props.setIsLoading && props.setIsLoading(false);\n    }\n  }, [entry?.intersectionRatio]);\n  if (message) {\n    return (\n      <>\n        {props.isVisible ? (\n          <div className={classes.root} id='page-bottom-boundary' ref={ref}>\n            {' '}\n            <ExpandMoreIcon />\n          </div>\n        ) : null}\n        {props.children}\n      </>\n    );\n  }\n\n  return (\n    <div className={classes.root}>\n      {props.children}\n      {props.isVisible ? (\n        props.isLoading ? (\n          <CircularProgress />\n        ) : (\n          <div id='page-bottom-boundary' ref={ref} style={{ height: 30 }}>\n            {' '}\n            <ExpandMoreIcon />\n          </div>\n        )\n      ) : null}\n    </div>\n  );\n};\n","import * as React from 'react';\n\nexport const useIntersect = ({\n  root = null,\n  rootMargin = '0px',\n  threshold = 0,\n}): [\n  React.Dispatch<React.SetStateAction<HTMLDivElement | null>>,\n  IntersectionObserverEntry | null\n] => {\n  const [entry, setEntry] = React.useState<IntersectionObserverEntry | null>(\n    null\n  );\n  const [node, setNode] = React.useState<HTMLDivElement | null>(null);\n\n  const observer = React.useRef<IntersectionObserver | null>(null);\n  React.useEffect(() => {\n    if (observer.current) {\n      observer.current.disconnect();\n    }\n    observer.current = new window.IntersectionObserver(\n      ([entry]) => setEntry(entry),\n      { root, rootMargin, threshold }\n    );\n\n    const { current: currentObserver } = observer;\n\n    if (node) {\n      currentObserver.observe(node);\n    }\n    return () => currentObserver.disconnect();\n  }, [node, root, rootMargin, threshold]);\n  return [setNode, entry];\n};\n","/* eslint-disable @typescript-eslint/no-unsafe-member-access */\nimport * as React from 'react';\nimport Select from '@material-ui/core/Select';\nimport FormControl from '@material-ui/core/FormControl';\nimport InputLabel from '@material-ui/core/InputLabel';\nimport { QueryOrderBy } from '../../generated/graphql';\n\ninterface OrderProps {\n  setOrder: React.Dispatch<React.SetStateAction<QueryOrderBy>>;\n  order: QueryOrderBy;\n  isAds?: boolean;\n}\n\nexport const Order: React.FC<OrderProps> = (props) => {\n  const handleChange = (event: React.ChangeEvent<{ value: unknown }>) => {\n    props.setOrder(event.target.value as QueryOrderBy);\n  };\n  return (\n    <FormControl fullWidth>\n      <InputLabel style={{ color: 'black' }} htmlFor='order'>\n        Ordine risultati\n      </InputLabel>\n      <Select\n        native\n        value={props.order}\n        onChange={handleChange}\n        inputProps={{\n          name: 'order',\n          id: 'order',\n        }}\n      >\n        <option aria-label='None' value='' />\n        <option value={QueryOrderBy.CreatedAtDesc}>Dal piu recente</option>\n        <option value={QueryOrderBy.CreatedAtAsc}>Dal meno recente</option>\n        {props.isAds ? (\n          <>\n            <option value={QueryOrderBy.PriceDesc}>Dal piu caro</option>\n            <option value={QueryOrderBy.PriceAsc}>Dal meno caro</option>\n          </>\n        ) : null}\n      </Select>\n    </FormControl>\n  );\n};\n","import * as React from 'react';\nimport { StyledBox } from '../../containers/StyledBox';\nimport Typography from '@material-ui/core/Typography';\nimport Link from '@material-ui/core/Link';\nimport { Link as RouterLink } from '@reach/router';\nimport { TypeAd } from '../../generated/graphql';\nimport { useTheme } from '@material-ui/core/styles';\nimport useMediaQuery from '@material-ui/core/useMediaQuery';\nimport { AdsWineResult } from '../../types';\n\nexport const CardWine: React.FC<{ ad: AdsWineResult | null }> = ({ ad }) => {\n  const theme = useTheme();\n  const matches = useMediaQuery(theme.breakpoints.up('sm'));\n  const width = matches ? 400 : 250;\n  const isBuy = ad?.typeAd === TypeAd.Buy ? true : false;\n  const pointerEvent = ad?.isActive ? 'auto' : 'none';\n  if (!ad) return null;\n  return (\n    <StyledBox\n      data-testid='card-wine'\n      width={width}\n      typeAd={ad.typeAd}\n      notActive={!ad.isActive}\n    >\n      <Link\n        aria-label='link-ad'\n        style={{ pointerEvents: pointerEvent, display: 'block' }}\n        component={RouterLink}\n        to={`/annunci/${ad._id}`}\n        underline='none'\n      >\n        <Typography\n          component='h5'\n          variant='h6'\n          color={isBuy ? 'textSecondary' : 'primary'}\n        >\n          {isBuy ? 'Compro' : 'Vendo'} {ad.wineName}{' '}\n          {/* {ad.wine.denominazioneZona} */}\n        </Typography>\n        <Typography\n          align='left'\n          variant='body1'\n          color={isBuy ? 'textSecondary' : 'primary'}\n        >\n          Annata: {ad.harvest}\n          <br />\n          Gradazione: {ad.abv} % Vol\n          <br />\n          Quantità: {ad.litersTo} l\n          <br />\n          Prezzo: {ad.priceFrom} euro al litro\n        </Typography>\n        <br />\n        <Typography\n          align='right'\n          variant='caption'\n          color={isBuy ? 'textSecondary' : 'primary'}\n        >\n          Annuncio pubblicato il {ad.datePosted}\n        </Typography>\n      </Link>\n    </StyledBox>\n  );\n};\n","import * as React from 'react';\nimport Button from '@material-ui/core/Button';\nimport Collapse from '@material-ui/core/Collapse';\nimport FilterListIcon from '@material-ui/icons/FilterList';\nimport Divider from '@material-ui/core/Divider';\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\nimport Checkbox, { CheckboxProps } from '@material-ui/core/Checkbox';\nimport { withStyles } from '@material-ui/core/styles';\nimport { deepPurple } from '@material-ui/core/colors';\nimport { searchedWine } from '../../cache';\nimport { IFilters, multiFilter } from '../../utils/multiFilter';\n\nexport const PurpleCheckbox = withStyles({\n  root: {\n    color: deepPurple[400],\n    '&$checked': {\n      color: deepPurple[600],\n    },\n  },\n  checked: {},\n})((props: CheckboxProps) => <Checkbox color='default' {...props} />);\n\ninterface FilterProps {\n  list: Array<any>;\n  filteredList?: Array<any>;\n  setFilteredList: React.Dispatch<\n    React.SetStateAction<Array<any> | undefined | null>\n  >;\n  children?: React.ReactNode;\n}\n\nexport const Filter: React.FC<FilterProps> = (props) => {\n  const searchedWineCache = searchedWine();\n  const [isShowAll, setIsShowAll] = React.useState<boolean>(false);\n  const [showFilter, setShowFilter] = React.useState<boolean>(false);\n  const [filterAds, setFilterAds] = React.useState<IFilters>({\n    priceTo: (priceTo: number) =>\n      priceTo <= (searchedWineCache?.price as number),\n    abv: (abv: number) =>\n      abv >= (searchedWineCache?.abv as number) - 0.5 ||\n      abv <= (searchedWineCache?.abv as number) + 0.5,\n    harvest: (harvest: number) =>\n      harvest === (searchedWineCache?.harvest as number) ||\n      harvest - 1 === (searchedWineCache?.harvest as number),\n    litersTo: (litersTo: number) =>\n      litersTo >= (searchedWineCache?.liters as number),\n  });\n  React.useEffect(() => {\n    if (props.list.length > 0) {\n      const filtredAds = multiFilter(props.list, filterAds);\n      props.setFilteredList(filtredAds);\n    }\n  }, [filterAds, props.list]);\n  const handleShowAll = () => {\n    if (!isShowAll) {\n      setFilterAds({\n        priceTo: () => true,\n        harvest: () => true,\n        abv: () => true,\n        litersTo: () => true,\n      });\n    } else {\n      setFilterAds({\n        priceTo: (priceTo: number) =>\n          priceTo <= (searchedWineCache?.price as number),\n        abv: (abv: number) =>\n          abv >= (searchedWineCache?.abv as number) - 0.5 ||\n          abv <= (searchedWineCache?.abv as number) + 0.5,\n        harvest: (harvest: number) =>\n          harvest === (searchedWineCache?.harvest as number) ||\n          harvest - 1 === (searchedWineCache?.harvest as number),\n        litersTo: (litersTo: number) =>\n          litersTo >= (searchedWineCache?.liters as number),\n      });\n    }\n    setIsShowAll(!isShowAll);\n  };\n  return (\n    <>\n      <Button\n        onClick={() => setShowFilter(!showFilter)}\n        aria-label='filter'\n        color='primary'\n        size='large'\n        startIcon={<FilterListIcon />}\n      >\n        Filtri\n      </Button>\n      <Collapse in={showFilter}>\n        {props.children}\n        <Divider />\n        <FormControlLabel\n          control={\n            <PurpleCheckbox\n              checked={isShowAll}\n              onChange={handleShowAll}\n              name='showAll'\n            />\n          }\n          label='Mostra tutti gli annunci per questo vino'\n        />\n      </Collapse>\n    </>\n  );\n};\n","export interface IFilters {\n  [key: string]: (value: any) => boolean;\n}\n\ninterface IArray {\n  [key: string]: any;\n}\n\n// function taken from https://gist.github.com/jherax/f11d669ba286f21b7a2dcff69621eb72\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nexport function multiFilter(\n  array: Array<IArray>,\n  filters: IFilters\n): Array<IArray> {\n  const filterKeys = Object.keys(filters);\n  return array.filter((item) => {\n    // validates all filter criteria\n    return filterKeys.every((key) => {\n      // ignores non-function predicates\n      if (typeof filters[key] !== 'function') return true;\n      return filters[key](item[key]);\n    });\n  });\n}\n","import * as React from 'react';\nimport Typography from '@material-ui/core/Typography';\nimport CssBaseline from '@material-ui/core/CssBaseline';\nimport Container from '@material-ui/core/Container';\nimport { RouteComponentProps } from '@reach/router';\nimport {\n  QueryOrderBy,\n  useAdsForUserLazyQuery,\n  AdsWineQuery,\n} from '../generated/graphql';\nimport { BackButton } from '../components/BackButton';\nimport { Order } from '../components/FilterAds/Order';\nimport { InfiniteScroll } from '../containers/InfiniteScrollFetch';\nimport { myInfo } from '../cache';\nimport { DeepExtractType } from 'ts-deep-extract-types';\nimport { CardWine } from '../components/Cards/CardWine';\nimport { AdsWineResult } from '../types';\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\nimport Divider from '@material-ui/core/Divider';\nimport { PurpleCheckbox } from '../components/FilterAds';\nimport { Loading } from '../components/Loading';\n\nconst MyAds: React.FC<RouteComponentProps> = () => {\n  const me = myInfo();\n  const [active, setActive] = React.useState<true | undefined>(undefined);\n  const [ads, setAds] = React.useState<\n    DeepExtractType<AdsWineQuery, ['ads']>['ads']\n  >([]);\n  const [adsFiltered, setAdsFiltered] = React.useState<\n    DeepExtractType<AdsWineQuery, ['ads']>['ads']\n  >([]);\n  const [order, setOrder] = React.useState<QueryOrderBy>(\n    QueryOrderBy.CreatedAtDesc\n  );\n  const [hideNotActive, setHideNotActive] = React.useState<boolean>(false);\n  const [query, { data, loading, error, fetchMore }] = useAdsForUserLazyQuery({\n    variables: {\n      offset: 0,\n      limit: 4,\n      orderBy: QueryOrderBy.CreatedAtDesc,\n      user: me?._id as string,\n      isActive: active,\n    },\n    onError: (error) => console.log(error),\n  });\n  React.useEffect(() => {\n    if (me?._id) {\n      query();\n    }\n  }, [me]);\n  React.useEffect(() => {\n    if (data?.adsForUser) {\n      setAds(data.adsForUser.ads);\n    }\n  }, [data]);\n  React.useEffect(() => {\n    if (ads && ads.length && fetchMore) {\n      fetchMore({\n        variables: { orderBy: order, limit: ads.length },\n      }).catch((e) => console.log(e));\n    }\n  }, [order]);\n  React.useEffect(() => {\n    setAdsFiltered(ads);\n    if (hideNotActive && ads?.length) {\n      setAdsFiltered(ads?.filter((a) => a?.isActive));\n    }\n  }, [hideNotActive, ads]);\n  const handleChange = () => {\n    setHideNotActive(!hideNotActive);\n    if (hideNotActive) {\n      setActive(undefined);\n      setAdsFiltered(ads);\n    } else {\n      setActive(true);\n    }\n  };\n\n  if (loading) {\n    return <Loading />;\n  }\n\n  if (!me?._id || error) return <div>error</div>;\n\n  if (ads?.length === 0) {\n    return <div>Non hai ancora creato annunci</div>;\n  }\n\n  if (adsFiltered?.length) {\n    const handleFetchMore = async () => {\n      if (fetchMore) {\n        try {\n          await fetchMore({\n            variables: {\n              offset: adsFiltered?.length,\n              orderBy: order,\n              isActive: active,\n            },\n          });\n        } catch (e) {\n          console.log(e);\n        }\n      }\n    };\n    return (\n      <Container component='main' maxWidth='xs'>\n        <CssBaseline />\n        <BackButton />\n        <br />\n        <Typography color='primary' component='h3' variant='h5'>\n          Gli annunci che hai creato\n        </Typography>\n        <br />\n        <Order isAds setOrder={setOrder} order={order} />\n        <Divider />\n        <FormControlLabel\n          control={\n            <PurpleCheckbox\n              checked={hideNotActive}\n              onChange={handleChange}\n              name='showAll'\n            />\n          }\n          label='Nascondi gli annunci inattivi'\n        />\n        <InfiniteScroll\n          fetchMore={handleFetchMore}\n          isVisible={adsFiltered.length !== data?.adsForUser?.pageCount}\n          isLoading={loading}\n        >\n          {' '}\n          {adsFiltered.map((ad) => (\n            <CardWine key={ad && ad._id} ad={ad as AdsWineResult} />\n          ))}\n        </InfiniteScroll>\n      </Container>\n    );\n  }\n  return <div>gravissimo errore</div>;\n};\n\nexport default MyAds;\n"],"sourceRoot":""}