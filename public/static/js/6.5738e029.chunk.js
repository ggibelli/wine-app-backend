(this["webpackJsonpwine-app-frontend"]=this["webpackJsonpwine-app-frontend"]||[]).push([[6],{453:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var i=n(4),o=n(439),a=(n(0),n(41)),r=n(454),c=n.n(r),l=function(){return Object(i.jsx)(o.a,{"aria-label":"previous-page",color:"primary",size:"large",startIcon:Object(i.jsx)(c.a,{}),onClick:function(){return Object(a.c)(-1)},children:"Torna indietro"})}},454:function(e,t,n){"use strict";var i=n(46),o=n(47);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=o(n(0)),r=(0,i(n(48)).default)(a.createElement("path",{d:"M11.67 3.87L9.9 2.1 0 12l9.9 9.9 1.77-1.77L3.54 12z"}),"ArrowBackIos");t.default=r},455:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(4),o=(n(0),n(448)),a=n(15),r=function(e){var t=e.notActive?"#b2b2b2":"white",n=e.notActive?"#8a425a":"primary.main";return Object(i.jsx)(o.a,{boxShadow:3,p:2,m:2,mt:2,px:2,pt:2,width:e.width,color:e.typeAd===a.k.Sell?"primary.main":"white",borderColor:e.typeAd===a.k.Sell?"white":"primary.main",bgcolor:e.typeAd===a.k.Sell?t:n,borderRadius:16,children:e.children})}},456:function(e,t,n){"use strict";var i=n(46),o=n(47);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=o(n(0)),r=(0,i(n(48)).default)(a.createElement("path",{d:"M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z"}),"ExpandMore");t.default=r},459:function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));var i=n(4),o=n(81),a=n.n(o),r=n(104),c=n(26),l=n(439),d=(n(0),n(23)),s=n(15),u=n(132),v=function(e){var t=e.id,n=e.isBuy,o=Object(u.c)(),v=Object(s.L)({onCompleted:function(e){var t,n;if(null===(t=e.updateNegotiation)||void 0===t||null===(n=t.errors)||void 0===n?void 0:n.length){var i,o=null===(i=e.updateNegotiation)||void 0===i?void 0:i.errors.map((function(e){return null===e||void 0===e?void 0:e.text}));Object(d.d)({type:"error",message:"".concat(o.toString())})}else Object(d.d)({message:"trattativa chiusa con successo",type:"success"})},onError:function(e){return Object(d.d)({type:"error",message:e.message})}}),j=Object(c.a)(v,2),b=j[0],p=j[1].loading,h=function(){var e=Object(r.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b({variables:{negotiation:{_id:t,isConcluded:!0}}});case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(i.jsx)(l.a,{"aria-label":"close-negotiation",className:n?o.buyButton:o.sellButton,disabled:p,onClick:h,children:"Dichiara chiusa la trattativa"})}},462:function(e,t,n){"use strict";n.d(t,"a",(function(){return E}));var i=n(4),o=n(26),a=n(439),r=n(0),c=n(15),l=n(132),d=n(448),s=n(441),u=n(442),v=n(443),j=n(381),b=n(1),p=n(5),h=(n(10),n(7)),f=n(8),O=n(90),m=r.forwardRef((function(e,t){var n=e.children,i=e.classes,o=e.className,a=e.disableTypography,c=void 0!==a&&a,l=Object(p.a)(e,["children","classes","className","disableTypography"]);return r.createElement("div",Object(b.a)({className:Object(h.a)(i.root,o),ref:t},l),c?n:r.createElement(O.a,{component:"h2",variant:"h6"},n))})),x=Object(f.a)({root:{margin:0,padding:"16px 24px",flex:"0 0 auto"}},{name:"MuiDialogTitle"})(m),g=n(23),y=function(e){var t=e.review,n=e.disabled,r=e.closeModal,l=Object(c.t)({onCompleted:function(e){var t,n;if(null===(t=e.createReview)||void 0===t||null===(n=t.errors)||void 0===n?void 0:n.length){var i,o=null===(i=e.createReview)||void 0===i?void 0:i.errors.map((function(e){return null===e||void 0===e?void 0:e.text}));Object(g.d)({type:"error",message:"".concat(o.toString())})}else Object(g.d)({type:"success",message:"Recensione creata con successo"})},onError:function(e){return Object(g.d)({type:"error",message:e.message})}}),d=Object(o.a)(l,2),s=d[0],u=d[1].loading;return Object(i.jsx)(a.a,{disabled:n||u,"aria-label":"review",onClick:function(){r&&r(),s({variables:{review:t}})},color:"primary",children:"Recensisci"})},C={.5:"Useless",1:"Useless+",1.5:"Poor",2:"Poor+",2.5:"Ok",3:"Ok+",3.5:"Good",4:"Good+",4.5:"Excellent",5:"Excellent+"},E=function(e){var t=e.idUser,n=e.idNegotiation,b=e.type,p=r.useState(!1),h=Object(o.a)(p,2),f=h[0],O=h[1],m=r.useState(2),g=Object(o.a)(m,2),E=g[0],w=g[1],N=r.useState(-1),_=Object(o.a)(N,2),A=_[0],k=_[1],B=r.useState(""),z=Object(o.a)(B,2),S=z[0],M=z[1],R=Object(l.c)(),L=Object(l.d)(),P=Object(l.b)(),T=function(){O(!1)};return Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)(a.a,{"aria-label":"review",className:b===c.k.Buy?R.buyButton:R.sellButton,onClick:function(){O(!0)},children:"Lascia una recensione"}),Object(i.jsx)("div",{style:{display:"none"},children:Object(i.jsxs)(s.a,{open:f,onClose:T,"aria-labelledby":"form-dialog-title",children:[Object(i.jsx)(x,{id:"form-dialog-title",children:"Recensisci la trattativa"}),Object(i.jsxs)(u.a,{children:[Object(i.jsxs)("div",{className:P.root,children:[Object(i.jsx)(l.a,{name:"hover-feedback",value:E,precision:.5,onChange:function(e,t){w(t)},onChangeActive:function(e,t){k(t)}}),null!==E&&Object(i.jsx)(d.a,{ml:2,children:C[-1!==A?A:E]})]}),Object(i.jsx)(j.a,{color:"primary",multiline:!0,rows:4,value:S,error:S.length>0&&S.length<=5,helperText:"Lunghezza minima 5 caratteri",onChange:function(e){M(e.target.value)},InputLabelProps:{style:{color:"#6d1331"}},InputProps:{className:L.inputSell,classes:{underline:L.underlineSell}},id:"outlined-multiline-flexible",label:"Recensione",placeholder:"Ottima persona con cui...."})]}),Object(i.jsxs)(v.a,{children:[Object(i.jsx)(a.a,{"aria-label":"close-modal",onClick:T,color:"primary",children:"Cancel"}),Object(i.jsx)(y,{disabled:S.length<=5,review:{forUser:t,rating:E,negotiation:n,content:S,type:b},closeModal:T})]})]})})]})}},485:function(e,t,n){"use strict";var i=n(1),o=n(49),a=n(5),r=n(0),c=n(7),l=(n(10),n(235)),d=n(8),s=n(29),u=n(36),v=n(35),j=n(16),b=r.forwardRef((function(e,t){var n=e.children,d=e.classes,b=e.className,p=e.collapsedHeight,h=void 0===p?"0px":p,f=e.component,O=void 0===f?"div":f,m=e.disableStrictModeCompat,x=void 0!==m&&m,g=e.in,y=e.onEnter,C=e.onEntered,E=e.onEntering,w=e.onExit,N=e.onExited,_=e.onExiting,A=e.style,k=e.timeout,B=void 0===k?s.b.standard:k,z=e.TransitionComponent,S=void 0===z?l.a:z,M=Object(a.a)(e,["children","classes","className","collapsedHeight","component","disableStrictModeCompat","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"]),R=Object(v.a)(),L=r.useRef(),P=r.useRef(null),T=r.useRef(),D="number"===typeof h?"".concat(h,"px"):h;r.useEffect((function(){return function(){clearTimeout(L.current)}}),[]);var I=R.unstable_strictMode&&!x,H=r.useRef(null),F=Object(j.a)(t,I?H:void 0),U=function(e){return function(t,n){if(e){var i=I?[H.current,t]:[t,n],a=Object(o.a)(i,2),r=a[0],c=a[1];void 0===c?e(r):e(r,c)}}},Q=U((function(e,t){e.style.height=D,y&&y(e,t)})),q=U((function(e,t){var n=P.current?P.current.clientHeight:0,i=Object(u.a)({style:A,timeout:B},{mode:"enter"}).duration;if("auto"===B){var o=R.transitions.getAutoHeightDuration(n);e.style.transitionDuration="".concat(o,"ms"),T.current=o}else e.style.transitionDuration="string"===typeof i?i:"".concat(i,"ms");e.style.height="".concat(n,"px"),E&&E(e,t)})),G=U((function(e,t){e.style.height="auto",C&&C(e,t)})),V=U((function(e){var t=P.current?P.current.clientHeight:0;e.style.height="".concat(t,"px"),w&&w(e)})),J=U(N),W=U((function(e){var t=P.current?P.current.clientHeight:0,n=Object(u.a)({style:A,timeout:B},{mode:"exit"}).duration;if("auto"===B){var i=R.transitions.getAutoHeightDuration(t);e.style.transitionDuration="".concat(i,"ms"),T.current=i}else e.style.transitionDuration="string"===typeof n?n:"".concat(n,"ms");e.style.height=D,_&&_(e)}));return r.createElement(S,Object(i.a)({in:g,onEnter:Q,onEntered:G,onEntering:q,onExit:V,onExited:J,onExiting:W,addEndListener:function(e,t){var n=I?e:t;"auto"===B&&(L.current=setTimeout(n,T.current||0))},nodeRef:I?H:void 0,timeout:"auto"===B?null:B},M),(function(e,t){return r.createElement(O,Object(i.a)({className:Object(c.a)(d.container,b,{entered:d.entered,exited:!g&&"0px"===D&&d.hidden}[e]),style:Object(i.a)({minHeight:D},A),ref:F},t),r.createElement("div",{className:d.wrapper,ref:P},r.createElement("div",{className:d.wrapperInner},n)))}))}));b.muiSupportAuto=!0,t.a=Object(d.a)((function(e){return{container:{height:0,overflow:"hidden",transition:e.transitions.create("height")},entered:{height:"auto",overflow:"visible"},hidden:{visibility:"hidden"},wrapper:{display:"flex"},wrapperInner:{width:"100%"}}}),{name:"MuiCollapse"})(b)},486:function(e,t,n){"use strict";var i=n(46),o=n(47);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=o(n(0)),r=(0,i(n(48)).default)(a.createElement("path",{d:"M16.5 3c-1.74 0-3.41.81-4.5 2.09C10.91 3.81 9.24 3 7.5 3 4.42 3 2 5.42 2 8.5c0 3.78 3.4 6.86 8.55 11.54L12 21.35l1.45-1.32C18.6 15.36 22 12.28 22 8.5 22 5.42 19.58 3 16.5 3zm-4.4 15.55l-.1.1-.1-.1C7.14 14.24 4 11.39 4 8.5 4 6.5 5.5 5 7.5 5c1.54 0 3.04.99 3.57 2.36h1.87C13.46 5.99 14.96 5 16.5 5c2 0 3.5 1.5 3.5 3.5 0 2.89-3.14 5.74-7.9 10.05z"}),"FavoriteBorder");t.default=r},487:function(e,t,n){"use strict";var i=n(46),o=n(47);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=o(n(0)),r=(0,i(n(48)).default)(a.createElement("path",{d:"M12 8l-6 6 1.41 1.41L12 10.83l4.59 4.58L18 14z"}),"ExpandLess");t.default=r},509:function(e,t,n){"use strict";n.r(t);var i=n(4),o=n(26),a=n(0),r=n(41),c=n(15),l=n(23),d=n(90),s=n(439),u=n(440),v=n(486),j=n.n(v),b=n(380),p=n(175),h=n.n(p),f=n(34),O=n.n(f),m=function(e){var t=e.ad,n=Object(c.K)({onError:function(e){return console.log(e)},update:function(e,n){var i=O.a.cloneDeep(e.readQuery({query:c.b}));if((null===i||void 0===i?void 0:i.me.savedAds)&&s){var o=null===i||void 0===i?void 0:i.me.savedAds.findIndex((function(e){return e._id===(null===t||void 0===t?void 0:t._id)}));null===i||void 0===i||i.me.savedAds.splice(o,1)}else if(null===i||void 0===i?void 0:i.me.savedAds){var a,r;null===i||void 0===i||i.me.savedAds.push(null===(a=n.data)||void 0===a||null===(r=a.saveAd)||void 0===r?void 0:r.response)}e.writeQuery({query:c.b,data:i})}}),r=Object(o.a)(n,1)[0],l=a.useState(!1),d=Object(o.a)(l,2),s=d[0],u=d[1];return Object(i.jsx)(b.a,{"aria-label":"save",onClick:function(){return e=null===t||void 0===t?void 0:t._id,r({variables:{id:e}}),void u(!s);var e},children:s?Object(i.jsx)(h.a,{}):Object(i.jsx)(j.a,{})})},x=n(441),g=n(443),y=n(442),C=function(e){var t=e.handleClose,n=e.open,o=e.createNegotiation;return Object(i.jsx)("div",{children:Object(i.jsxs)(x.a,{open:n,onClose:t,"aria-labelledby":"open-negotiation",children:[Object(i.jsx)(y.a,{children:Object(i.jsx)(s.a,{"aria-label":"open-negotiation",onClick:function(){o(),t()},children:"Apri la trattativa"})}),Object(i.jsx)(g.a,{children:Object(i.jsx)(s.a,{onClick:t,color:"primary",children:"Cancel"})})]})})},E=n(455),w=n(132),N=function(e){var t,n,r,l,v=e.ad,j=e.createNegotiation,b=e.me,p=Object(w.c)(),h=(null===v||void 0===v?void 0:v.typeAd)===c.k.Buy,f=a.useState(!1),O=Object(o.a)(f,2),x=O[0],g=O[1],y=function(){g(!0)},N=function(){g(!1)},_=function(){var e;return(null===b||void 0===b?void 0:b._id)===(null===v||void 0===v?void 0:v.postedBy._id)?Object(i.jsx)(s.a,{"aria-label":"edit-ad",className:h?p.buyButton:p.sellButton,children:"Modifica l annuncio"}):(null===b||void 0===b||null===(e=b.negotiations)||void 0===e?void 0:e.find((function(e){return(null===e||void 0===e?void 0:e.ad._id)===(null===v||void 0===v?void 0:v._id)})))?Object(i.jsx)("div",{children:"Negoziazione gia aperta"}):(null===v||void 0===v?void 0:v.isActive)?Object(i.jsxs)(i.Fragment,{children:[Object(i.jsxs)(s.a,{"aria-label":"open-negotiation-dialog",className:h?p.buyButton:p.sellButton,onClick:y,children:["Contatta il ",(null===v||void 0===v?void 0:v.typeAd)===c.k.Buy?"compratore":"venditore"]}),Object(i.jsx)(C,{handleClose:N,open:x,createNegotiation:j})]}):Object(i.jsx)(d.a,{children:"Annuncio non piu attivo "})},A="AdWine"===(null===v||void 0===v?void 0:v.__typename)?v:null;return Object(i.jsxs)(E.a,{width:1,typeAd:null===v||void 0===v?void 0:v.typeAd,children:[(null===v||void 0===v?void 0:v.postedBy._id)!==(null===b||void 0===b?void 0:b._id)?Object(i.jsx)(m,{ad:v}):null,Object(i.jsxs)(d.a,{component:"h5",variant:"h5",children:["L'utente ",null===v||void 0===v?void 0:v.postedBy.firstName," ",h?"compra":"vende",":"]}),Object(i.jsxs)(d.a,{align:"left",variant:"h6",children:[null===A||void 0===A?void 0:A.wineName," ",null===A||void 0===A||null===(t=A.wine)||void 0===t?void 0:t.denominazioneZona,Object(i.jsx)("br",{}),"Annata: ",null===v||void 0===v?void 0:v.harvest,Object(i.jsx)("br",{}),"Gradazione: ",null===v||void 0===v?void 0:v.abv," % Vol",Object(i.jsx)("br",{}),"Quantit\xe0: ",null===A||void 0===A?void 0:A.litersTo,Object(i.jsx)("br",{}),"Prezzo: ",null===v||void 0===v?void 0:v.priceFrom," euro al litro"]}),Object(i.jsx)("br",{}),Object(i.jsx)(d.a,{align:"left",component:"h5",variant:"h5",children:"Indirizzo"}),Object(i.jsx)("br",{}),Object(i.jsxs)(d.a,{align:"left",variant:"h6",children:["Regione: ",null===v||void 0===v||null===(n=v.address)||void 0===n?void 0:n.regione,Object(i.jsx)("br",{}),"Provincia: ",null===v||void 0===v||null===(r=v.address)||void 0===r?void 0:r.provincia,Object(i.jsx)("br",{}),"Comune: ",null===v||void 0===v||null===(l=v.address)||void 0===l?void 0:l.comune]}),Object(i.jsx)("br",{}),Object(i.jsx)(_,{}),Object(i.jsxs)(u.a,{container:!0,justify:"space-between",children:[Object(i.jsxs)(d.a,{align:"left",variant:"caption",children:["Annuncio visualizzato ",null===v||void 0===v?void 0:v.numberViews," volte"]}),Object(i.jsxs)(d.a,{align:"right",variant:"caption",children:["Negoziazioni attive: ",null===v||void 0===v?void 0:v.activeNegotiations]})]})]})},_=n(437),A=n(438),k=n(453),B=n(97),z=n(433),S=n(429),M=n(426),R=n(459),L=n(485),P=n(456),T=n.n(P),D=n(487),I=n.n(D),H=n(154),F=n(462),U=function(e){var t,n,c=e.data,l=e.showNegotiations,u=Object(w.c)(),v=a.useState(!1),j=Object(o.a)(v,2),p=j[0],h=j[1];return c.loading?Object(i.jsx)(H.a,{}):c.error?Object(i.jsx)("div",{children:"error"}):Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)(b.a,{"aria-label":"show-open-negotiations","data-testid":"negotiationsAd",onClick:function(){p||l(),h(!p)},children:p?Object(i.jsx)(I.a,{}):Object(i.jsx)(T.a,{})}),Object(i.jsx)(L.a,{in:p,children:Object(i.jsx)(z.a,{"aria-label":"negotiations",children:null===c||void 0===c||null===(t=c.data)||void 0===t||null===(n=t.negotiationsForAd)||void 0===n?void 0:n.map((function(e){return Object(i.jsxs)("div",{children:[Object(i.jsx)(S.a,{children:Object(i.jsxs)("div",{children:[Object(i.jsx)(d.a,{color:"primary",component:"h3",variant:"h5",children:e.createdBy.firstName}),Object(i.jsx)("br",{}),Object(i.jsxs)(d.a,{color:"secondary",variant:"body1",children:["aperta il ",e.dateCreated]}),Object(i.jsx)(d.a,{color:"secondary",variant:"body1",children:e.dateConcluded?"chiusa il ".concat(e.dateConcluded):null}),Object(i.jsx)("br",{}),Object(i.jsx)(s.a,{"aria-label":"open-chat",className:u.buyButton,component:r.a,to:"/messaggi/".concat(e._id),children:"Vai alla chat"}),Object(i.jsx)("br",{}),e.isConcluded?Object(i.jsx)(F.a,{idNegotiation:e._id,idUser:e.createdBy._id,type:e.type}):Object(i.jsx)(R.a,{isBuy:!0,id:e._id})]})}),Object(i.jsx)(M.a,{})]},e._id)}))})})]})};t.default=function(){var e,t,n,s=a.useState(void 0),u=Object(o.a)(s,2),v=u[0],j=u[1],b=Object(r.e)().id,p=Object(c.n)({variables:{id:b},onCompleted:function(e){return(null===e||void 0===e?void 0:e.ad)?j(null===e||void 0===e?void 0:e.ad):null},onError:function(e){return console.log(e)}}),h=p.data,f=p.loading,O=p.error;a.useEffect((function(){(null===h||void 0===h?void 0:h.ad)&&j(null===h||void 0===h?void 0:h.ad)}),[null===h||void 0===h||null===(e=h.ad)||void 0===e?void 0:e.activeNegotiations]);var m=Object(c.s)({onCompleted:function(e){var t,n;if(null===(t=e.createNegotiation)||void 0===t||null===(n=t.errors)||void 0===n?void 0:n.length){var i,o=null===(i=e.createNegotiation)||void 0===i?void 0:i.errors.map((function(e){return null===e||void 0===e?void 0:e.text}));Object(l.d)({type:"error",message:"".concat(o.toString())})}else Object(l.d)({message:"trattativa creata con successo",type:"success"})},onError:function(e){return Object(l.d)({type:"error",message:"errore durante creazione trattativa: ".concat(e.message)})},update:function(e,t){var n,i;Object(B.d)(e,null===(n=t.data)||void 0===n||null===(i=n.createNegotiation)||void 0===i?void 0:i.response)}}),x=Object(o.a)(m,1)[0],g=Object(c.F)(),y=Object(o.a)(g,2),C=y[0],E=y[1],z=Object(w.c)();if(O&&!f)return Object(i.jsx)("div",{children:"Errore"});var S,M=null===h||void 0===h||null===(t=h.me)||void 0===t||null===(n=t.negotiations)||void 0===n?void 0:n.filter((function(e){var t;return e.ad._id===(null===h||void 0===h||null===(t=h.ad)||void 0===t?void 0:t._id)})),R=(null===v||void 0===v?void 0:v.typeAd)===c.k.Buy?"L'acquirente":"Il venditore";return(null===v||void 0===v?void 0:v._id)?Object(i.jsxs)(_.a,{component:"main",maxWidth:"xs",children:[Object(i.jsx)(A.a,{}),Object(i.jsx)(k.a,{}),Object(i.jsxs)("div",{className:z.paper,children:[Object(i.jsxs)(d.a,{color:"primary",component:"h3",variant:"h5",children:["Contatta ",R]}),Object(i.jsx)(d.a,{color:"secondary",variant:"body1",children:"Questo \xe8 uno degli annunci che abbiamo selezionato per te: verifica anche tu i parametri e decidi se procedere."})]}),Object(i.jsx)(N,{ad:v,createNegotiation:function(){var e={forUserAd:null===v||void 0===v?void 0:v.postedBy._id,ad:null===v||void 0===v?void 0:v._id,type:null===v||void 0===v?void 0:v.typeAd};x({variables:{negotiation:e}})},me:null===h||void 0===h?void 0:h.me}),(null===h||void 0===h||null===(S=h.me)||void 0===S?void 0:S._id)===v.postedBy._id&&(null===M||void 0===M?void 0:M.length)?Object(i.jsx)(U,{data:E,showNegotiations:function(){C({variables:{ad:b}})}}):null]}):Object(i.jsx)(H.a,{})}}}]);
//# sourceMappingURL=6.5738e029.chunk.js.map