(this["webpackJsonpwine-app-frontend"]=this["webpackJsonpwine-app-frontend"]||[]).push([[6],{454:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var i=n(4),a=n(439),o=(n(0),n(41)),r=n(455),c=n.n(r),l=function(){return Object(i.jsx)(a.a,{"aria-label":"previous-page",color:"primary",size:"large",startIcon:Object(i.jsx)(c.a,{}),onClick:function(){return Object(o.c)(-1)},children:"Torna indietro"})}},455:function(e,t,n){"use strict";var i=n(53),a=n(54);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=a(n(0)),r=(0,i(n(55)).default)(o.createElement("path",{d:"M11.67 3.87L9.9 2.1 0 12l9.9 9.9 1.77-1.77L3.54 12z"}),"ArrowBackIos");t.default=r},456:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(4),a=(n(0),n(449)),o=n(14),r=function(e){var t=e.notActive?"#b2b2b2":"white",n=e.notActive?"#8a425a":"primary.main";return Object(i.jsx)(a.a,{boxShadow:3,p:2,m:2,mt:2,px:2,pt:2,width:e.width,color:e.typeAd===o.i.Sell?"primary.main":"white",borderColor:e.typeAd===o.i.Sell?"white":"primary.main",bgcolor:e.typeAd===o.i.Sell?t:n,borderRadius:16,children:e.children})}},457:function(e,t,n){"use strict";var i=n(53),a=n(54);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=a(n(0)),r=(0,i(n(55)).default)(o.createElement("path",{d:"M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z"}),"ExpandMore");t.default=r},460:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var i=n(4),a=n(28),o=n(0),r=n(439),c=n(441),l=n(443),d=n(442),s=n(56),u=n.n(s),v=n(82),j=n(19),b=n(14),p=function(e){var t=e.id,n=e.handleClose,o=Object(b.M)({onCompleted:function(e){var t,n;if(null===(t=e.updateNegotiation)||void 0===t||null===(n=t.errors)||void 0===n?void 0:n.length){var i,a=null===(i=e.updateNegotiation)||void 0===i?void 0:i.errors.map((function(e){return null===e||void 0===e?void 0:e.text}));Object(j.d)({type:"error",message:"".concat(a.toString())})}else Object(j.d)({message:"trattativa chiusa con successo",type:"success"})},onError:function(e){return Object(j.d)({type:"error",message:e.message})}}),c=Object(a.a)(o,2),l=c[0],d=c[1].loading,s=function(){var e=Object(v.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n(),e.next=3,l({variables:{negotiation:{_id:t,isConcluded:!0}}});case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(i.jsx)(r.a,{"aria-label":"close-negotiation",disabled:d,onClick:s,children:"Dichiara chiusa la trattativa"})},h=n(93),O=function(e){var t=e.id,n=e.handleClose,o=Object(b.t)({onCompleted:function(e){var t,n;if(null===(t=e.deleteNegotiation)||void 0===t||null===(n=t.errors)||void 0===n?void 0:n.length){var i,a=null===(i=e.deleteNegotiation)||void 0===i?void 0:i.errors.map((function(e){return null===e||void 0===e?void 0:e.text}));Object(j.d)({type:"error",message:"".concat(a.toString())})}else Object(j.d)({message:"trattativa cancellata con successo",type:"info"})},onError:function(e){return Object(j.d)({type:"error",message:e.message})},update:function(e,t){var n,i=t.data;Object(h.g)(e,null===i||void 0===i||null===(n=i.deleteNegotiation)||void 0===n?void 0:n.response)}}),c=Object(a.a)(o,2),l=c[0],d=c[1].loading,s=function(){var e=Object(v.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n(),e.next=3,l({variables:{id:t}});case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(i.jsx)(r.a,{"aria-label":"cancel-negotiation",disabled:d,onClick:s,children:"Cancella la trattativa"})},f=n(133),m=function(e){var t=e.id,n=e.isBuy,s=e.isMessage,u=Object(f.c)(),v=o.useState(!1),j=Object(a.a)(v,2),b=j[0],h=j[1],m=function(){h(!1)};return n=!!s,Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)(r.a,{fullWidth:!0,"aria-label":"close-negotiation-popup",className:n?u.buyButton:u.sellButton,onClick:function(){h(!0)},children:"Chiudi trattativa"}),Object(i.jsx)("div",{style:{display:"none"},children:Object(i.jsxs)(c.a,{open:b,onClose:m,"aria-labelledby":"close-negotiation",children:[Object(i.jsxs)(d.a,{children:[Object(i.jsx)(O,{id:t,handleClose:m}),Object(i.jsx)(p,{id:t,handleClose:m})]}),Object(i.jsx)(l.a,{children:Object(i.jsx)(r.a,{onClick:m,color:"primary",children:"Cancel"})})]})})]})}},461:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var i=n(4),a=n(28),o=n(439),r=n(0),c=n(14),l=n(133),d=n(449),s=n(441),u=n(442),v=n(443),j=n(381),b=n(468),p=n(19),h=function(e){var t=e.review,n=e.disabled,r=e.closeModal,l=Object(c.r)({onCompleted:function(e){var t,n;if(null===(t=e.createReview)||void 0===t||null===(n=t.errors)||void 0===n?void 0:n.length){var i,a=null===(i=e.createReview)||void 0===i?void 0:i.errors.map((function(e){return null===e||void 0===e?void 0:e.text}));Object(p.d)({type:"error",message:"".concat(a.toString())})}else Object(p.d)({type:"success",message:"Recensione creata con successo"})},onError:function(e){return Object(p.d)({type:"error",message:e.message})}}),d=Object(a.a)(l,2),s=d[0],u=d[1].loading;return Object(i.jsx)(o.a,{disabled:n||u,"aria-label":"review",onClick:function(){r&&r(),s({variables:{review:t}})},color:"primary",children:"Recensisci"})},O={.5:"Useless",1:"Useless+",1.5:"Poor",2:"Poor+",2.5:"Ok",3:"Ok+",3.5:"Good",4:"Good+",4.5:"Excellent",5:"Excellent+"},f=function(e){var t=e.idUser,n=e.idNegotiation,p=e.type,f=e.isMessage,m=r.useState(!1),x=Object(a.a)(m,2),g=x[0],y=x[1],C=r.useState(2),w=Object(a.a)(C,2),E=w[0],N=w[1],_=r.useState(-1),A=Object(a.a)(_,2),k=A[0],B=A[1],S=r.useState(""),z=Object(a.a)(S,2),M=z[0],R=z[1],L=Object(l.c)(),P=Object(l.d)(),T=Object(l.b)(),D=function(){y(!1)};return p=f?c.i.Sell:p,Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)(o.a,{fullWidth:!0,"aria-label":"review",className:p===c.i.Buy?L.buyButton:L.sellButton,onClick:function(){y(!0)},children:"Lascia una recensione"}),Object(i.jsx)("div",{style:{display:"none"},children:Object(i.jsxs)(s.a,{open:g,onClose:D,"aria-labelledby":"form-dialog-title",children:[Object(i.jsx)(b.a,{id:"form-dialog-title",children:"Recensisci la trattativa"}),Object(i.jsxs)(u.a,{children:[Object(i.jsxs)("div",{className:T.root,children:[Object(i.jsx)(l.a,{name:"hover-feedback",value:E,precision:.5,onChange:function(e,t){N(t)},onChangeActive:function(e,t){B(t)}}),null!==E&&Object(i.jsx)(d.a,{ml:2,children:O[-1!==k?k:E]})]}),Object(i.jsx)(j.a,{color:"primary",multiline:!0,rows:4,value:M,error:M.length>0&&M.length<=5,helperText:"Lunghezza minima 5 caratteri",onChange:function(e){R(e.target.value)},InputLabelProps:{style:{color:"#6d1331"}},InputProps:{className:P.inputSell,classes:{underline:P.underlineSell}},id:"outlined-multiline-flexible",label:"Recensione",placeholder:"Ottima persona con cui...."})]}),Object(i.jsxs)(v.a,{children:[Object(i.jsx)(o.a,{"aria-label":"close-modal",onClick:D,color:"primary",children:"Cancel"}),Object(i.jsx)(h,{disabled:M.length<=5,review:{forUser:t,rating:E,negotiation:n,content:M,type:p},closeModal:D})]})]})})]})}},468:function(e,t,n){"use strict";var i=n(1),a=n(5),o=n(0),r=(n(10),n(7)),c=n(8),l=n(91),d=o.forwardRef((function(e,t){var n=e.children,c=e.classes,d=e.className,s=e.disableTypography,u=void 0!==s&&s,v=Object(a.a)(e,["children","classes","className","disableTypography"]);return o.createElement("div",Object(i.a)({className:Object(r.a)(c.root,d),ref:t},v),u?n:o.createElement(l.a,{component:"h2",variant:"h6"},n))}));t.a=Object(c.a)({root:{margin:0,padding:"16px 24px",flex:"0 0 auto"}},{name:"MuiDialogTitle"})(d)},490:function(e,t,n){"use strict";var i=n(1),a=n(46),o=n(5),r=n(0),c=n(7),l=(n(10),n(390)),d=n(8),s=n(30),u=n(36),v=n(35),j=n(16),b=r.forwardRef((function(e,t){var n=e.children,d=e.classes,b=e.className,p=e.collapsedHeight,h=void 0===p?"0px":p,O=e.component,f=void 0===O?"div":O,m=e.disableStrictModeCompat,x=void 0!==m&&m,g=e.in,y=e.onEnter,C=e.onEntered,w=e.onEntering,E=e.onExit,N=e.onExited,_=e.onExiting,A=e.style,k=e.timeout,B=void 0===k?s.b.standard:k,S=e.TransitionComponent,z=void 0===S?l.a:S,M=Object(o.a)(e,["children","classes","className","collapsedHeight","component","disableStrictModeCompat","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"]),R=Object(v.a)(),L=r.useRef(),P=r.useRef(null),T=r.useRef(),D="number"===typeof h?"".concat(h,"px"):h;r.useEffect((function(){return function(){clearTimeout(L.current)}}),[]);var H=R.unstable_strictMode&&!x,F=r.useRef(null),I=Object(j.a)(t,H?F:void 0),U=function(e){return function(t,n){if(e){var i=H?[F.current,t]:[t,n],o=Object(a.a)(i,2),r=o[0],c=o[1];void 0===c?e(r):e(r,c)}}},W=U((function(e,t){e.style.height=D,y&&y(e,t)})),G=U((function(e,t){var n=P.current?P.current.clientHeight:0,i=Object(u.a)({style:A,timeout:B},{mode:"enter"}).duration;if("auto"===B){var a=R.transitions.getAutoHeightDuration(n);e.style.transitionDuration="".concat(a,"ms"),T.current=a}else e.style.transitionDuration="string"===typeof i?i:"".concat(i,"ms");e.style.height="".concat(n,"px"),w&&w(e,t)})),V=U((function(e,t){e.style.height="auto",C&&C(e,t)})),q=U((function(e){var t=P.current?P.current.clientHeight:0;e.style.height="".concat(t,"px"),E&&E(e)})),J=U(N),Q=U((function(e){var t=P.current?P.current.clientHeight:0,n=Object(u.a)({style:A,timeout:B},{mode:"exit"}).duration;if("auto"===B){var i=R.transitions.getAutoHeightDuration(t);e.style.transitionDuration="".concat(i,"ms"),T.current=i}else e.style.transitionDuration="string"===typeof n?n:"".concat(n,"ms");e.style.height=D,_&&_(e)}));return r.createElement(z,Object(i.a)({in:g,onEnter:W,onEntered:V,onEntering:G,onExit:q,onExited:J,onExiting:Q,addEndListener:function(e,t){var n=H?e:t;"auto"===B&&(L.current=setTimeout(n,T.current||0))},nodeRef:H?F:void 0,timeout:"auto"===B?null:B},M),(function(e,t){return r.createElement(f,Object(i.a)({className:Object(c.a)(d.container,b,{entered:d.entered,exited:!g&&"0px"===D&&d.hidden}[e]),style:Object(i.a)({minHeight:D},A),ref:I},t),r.createElement("div",{className:d.wrapper,ref:P},r.createElement("div",{className:d.wrapperInner},n)))}))}));b.muiSupportAuto=!0,t.a=Object(d.a)((function(e){return{container:{height:0,overflow:"hidden",transition:e.transitions.create("height")},entered:{height:"auto",overflow:"visible"},hidden:{visibility:"hidden"},wrapper:{display:"flex"},wrapperInner:{width:"100%"}}}),{name:"MuiCollapse"})(b)},491:function(e,t,n){"use strict";var i=n(53),a=n(54);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=a(n(0)),r=(0,i(n(55)).default)(o.createElement("path",{d:"M12 8l-6 6 1.41 1.41L12 10.83l4.59 4.58L18 14z"}),"ExpandLess");t.default=r},536:function(e,t,n){"use strict";n.r(t);var i=n(4),a=n(56),o=n.n(a),r=n(82),c=n(28),l=n(0),d=n(41),s=n(14),u=n(19),v=n(91),j=n(439),b=n(440),p=n(441),h=n(443),O=n(442),f=function(e){var t=e.handleClose,n=e.open,a=e.createNegotiation;return Object(i.jsx)("div",{children:Object(i.jsxs)(p.a,{open:n,onClose:t,"aria-labelledby":"open-negotiation",children:[Object(i.jsx)(O.a,{children:Object(i.jsx)(j.a,{"aria-label":"open-negotiation",onClick:function(){a(),t()},children:"Apri la trattativa"})}),Object(i.jsx)(h.a,{children:Object(i.jsx)(j.a,{onClick:t,color:"primary",children:"Cancel"})})]})})},m=n(456),x=n(133),g=function(e){var t,n=e.ad,a=e.createNegotiation,o=e.me,r=Object(x.c)(),d=(null===n||void 0===n?void 0:n.typeAd)===s.i.Buy,u=l.useState(!1),p=Object(c.a)(u,2),h=p[0],O=p[1],g=function(){O(!0)},y=function(){O(!1)},C=function(){var e;return(null===o||void 0===o?void 0:o._id)===(null===n||void 0===n?void 0:n.postedBy._id)?Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)(j.a,{fullWidth:!0,"aria-label":"edit-ad",className:d?r.buyButton:r.sellButton,children:"Modifica l'annuncio"}),Object(i.jsx)("br",{})]}):(null===o||void 0===o||null===(e=o.negotiations)||void 0===e?void 0:e.find((function(e){return(null===e||void 0===e?void 0:e.ad._id)===(null===n||void 0===n?void 0:n._id)})))?Object(i.jsx)("div",{children:"Negoziazione gia aperta"}):(null===n||void 0===n?void 0:n.isActive)?Object(i.jsxs)(i.Fragment,{children:[Object(i.jsxs)(j.a,{fullWidth:!0,"aria-label":"open-negotiation-dialog",className:d?r.buyButton:r.sellButton,onClick:g,children:["Contatta il ",(null===n||void 0===n?void 0:n.typeAd)===s.i.Buy?"compratore":"venditore"]}),Object(i.jsx)(f,{handleClose:y,open:h,createNegotiation:a})]}):Object(i.jsx)(v.a,{children:"Annuncio non piu attivo "})},w="AdWine"===(null===n||void 0===n?void 0:n.__typename)?n:null;return Object(i.jsxs)(m.a,{width:1,typeAd:null===n||void 0===n?void 0:n.typeAd,children:[Object(i.jsxs)(v.a,{component:"h5",variant:"h5",children:["L'utente ",null===n||void 0===n?void 0:n.postedBy.firstName," ",d?"compra":"vende",":"]}),Object(i.jsx)("br",{}),Object(i.jsxs)(v.a,{align:"left",variant:"h6",color:"textPrimary",children:[null===w||void 0===w?void 0:w.wineName," ",null===w||void 0===w||null===(t=w.wine)||void 0===t?void 0:t.denominazioneZona,Object(i.jsx)("br",{}),"Annata: ",null===n||void 0===n?void 0:n.harvest,Object(i.jsx)("br",{}),"Gradazione: ",null===n||void 0===n?void 0:n.abv," % Vol",Object(i.jsx)("br",{}),"Quantit\xe0: ",null===w||void 0===w?void 0:w.litersTo," litri",Object(i.jsx)("br",{}),"Prezzo: ",null===n||void 0===n?void 0:n.priceFrom," euro al litro"]}),Object(i.jsx)("br",{}),Object(i.jsx)(C,{}),Object(i.jsx)("br",{}),Object(i.jsxs)(b.a,{container:!0,justify:"space-between",children:[Object(i.jsxs)(v.a,{align:"left",variant:"caption",color:"textPrimary",children:["Annuncio visualizzato: ",null===n||void 0===n?void 0:n.numberViews," volte"]}),Object(i.jsxs)(v.a,{align:"right",variant:"caption",color:"textPrimary",children:["Negoziazioni attive: ",null===n||void 0===n?void 0:n.activeNegotiations]})]})]})},y=n(437),C=n(438),w=n(454),E=n(93),N=n(431),_=n(432),A=n(430),k=n(490),B=n(457),S=n.n(B),z=n(491),M=n.n(z),R=n(380),L=n(155),P=n(461),T=n(460),D=function(e){var t,n,a=e.data,o=e.showNegotiations,r=Object(x.c)(),s=l.useState(!1),u=Object(c.a)(s,2),b=u[0],p=u[1];return a.loading?Object(i.jsx)(L.a,{}):a.error?Object(i.jsx)("div",{children:"error"}):Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)(R.a,{"aria-label":"show-open-negotiations","data-testid":"negotiationsAd",onClick:function(){b||o(),p(!b)},children:b?Object(i.jsx)(M.a,{}):Object(i.jsx)(S.a,{})}),Object(i.jsx)(k.a,{in:b,children:Object(i.jsx)(N.a,{"aria-label":"negotiations",children:null===a||void 0===a||null===(t=a.data)||void 0===t||null===(n=t.negotiationsForAd)||void 0===n?void 0:n.map((function(e){return Object(i.jsxs)("div",{children:[Object(i.jsx)(_.a,{children:Object(i.jsxs)("div",{children:[Object(i.jsx)(v.a,{color:"primary",component:"h3",variant:"h5",children:e.createdBy.firstName}),Object(i.jsx)("br",{}),Object(i.jsxs)(v.a,{color:"secondary",variant:"body1",children:["aperta il ",e.dateCreated]}),Object(i.jsx)(v.a,{color:"secondary",variant:"body1",children:e.dateConcluded?"chiusa il ".concat(e.dateConcluded):null}),Object(i.jsx)("br",{}),Object(i.jsx)(j.a,{"aria-label":"open-chat",className:r.buyButton,component:d.a,to:"/messaggi/".concat(e._id),children:"Vai alla chat"}),Object(i.jsx)("br",{}),e.isConcluded?Object(i.jsx)(P.a,{idNegotiation:e._id,idUser:e.createdBy._id,type:e.type}):Object(i.jsx)(T.a,{id:e._id})]})}),Object(i.jsx)(A.a,{})]},e._id)}))})})]})};t.default=function(){var e,t,n,a,l=Object(d.e)().id,j=Object(s.l)({variables:{id:l},onError:function(e){return console.error(e)}}),b=j.data,p=j.loading,h=j.error,O=Object(s.q)({onCompleted:function(e){var t,n;if(null===(t=e.createNegotiation)||void 0===t||null===(n=t.errors)||void 0===n?void 0:n.length){var i,a=null===(i=e.createNegotiation)||void 0===i?void 0:i.errors.map((function(e){return null===e||void 0===e?void 0:e.text}));Object(u.d)({type:"error",message:"".concat(a.toString())})}else Object(u.d)({message:"trattativa creata con successo",type:"success"})},onError:function(e){return Object(u.d)({type:"error",message:"errore durante creazione trattativa: ".concat(e.message)})},update:function(e,t){var n,i;Object(E.d)(e,null===(n=t.data)||void 0===n||null===(i=n.createNegotiation)||void 0===i?void 0:i.response)}}),f=Object(c.a)(O,1)[0],m=Object(s.G)(),N=Object(c.a)(m,2),_=N[0],A=N[1],k=function(){var e=Object(r.a)(o.a.mark((function e(){var t,n,i,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={forUserAd:null===b||void 0===b||null===(t=b.ad)||void 0===t?void 0:t.postedBy._id,ad:null===b||void 0===b||null===(n=b.ad)||void 0===n?void 0:n._id,type:null===b||void 0===b||null===(i=b.ad)||void 0===i?void 0:i.typeAd},e.next=3,f({variables:{negotiation:a}});case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),B=Object(x.c)();if(h&&!p)return Object(i.jsx)("div",{children:"Errore"});var S,z=null===b||void 0===b||null===(e=b.me)||void 0===e||null===(t=e.negotiations)||void 0===t?void 0:t.filter((function(e){var t;return e.ad._id===(null===b||void 0===b||null===(t=b.ad)||void 0===t?void 0:t._id)})),M=(null===b||void 0===b||null===(n=b.ad)||void 0===n?void 0:n.typeAd)===s.i.Buy?"L'acquirente":"Il venditore";return(null===b||void 0===b||null===(a=b.ad)||void 0===a?void 0:a._id)?Object(i.jsxs)(y.a,{component:"main",maxWidth:"xs",children:[Object(i.jsx)(C.a,{}),Object(i.jsx)(w.a,{}),Object(i.jsxs)("div",{className:B.paper,children:[Object(i.jsxs)(v.a,{color:"primary",component:"h3",variant:"h5",children:["Contatta ",M]}),Object(i.jsx)(v.a,{color:"secondary",variant:"body1",children:"Questo \xe8 uno degli annunci che abbiamo selezionato per te: verifica anche tu i parametri e decidi se procedere."})]}),Object(i.jsx)(g,{ad:null===b||void 0===b?void 0:b.ad,createNegotiation:k,me:null===b||void 0===b?void 0:b.me}),(null===b||void 0===b||null===(S=b.me)||void 0===S?void 0:S._id)===(null===b||void 0===b?void 0:b.ad.postedBy._id)&&(null===z||void 0===z?void 0:z.length)?Object(i.jsx)(D,{data:A,showNegotiations:function(){_({variables:{ad:l}})}}):null]}):Object(i.jsx)(L.a,{})}}}]);