(this["webpackJsonpwine-app-frontend"]=this["webpackJsonpwine-app-frontend"]||[]).push([[13],{538:function(e,n,t){"use strict";t.r(n);var i=t(3),a=t(21),c=t(1),r=t(467),o=t(466),l=t(0),s=t(20),d=t(172),j=t(112),b=t(409),u=t(469),O=t(471),f=t(470),h=t(533),x=t(495),v=function(e){var n=e.open,t=e.handleClose,a=e.content;return Object(i.jsx)("div",{children:Object(i.jsxs)(u.a,{open:n,onClose:t,"aria-labelledby":"responsive-dialog-title",children:[Object(i.jsx)(x.a,{id:"responsive-dialog-title",children:"Notifica app"}),Object(i.jsx)(f.a,{children:Object(i.jsx)(h.a,{color:"primary",children:a})}),Object(i.jsx)(O.a,{children:Object(i.jsx)(b.a,{autoFocus:!0,onClick:t,color:"primary",children:"Chiudi"})})]})})},p=t(13),m=t(225),g=t(479),y=t(39),C=t(473),w=t(537),N=t(534),_=t(472),k=t(460),B=t(524),V=t.n(B),S=t(523),A=t.n(S),E=t(505),J=t.n(E),T=t(461),W=t(462),D=t(463),F=t(502),I=t.n(F),M=t(32),P=function(e){var n=e.messages,t=e.id,a=Object(s.c)();if(!n)return null;var r=n.filter((function(e){return e.sentTo._id===(null===a||void 0===a?void 0:a._id)})),o=n.filter((function(e){return e.sentBy._id===(null===a||void 0===a?void 0:a._id)})),l=null===r||void 0===r?void 0:r.filter((function(e){return!e.isViewed})).length,d=r.length?r[0].sentBy.firstName:o[0].sentTo.firstName,j=r.length?r[0].negotiation.ad.wineName:o[0].negotiation.ad.wineName;return Object(i.jsxs)(T.a,{divider:!0,button:!0,component:c.forwardRef((function(e,n){return Object(i.jsx)(M.a,Object(p.a)({to:"/messaggi/".concat(t),ref:n},e))})),children:[Object(i.jsx)(W.a,{children:Object(i.jsx)(_.a,{badgeContent:l,color:"primary",children:Object(i.jsx)(I.a,{})})}),Object(i.jsx)(D.a,{primary:"Cantina ".concat(d," - ").concat(j)})]})},R=t(29),q=t.n(R),z=t(82),G=function(e){var n=e.notification,t=e.handleClick;return Object(i.jsxs)(T.a,{divider:!0,button:!0,onClick:function(){return t(n._id)},children:[Object(i.jsx)(W.a,{children:Object(i.jsx)(_.a,{badgeContent:n.isViewed?0:1,color:"primary",children:Object(i.jsx)(I.a,{})})}),Object(i.jsx)(D.a,{primary:n.content})]},n._id)};function H(e){var n=e.children,t=e.value,a=e.index,c=Object(m.a)(e,["children","value","index"]);return Object(i.jsx)("div",Object(p.a)(Object(p.a)({role:"tabpanel",hidden:t!==a,id:"full-width-tabpanel-".concat(a),"aria-labelledby":"full-width-tab-".concat(a)},c),{},{children:t===a&&Object(i.jsx)(g.a,{p:3,children:n})}))}function K(e){return{id:"full-width-tab-".concat(e),"aria-controls":"full-width-tabpanel-".concat(e)}}var L=function(e){var n,t,r=Object(z.c)(),o=Object(y.a)(),l=Object(s.c)(),d=c.useState(0),j=Object(a.a)(d,2),b=j[0],u=j[1],O=null===(n=e.messages)||void 0===n?void 0:n.filter((function(e){return"Amministratore"===e.sentBy.firstName})),f=null===(t=e.messages)||void 0===t?void 0:t.filter((function(e){return"Amministratore"!==e.sentBy.firstName})),h=q.a.groupBy(f,(function(e){return e.negotiation._id})),x=Object.entries(h).sort((function(e,n){return e[0].localeCompare(n[0])})),v=x.map((function(e){return e[1]})).flat(),m=null===O||void 0===O?void 0:O.filter((function(e){return!e.isViewed})).length,g=v.filter((function(e){return!e.isViewed&&e.sentBy._id!==(null===l||void 0===l?void 0:l._id)})).length;return Object(i.jsxs)("div",{className:r.paper,children:[Object(i.jsx)(C.a,{position:"static",color:"transparent",style:{boxShadow:"none"},children:Object(i.jsxs)(w.a,{value:b,onChange:function(e,n){u(n)},style:{color:"#6d1331"},indicatorColor:"secondary",textColor:"inherit",variant:"fullWidth","aria-label":"notifications",children:[Object(i.jsx)(N.a,Object(p.a)({icon:Object(i.jsx)(A.a,{}),label:Object(i.jsx)(_.a,{badgeContent:g,color:"primary",children:"Messaggi"})},K(0))),Object(i.jsx)(N.a,Object(p.a)({icon:Object(i.jsx)(V.a,{}),label:Object(i.jsx)(_.a,{badgeContent:m,color:"primary",children:"Notifiche"})},K(1)))]})}),Object(i.jsxs)(J.a,{axis:"rtl"===o.direction?"x-reverse":"x",index:b,onChangeIndex:function(e){u(e)},children:[Object(i.jsx)(H,{value:b,index:0,dir:o.direction,children:Object(i.jsx)(k.a,{children:x.map((function(e){return Object(i.jsx)(P,{messages:e[1],id:e[0]},e[0])}))})}),Object(i.jsx)(H,{value:b,index:1,dir:o.direction,children:Object(i.jsx)(k.a,{children:null===O||void 0===O?void 0:O.map((function(n){return Object(i.jsx)(G,{notification:n,handleClick:e.handleClickNotification},n._id)}))})})]})]})};n.default=function(){var e,n,t=Object(l.D)({fetchPolicy:"network-only",onError:function(e){Object(s.d)({type:"error",message:e.message})}}),b=t.data,u=t.loading,O=t.error,f=Object(l.x)({onError:function(e){Object(s.d)({type:"error",message:e.message})}}),h=Object(a.a)(f,2),x=h[0],p=h[1],m=c.useState(!1),g=Object(a.a)(m,2),y=g[0],C=g[1];return u?Object(i.jsx)(j.a,{}):O?Object(i.jsx)("div",{children:"error"}):Object(i.jsxs)(o.a,{component:"main",maxWidth:"sm",children:[Object(i.jsx)(r.a,{}),Object(i.jsx)(d.a,{}),Object(i.jsx)(L,{messages:null===b||void 0===b?void 0:b.messages,handleClickNotification:function(e){x({variables:{id:e}}),C(!0)}}),p.loading?Object(i.jsx)(j.a,{}):Object(i.jsx)(v,{open:y,handleClose:function(){C(!1)},content:null===(e=p.data)||void 0===e||null===(n=e.message)||void 0===n?void 0:n.content,loading:p.loading})]})}}}]);
//# sourceMappingURL=13.be1b464d.chunk.js.map