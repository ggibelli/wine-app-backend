{"version":3,"sources":["components/BackButton.tsx","../node_modules/@material-ui/icons/ArrowBackIos.js","containers/CloseNegotiationButton.tsx","pages/Negotiation.tsx"],"names":["BackButton","aria-label","color","size","startIcon","onClick","navigate","_interopRequireDefault","require","_interopRequireWildcard","Object","defineProperty","exports","value","default","React","_default","createElement","d","CloseNegotiationButton","id","isBuy","classes","useStyles","useUpdateNegotiationMutation","onCompleted","closedNegotiation","updateNegotiation","errors","length","errorMessages","map","error","text","notification","type","message","toString","onError","closeNegotiation","loading","handleCloseNegotiation","a","variables","negotiation","_id","isConcluded","className","buyButton","sellButton","disabled","Negotiation","useParams","useNegotiationQuery","data","adWine","ad","__typename","UserContact","postedBy","hideContact","phoneNumber","email","data-testid","backdrop","open","component","maxWidth","paper","variant","wineName","wine","denominazioneZona","Link","to"],"mappings":"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","file":"static/js/13.7142addd.chunk.js","sourcesContent":["import Button from '@material-ui/core/Button';\nimport * as React from 'react';\n// import { searchedWine } from '../cache';\nimport { navigate } from '@reach/router';\nimport ArrowBackIosIcon from '@material-ui/icons/ArrowBackIos';\n// import { TypeAd } from '../generated/graphql';\n\nexport const BackButton: React.FC = () => {\n  // // const searchedWineCache = searchedWine();\n  // // const { pathname } = useLocation();\n  // // if (searchedWineCache?.typeAd === TypeAd.Buy && pathname !== '/buy') {\n  // //   return (\n  // //     <Button\n  // //       component={Link}\n  // //       to='/buy'\n  // //       //variant='contained'\n  // //       color='primary'\n  // //       size='large'\n  // //       startIcon={<ArrowBackIosIcon />}\n  // //     >\n  // //       Compra\n  // //     </Button>\n  // //   );\n  // // } else if (\n  // //   searchedWineCache?.typeAd === TypeAd.Sell &&\n  // //   pathname !== '/sell'\n  // // ) {\n  //   return (\n  //     <Button\n  //       component={Link}\n  //       to='/sell'\n  //       //variant='contained'\n  //       color='primary'\n  //       size='large'\n  //       startIcon={<ArrowBackIosIcon />}\n  //     >\n  //       Vendi\n  //     </Button>\n  //   );\n  // } else\n  return (\n    <Button\n      aria-label='previous-page'\n      color='primary'\n      size='large'\n      startIcon={<ArrowBackIosIcon />}\n      onClick={() => navigate(-1)}\n    >\n      Torna indietro\n    </Button>\n  );\n};\n","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar React = _interopRequireWildcard(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M11.67 3.87L9.9 2.1 0 12l9.9 9.9 1.77-1.77L3.54 12z\"\n}), 'ArrowBackIos');\n\nexports.default = _default;","import Button from '@material-ui/core/Button';\nimport * as React from 'react';\nimport { notification } from '../cache';\nimport { useUpdateNegotiationMutation } from '../generated/graphql';\nimport { useStyles } from '../utils/styleHook';\n\nexport const CloseNegotiationButton: React.FC<{\n  id: string;\n  isBuy?: boolean;\n}> = ({ id, isBuy }) => {\n  const classes = useStyles();\n  const [closeNegotiation, { loading }] = useUpdateNegotiationMutation({\n    onCompleted: (closedNegotiation) => {\n      if (closedNegotiation.updateNegotiation?.errors?.length) {\n        const errorMessages = closedNegotiation.updateNegotiation?.errors.map(\n          (error) => error?.text\n        );\n        notification({\n          type: 'error',\n          message: `${errorMessages.toString()}`,\n        });\n      } else {\n        notification({\n          message: 'trattativa chiusa con successo',\n          type: 'success',\n        });\n      }\n    },\n\n    onError: (error) => notification({ type: 'error', message: error.message }),\n  });\n\n  const handleCloseNegotiation = async () => {\n    await closeNegotiation({\n      variables: { negotiation: { _id: id, isConcluded: true } },\n    });\n  };\n\n  return (\n    <Button\n      aria-label='close-negotiation'\n      className={isBuy ? classes.buyButton : classes.sellButton}\n      disabled={loading}\n      onClick={handleCloseNegotiation}\n    >\n      Dichiara chiusa la trattativa\n    </Button>\n  );\n};\n","/* eslint-disable @typescript-eslint/restrict-template-expressions */\nimport * as React from 'react';\nimport { Link, RouteComponentProps, useParams } from '@reach/router';\nimport { useNegotiationQuery } from '../generated/graphql';\nimport { notification } from '../cache';\nimport {\n  Backdrop,\n  CircularProgress,\n  Container,\n  CssBaseline,\n} from '@material-ui/core';\nimport { BackButton } from '../components/BackButton';\nimport Button from '@material-ui/core/Button';\nimport Typography from '@material-ui/core/Typography';\nimport { CloseNegotiationButton } from '../containers/CloseNegotiationButton';\nimport { useStyles } from '../utils/styleHook';\n\nconst Negotiation: React.FC<RouteComponentProps> = () => {\n  // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment\n  const { id }: { id: string } = useParams();\n  const classes = useStyles();\n\n  const { data, loading, error } = useNegotiationQuery({ variables: { id } });\n  const adWine =\n    data?.negotiation?.ad.__typename === 'AdWine'\n      ? data?.negotiation?.ad\n      : null;\n  const UserContact = () => {\n    if (adWine?.postedBy.hideContact) {\n      return null;\n    }\n    return (\n      <div>\n        puoi contattare l utente al numero: {adWine?.postedBy.phoneNumber} o\n        alla mail {adWine?.postedBy.email}\n      </div>\n    );\n  };\n  if (error && !loading) {\n    notification({\n      type: 'error',\n      message: `${error.message}`,\n    });\n    return <div>Errore</div>;\n  }\n  if (loading)\n    return (\n      <>\n        <Backdrop\n          data-testid='loading'\n          className={classes.backdrop}\n          open={loading}\n        >\n          <CircularProgress color='inherit' />\n        </Backdrop>\n      </>\n    );\n\n  return (\n    <Container component='main' maxWidth='xs'>\n      <CssBaseline />\n      <BackButton />\n      <div className={classes.paper}>\n        <Typography color='primary' component='h3' variant='h5'>\n          Gestisci la trattativa\n        </Typography>\n        <Typography color='secondary' variant='body1'>\n          Puoi decidere se contattare l utente tramite il nostro portale o\n          usando i suoi contatti\n        </Typography>\n      </div>\n      <UserContact />\n      <Typography color='secondary' variant='body1'>\n        Questa trattativa riguarda l annuncio per {adWine?.wineName}{' '}\n        {adWine?.wine?.denominazioneZona}\n      </Typography>\n      {data?.negotiation?.isConcluded ? null : (\n        <CloseNegotiationButton id={id} />\n      )}\n      <Button\n        className={classes.sellButton}\n        component={Link}\n        to={`/messaggi/${data?.negotiation?._id}`}\n      >\n        Vai alla chat\n      </Button>\n    </Container>\n  );\n};\n\nexport default Negotiation;\n"],"sourceRoot":""}