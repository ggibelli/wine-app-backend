(this["webpackJsonpwine-app-frontend"]=this["webpackJsonpwine-app-frontend"]||[]).push([[16],{454:function(e,n,t){"use strict";t.d(n,"a",(function(){return l}));var i=t(4),r=t(439),a=(t(0),t(41)),c=t(455),o=t.n(c),l=function(){return Object(i.jsx)(r.a,{"aria-label":"previous-page",color:"primary",size:"large",startIcon:Object(i.jsx)(o.a,{}),onClick:function(){return Object(a.c)(-1)},children:"Torna indietro"})}},542:function(e,n,t){"use strict";t.r(n);var i=t(4),r=t(28),a=t(24),c=t(516),o=t(0),l=t(438),d=t(437),s=t(431),j=t(494),u=t.n(j),b=t(35),O=t(445),f=t(537),x=t(534),h=t(514),v=t.n(h),p=t(513),m=t.n(p),g=t(14),y=t(25),w=t.n(y),C=t(432),N=t(433),_=t(434),k=t(512),B=t.n(k),V=t(444),T=t(41),A=t(21),E=function(e){var n=e.messages,t=e.id,r=Object(A.c)();if(!n)return null;var c=n.filter((function(e){return e.sentTo._id===(null===r||void 0===r?void 0:r._id)})),l=n.filter((function(e){return e.sentBy._id===(null===r||void 0===r?void 0:r._id)})),d=null===c||void 0===c?void 0:c.filter((function(e){return!e.isViewed})).length,s=c.length?c[0].sentBy.firstName:l[0].sentTo.firstName,j=c.length?c[0].negotiation.ad.wineName:l[0].negotiation.ad.wineName;return Object(i.jsxs)(C.a,{divider:!0,button:!0,component:o.forwardRef((function(e,n){return Object(i.jsx)(T.a,Object(a.a)({to:"/messaggi/".concat(t),ref:n},e))})),children:[Object(i.jsx)(N.a,{children:Object(i.jsx)(V.a,{badgeContent:d,color:"primary",children:Object(i.jsx)(B.a,{})})}),Object(i.jsx)(_.a,{primary:"Cantina ".concat(s," - ").concat(j)})]})},I=t(454),J=t(155),S=t(449),W=t(133),z=t(439),D=t(441),F=t(443),M=t(442),P=t(533),R=t(467),q=function(e){var n=e.open,t=e.handleClose,r=e.content,a=e.loading;return Object(i.jsx)("div",{children:Object(i.jsxs)(D.a,{open:n,onClose:t,"aria-labelledby":"responsive-dialog-title",children:[Object(i.jsx)(R.a,{id:"responsive-dialog-title",children:"Notifica app"}),Object(i.jsx)(M.a,{children:a?Object(i.jsx)(J.a,{}):Object(i.jsx)(P.a,{color:"primary",children:r})}),Object(i.jsx)(F.a,{children:Object(i.jsx)(z.a,{autoFocus:!0,onClick:t,color:"primary",children:"Chiudi"})})]})})};function G(e){var n=e.children,t=e.value,r=e.index,o=Object(c.a)(e,["children","value","index"]);return Object(i.jsx)("div",Object(a.a)(Object(a.a)({role:"tabpanel",hidden:t!==r,id:"full-width-tabpanel-".concat(r),"aria-labelledby":"full-width-tab-".concat(r)},o),{},{children:t===r&&Object(i.jsx)(S.a,{p:3,children:n})}))}function H(e){return{id:"full-width-tab-".concat(e),"aria-controls":"full-width-tabpanel-".concat(e)}}n.default=function(){var e,n,t,c,j=Object(g.D)({fetchPolicy:"network-only",onError:function(e){Object(A.d)({type:"error",message:e.message})}}),h=j.data,p=j.loading,y=j.error,k=Object(g.x)({onError:function(e){Object(A.d)({type:"error",message:e.message})}}),B=Object(r.a)(k,2),T=B[0],S=B[1],z=o.useState(!1),D=Object(r.a)(z,2),F=D[0],M=D[1],P=Object(A.c)(),R=Object(W.c)(),K=null===h||void 0===h||null===(e=h.messages)||void 0===e?void 0:e.filter((function(e){return"Amministratore"===e.sentBy.firstName})),L=null===K||void 0===K?void 0:K.filter((function(e){return!e.isViewed})).length,Q=null===h||void 0===h||null===(n=h.messages)||void 0===n?void 0:n.filter((function(e){return"Amministratore"!==e.sentBy.firstName})),U=w.a.groupBy(Q,(function(e){return e.negotiation._id})),X=Object.entries(U).sort((function(e,n){return e[0].localeCompare(n[0])})),Y=Object(b.a)(),Z=o.useState(0),$=Object(r.a)(Z,2),ee=$[0],ne=$[1],te=X.map((function(e){return e[1]})).flat().filter((function(e){return!e.isViewed&&e.sentBy._id!==(null===P||void 0===P?void 0:P._id)})).length;return p?Object(i.jsx)(J.a,{}):y?Object(i.jsx)("div",{children:"error"}):Object(i.jsxs)(d.a,{component:"main",maxWidth:"sm",children:[Object(i.jsx)(l.a,{}),Object(i.jsx)(I.a,{}),Object(i.jsxs)("div",{className:R.paper,children:[Object(i.jsx)(O.a,{position:"static",color:"default",children:Object(i.jsxs)(f.a,{value:ee,onChange:function(e,n){ne(n)},style:{color:"#6d1331"},indicatorColor:"secondary",textColor:"inherit",variant:"fullWidth","aria-label":"full width tabs example",children:[Object(i.jsx)(x.a,Object(a.a)({icon:Object(i.jsx)(m.a,{}),label:Object(i.jsx)(V.a,{badgeContent:te,color:"primary",children:"Messaggi"})},H(0))),Object(i.jsx)(x.a,Object(a.a)({icon:Object(i.jsx)(v.a,{}),label:Object(i.jsx)(V.a,{badgeContent:L,color:"primary",children:"Notifiche"})},H(1)))]})}),Object(i.jsxs)(u.a,{axis:"rtl"===Y.direction?"x-reverse":"x",index:ee,onChangeIndex:function(e){ne(e)},children:[Object(i.jsx)(G,{value:ee,index:0,dir:Y.direction,children:Object(i.jsx)(s.a,{children:X.map((function(e){return Object(i.jsx)("div",{children:Object(i.jsx)(E,{messages:e[1],id:e[0]})},e[0])}))})}),Object(i.jsxs)(G,{value:ee,index:1,dir:Y.direction,children:[Object(i.jsx)(s.a,{children:null===K||void 0===K?void 0:K.map((function(e){return Object(i.jsxs)(C.a,{divider:!0,button:!0,onClick:function(){return n=e._id,T({variables:{id:n}}),void M(!0);var n},children:[Object(i.jsx)(N.a,{children:Object(i.jsx)(V.a,{badgeContent:e.isViewed?0:1,color:"primary",children:Object(i.jsx)(v.a,{})})}),Object(i.jsx)(_.a,{primary:e.content})]},e._id)}))}),Object(i.jsx)(q,{open:F,handleClose:function(){M(!1)},content:null===(t=S.data)||void 0===t||null===(c=t.message)||void 0===c?void 0:c.content,loading:S.loading})]})]})]})]})}}}]);
//# sourceMappingURL=16.db467762.chunk.js.map