(this["webpackJsonpwine-app-frontend"]=this["webpackJsonpwine-app-frontend"]||[]).push([[8],{450:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var i=n(4),o=n(436),r=(n(0),n(23)),a=n(41),c=n(451),l=n.n(c),s=n(15),d=function(){var e=Object(r.e)(),t=Object(a.d)().pathname;return"annunci"===t.split("/")[1]&&t.split("/")[2]?Object(i.jsx)(o.a,{component:a.a,to:"/annunci",color:"primary",size:"large",startIcon:Object(i.jsx)(l.a,{}),children:"Annunci"}):(null===e||void 0===e?void 0:e.typeAd)===s.k.Buy&&"/buy"!==t?Object(i.jsx)(o.a,{component:a.a,to:"/buy",color:"primary",size:"large",startIcon:Object(i.jsx)(l.a,{}),children:"Compra"}):(null===e||void 0===e?void 0:e.typeAd)===s.k.Sell&&"/sell"!==t?Object(i.jsx)(o.a,{component:a.a,to:"/sell",color:"primary",size:"large",startIcon:Object(i.jsx)(l.a,{}),children:"Vendi"}):Object(i.jsx)(o.a,{color:"primary",size:"large",startIcon:Object(i.jsx)(l.a,{}),onClick:function(){return Object(a.c)(-1)},children:"Torna indietro"})}},452:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(4),o=(n(0),n(445)),r=n(15),a=function(e){var t=e.notActive?"#b2b2b2":"white",n=e.notActive?"#8a425a":"primary.main";return Object(i.jsx)(o.a,{boxShadow:3,p:2,m:2,mt:2,px:2,pt:2,width:e.width,color:e.typeAd===r.k.Sell?"primary.main":"white",borderColor:e.typeAd===r.k.Sell?"white":"primary.main",bgcolor:e.typeAd===r.k.Sell?t:n,borderRadius:16,children:e.children})}},454:function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));var i=n(4),o=n(26),r=n(41),a=n(0),c=n(453),l=n.n(c),s=n(151),d=n(385),u=n(468),j=Object(s.a)((function(){return Object(d.a)({root:{display:"flex",flexDirection:"column",alignItems:"center"}})})),v=function(e){var t=j(),n="messaggi"===Object(r.d)().pathname.split("/")[1],c=function(e){var t=e.root,n=void 0===t?null:t,i=e.rootMargin,r=void 0===i?"0px":i,c=e.threshold,l=void 0===c?0:c,s=a.useState(null),d=Object(o.a)(s,2),u=d[0],j=d[1],v=a.useState(null),b=Object(o.a)(v,2),f=b[0],h=b[1],O=a.useRef(null);return a.useEffect((function(){O.current&&O.current.disconnect(),O.current=new window.IntersectionObserver((function(e){var t=Object(o.a)(e,1)[0];return j(t)}),{root:n,rootMargin:r,threshold:l});var e=O.current;return f&&e.observe(f),function(){return e.disconnect()}}),[f,n,r,l]),[h,u]}({threshold:0}),s=Object(o.a)(c,2),d=s[0],v=s[1],b=a.useState(!0),f=Object(o.a)(b,2),h=f[0],O=f[1];return a.useEffect((function(){v&&(null===v||void 0===v?void 0:v.intersectionRatio)>=.5&&h?(e.fetchMore(),e.setIsLoading&&e.setIsLoading(!0),O(!1)):0!==(null===v||void 0===v?void 0:v.intersectionRatio)||h||(O(!0),e.setIsLoading&&e.setIsLoading(!1))}),[null===v||void 0===v?void 0:v.intersectionRatio]),n?Object(i.jsxs)(i.Fragment,{children:[e.isVisible?Object(i.jsxs)("div",{className:t.root,id:"page-bottom-boundary",ref:d,children:[" ",Object(i.jsx)(l.a,{})]}):null,e.children]}):Object(i.jsxs)("div",{className:t.root,children:[e.children,e.isVisible?e.isLoading?Object(i.jsx)(u.a,{}):Object(i.jsxs)("div",{id:"page-bottom-boundary",ref:d,style:{height:30},children:[" ",Object(i.jsx)(l.a,{})]}):null]})}},455:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var i=n(4),o=(n(0),n(383)),r=n(227),a=n(230),c=n(15),l=function(e){return Object(i.jsxs)(r.a,{fullWidth:!0,children:[Object(i.jsx)(a.a,{style:{color:"black"},htmlFor:"order",children:"Ordine risultati"}),Object(i.jsxs)(o.a,{native:!0,value:e.order,onChange:function(t){e.setOrder(t.target.value)},inputProps:{name:"order",id:"order"},children:[Object(i.jsx)("option",{"aria-label":"None",value:""}),Object(i.jsx)("option",{value:c.i.CreatedAtDesc,children:"Dal piu recente"}),Object(i.jsx)("option",{value:c.i.CreatedAtAsc,children:"Dal meno recente"}),Object(i.jsx)("option",{value:c.i.PriceDesc,children:"Dal piu caro"}),Object(i.jsx)("option",{value:c.i.PriceAsc,children:"Dal meno caro"})]})]})}},456:function(e,t,n){"use strict";n.d(t,"a",(function(){return j}));var i=n(4),o=n(81),r=n.n(o),a=n(103),c=n(26),l=n(436),s=(n(0),n(23)),d=n(15),u=n(131),j=function(e){var t=e.id,n=e.isBuy,o=Object(u.c)(),j=Object(d.L)({onCompleted:function(e){var t,n;if(null===(t=e.updateNegotiation)||void 0===t||null===(n=t.errors)||void 0===n?void 0:n.length){var i,o=null===(i=e.updateNegotiation)||void 0===i?void 0:i.errors.map((function(e){return null===e||void 0===e?void 0:e.text}));Object(s.d)({type:"error",message:"".concat(o.toString())})}else Object(s.d)({message:"trattativa chiusa con successo",type:"success"})},onError:function(e){return Object(s.d)({type:"error",message:e.message})}}),v=Object(c.a)(j,2),b=v[0],f=v[1].loading,h=function(){var e=Object(a.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b({variables:{negotiation:{_id:t,isConcluded:!0}}});case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(i.jsx)(l.a,{className:n?o.buyButton:o.sellButton,disabled:f,onClick:h,children:"Dichiara chiusa la trattativa"})}},461:function(e,t,n){"use strict";n.d(t,"b",(function(){return O})),n.d(t,"a",(function(){return p}));var i=n(4),o=n(26),r=n(28),a=n(0),c=n(436),l=n(486),s=n(467),d=n.n(s),u=n(423),j=n(484),v=n(514),b=n(8),f=n(504),h=n(23);var O=Object(b.a)({root:{color:f.a[400],"&$checked":{color:f.a[600]}},checked:{}})((function(e){return Object(i.jsx)(v.a,Object(r.a)({color:"default"},e))})),p=function(e){var t=Object(h.e)(),n=a.useState(!1),r=Object(o.a)(n,2),s=r[0],v=r[1],b=a.useState(!1),f=Object(o.a)(b,2),p=f[0],m=f[1],x=a.useState({priceTo:function(e){return e<=(null===t||void 0===t?void 0:t.price)},abv:function(e){return e>=(null===t||void 0===t?void 0:t.abv)-.5||e<=(null===t||void 0===t?void 0:t.abv)+.5},harvest:function(e){return e===(null===t||void 0===t?void 0:t.harvest)||e-1===(null===t||void 0===t?void 0:t.harvest)},litersTo:function(e){return e>=(null===t||void 0===t?void 0:t.liters)}}),g=Object(o.a)(x,2),y=g[0],C=g[1];a.useEffect((function(){if(e.list.length>0){var t=function(e,t){var n=Object.keys(t);return e.filter((function(e){return n.every((function(n){return"function"!==typeof t[n]||t[n](e[n])}))}))}(e.list,y);e.setFilteredList(t)}}),[y,e.list]);return Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)(c.a,{onClick:function(){return m(!p)},"aria-label":"filter",color:"primary",size:"large",startIcon:Object(i.jsx)(d.a,{}),children:"Filtri"}),Object(i.jsxs)(l.a,{in:p,children:[Object(i.jsx)(u.a,{}),Object(i.jsx)(j.a,{control:Object(i.jsx)(O,{checked:s,onChange:function(){C(s?{priceTo:function(e){return e<=(null===t||void 0===t?void 0:t.price)},abv:function(e){return e>=(null===t||void 0===t?void 0:t.abv)-.5||e<=(null===t||void 0===t?void 0:t.abv)+.5},harvest:function(e){return e===(null===t||void 0===t?void 0:t.harvest)||e-1===(null===t||void 0===t?void 0:t.harvest)},litersTo:function(e){return e>=(null===t||void 0===t?void 0:t.liters)}}:{priceTo:function(){return!0},harvest:function(){return!0},abv:function(){return!0},litersTo:function(){return!0}}),v(!s)},name:"showAll"}),label:"Mostra tutti gli annunci per questo vino"})]})]})}},469:function(e,t,n){"use strict";n.d(t,"a",(function(){return O}));var i=n(4),o=n(26),r=n(436),a=n(0),c=n(23),l=n(15),s=n(131),d=n(445),u=n(438),j=n(439),v=n(440),b=n(379),f=n(489),h={.5:"Useless",1:"Useless+",1.5:"Poor",2:"Poor+",2.5:"Ok",3:"Ok+",3.5:"Good",4:"Good+",4.5:"Excellent",5:"Excellent+"},O=function(e){var t=e.idUser,n=e.idNegotiation,O=e.isBuy,p=e.type,m=a.useState(!1),x=Object(o.a)(m,2),g=x[0],y=x[1],C=a.useState(2),k=Object(o.a)(C,2),S=k[0],w=k[1],A=a.useState(-1),B=Object(o.a)(A,2),N=B[0],E=B[1],I=a.useState(""),_=Object(o.a)(I,2),M=_[0],L=_[1],T=Object(s.c)(),D=Object(s.d)(),R=Object(s.b)(),P=Object(l.t)({onCompleted:function(e){var t,n;if(null===(t=e.createReview)||void 0===t||null===(n=t.errors)||void 0===n?void 0:n.length){var i,o=null===(i=e.createReview)||void 0===i?void 0:i.errors.map((function(e){return null===e||void 0===e?void 0:e.text}));Object(c.d)({type:"error",message:"".concat(o.toString())})}else Object(c.d)({type:"success",message:"Recensione creata con successo"});V()},onError:function(e){return Object(c.d)({type:"error",message:e.message})}}),z=Object(o.a)(P,2),U=z[0],F=z[1].loading,V=function(){y(!1)};return Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)(r.a,{className:O?T.buyButton:T.sellButton,disabled:F,onClick:function(){y(!0)},children:"Lascia una recensione"}),Object(i.jsx)("div",{style:{visibility:"hidden"},children:Object(i.jsxs)(u.a,{open:g,onClose:V,"aria-labelledby":"form-dialog-title",children:[Object(i.jsx)(f.a,{id:"form-dialog-title",children:"Lascia una recensione"}),Object(i.jsxs)(j.a,{children:[Object(i.jsxs)("div",{className:R.root,children:[Object(i.jsx)(s.a,{name:"hover-feedback",value:S,precision:.5,onChange:function(e,t){w(t)},onChangeActive:function(e,t){E(t)}}),null!==S&&Object(i.jsx)(d.a,{ml:2,children:h[-1!==N?N:S]})]}),Object(i.jsx)(b.a,{color:"primary",multiline:!0,rows:4,value:M,onChange:function(e){L(e.target.value)},InputLabelProps:{style:{color:"#6d1331"}},InputProps:{className:D.inputSell,classes:{underline:D.underlineSell}},id:"outlined-multiline-flexible",label:"Recensione",placeholder:"Ottima persona con cui...."})]}),Object(i.jsxs)(v.a,{children:[Object(i.jsx)(r.a,{onClick:V,color:"primary",children:"Cancel"}),Object(i.jsx)(r.a,{onClick:function(){U({variables:{review:{forUser:t,rating:S,negotiation:n,content:M,type:p}}})},color:"primary",children:"Recensisci"})]})]})})]})}},489:function(e,t,n){"use strict";var i=n(1),o=n(5),r=n(0),a=(n(10),n(7)),c=n(8),l=n(90),s=r.forwardRef((function(e,t){var n=e.children,c=e.classes,s=e.className,d=e.disableTypography,u=void 0!==d&&d,j=Object(o.a)(e,["children","classes","className","disableTypography"]);return r.createElement("div",Object(i.a)({className:Object(a.a)(c.root,s),ref:t},j),u?n:r.createElement(l.a,{component:"h2",variant:"h6"},n))}));t.a=Object(c.a)({root:{margin:0,padding:"16px 24px",flex:"0 0 auto"}},{name:"MuiDialogTitle"})(s)},517:function(e,t,n){"use strict";n.r(t);var i=n(4),o=n(26),r=n(0),a=n(90),c=n(466),l=n(435),s=n(434),d=n(15),u=n(429),j=n(41),v=n(436),b=n(35),f=n(478),h=n(452),O=n(456),p=n(131),m=n(437),x=n(469),g=n(23),y=function(e){var t,n=e.negotiation,c=Object(g.c)(),l=Object(p.c)(),s=Object(b.a)(),y=Object(f.a)(s.breakpoints.up("sm"))?400:250,C=r.useState(!0),k=Object(o.a)(C,2),S=k[0],w=k[1],A=n.type===d.k.Buy,B=-1!==(null===(t=n.review)||void 0===t?void 0:t.findIndex((function(e){return(null===e||void 0===e?void 0:e.createdBy._id)===(null===c||void 0===c?void 0:c._id)})));return Object(i.jsxs)(h.a,{width:y,typeAd:n.type,children:[Object(i.jsxs)(u.a,{component:j.a,to:"/trattative/".concat(n._id),style:{textDecoration:"none"},children:[Object(i.jsxs)(a.a,{component:"h5",variant:"h6",color:A?"textSecondary":"primary",children:[A?"Compro":"Vendo"," ","AdWine"===n.ad.__typename&&n.ad.wineName," "]}),Object(i.jsxs)(a.a,{align:"left",variant:"body1",color:A?"textSecondary":"primary",children:["Aperta da: cantina ",n.createdBy.firstName,Object(i.jsx)("br",{}),"Per cantina: ",n.forUserAd.firstName,Object(i.jsx)("br",{}),n.isConcluded?"Trattativa conclusa":null]}),Object(i.jsx)("br",{}),Object(i.jsxs)(a.a,{align:"right",variant:"caption",color:A?"textSecondary":"primary",children:["Trattativa aperta il ",n.dateCreated]})]}),Object(i.jsx)(m.a,{children:n.isConcluded||!S?B?null:Object(i.jsx)(x.a,{isBuy:A,idNegotiation:n._id,type:n.type,idUser:n.createdBy._id===(null===c||void 0===c?void 0:c._id)?n.forUserAd._id:n.createdBy._id}):Object(i.jsxs)("div",{onClick:function(){w(!1)},children:[" ",Object(i.jsx)(O.a,{isBuy:A,id:n._id})]})}),Object(i.jsx)(v.a,{className:A?l.buyButton:l.sellButton,color:"primary",component:j.a,to:"/messaggi/".concat(n._id),children:"Apri la chat"})]})},C=n(450),k=n(455),S=n(454),w=n(461),A=n(484),B=n(423);t.default=function(){var e,t,n,u,j,v,b,f,h=Object(d.G)({onError:function(e){return console.log(e)}}),O=Object(o.a)(h,2),p=O[0],m=O[1],x=r.useState([]),N=Object(o.a)(x,2),E=N[0],I=N[1],_=r.useState(d.i.CreatedAtDesc),M=Object(o.a)(_,2),L=M[0],T=M[1],D=r.useState(!1),R=Object(o.a)(D,2),P=R[0],z=R[1];r.useEffect((function(){p({variables:{offset:0,limit:4,orderBy:L,isConcluded:!1}})}),[]);var U=(null===E||void 0===E?void 0:E.length)!==(null===(e=m.data)||void 0===e||null===(t=e.negotiations)||void 0===t?void 0:t.pageCount);if(r.useEffect((function(){var e,t,n;if(null===(e=m.data)||void 0===e||null===(t=e.negotiations)||void 0===t||null===(n=t.negotiations)||void 0===n?void 0:n.length){var i,o=null===(i=m.data)||void 0===i?void 0:i.negotiations.negotiations;I(P?o:null===o||void 0===o?void 0:o.filter((function(e){return!(null===e||void 0===e?void 0:e.isConcluded)})))}}),[m.data]),r.useEffect((function(){m.fetchMore&&m.fetchMore({variables:{orderBy:L,limit:null===E||void 0===E?void 0:E.length,isConcluded:P}}).catch((function(e){return console.log(e)}))}),[L]),0===(null===E||void 0===E?void 0:E.length))return Object(i.jsx)("div",{children:"Non hai ancora aperto trattative"});if((null===E||void 0===E?void 0:E.length)&&0!==(null===(n=m.data)||void 0===n||null===(u=n.negotiations)||void 0===u||null===(j=u.negotiations)||void 0===j?void 0:j.length)){return Object(i.jsxs)(s.a,{component:"main",maxWidth:"xs",children:[Object(i.jsx)(l.a,{}),Object(i.jsx)(C.a,{}),Object(i.jsx)("br",{}),Object(i.jsx)(a.a,{color:"primary",component:"h3",variant:"h5",children:"Le tue trattative attive"}),Object(i.jsx)("br",{}),Object(i.jsx)(k.a,{setOrder:T,order:L}),Object(i.jsx)(B.a,{}),Object(i.jsx)(A.a,{control:Object(i.jsx)(w.b,{checked:P,onChange:function(){if(P&&m.refetch&&(m.refetch({offset:0,limit:4,orderBy:L,isConcluded:!1}),z(!1)),m.fetchMore&&!P)try{m.fetchMore({variables:{limit:null===E||void 0===E?void 0:E.length,isConcluded:!0}}),z(!0)}catch(e){Object(g.d)({type:"error",message:"Errore durante il caricamento delle trattative"})}},name:"showAll"}),label:"Mostra anche le trattative chiuse"}),Object(i.jsx)(S.a,{fetchMore:function(){if(m.fetchMore)try{var e,t,n;m.fetchMore({variables:{offset:null===(e=m.data)||void 0===e||null===(t=e.negotiations)||void 0===t||null===(n=t.negotiations)||void 0===n?void 0:n.length,orderBy:L,isConcluded:P}})}catch(i){console.log(i)}},isVisible:U,isLoading:m.loading,children:E.map((function(e){return Object(i.jsx)(y,{negotiation:e},null===e||void 0===e?void 0:e._id)}))})]})}return 0===(null===(v=m.data)||void 0===v||null===(b=v.negotiations)||void 0===b||null===(f=b.negotiations)||void 0===f?void 0:f.length)?Object(i.jsx)("div",{children:"Non ci sono negoziazioni attive"}):Object(i.jsx)(c.a,{})}}}]);
//# sourceMappingURL=8.c4f0c4bc.chunk.js.map