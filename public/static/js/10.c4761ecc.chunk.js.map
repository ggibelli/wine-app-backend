{"version":3,"sources":["components/BackButton.tsx","components/StyledBox.tsx","components/InfiniteScrollFetch.tsx","utils/useIntersectionHook.tsx","components/FilterAds/Order.tsx","components/CardWine.tsx","components/FilterAds/index.tsx","utils/multiFilter.ts","pages/MyAds.tsx"],"names":["BackButton","searchedWineCache","searchedWine","pathname","useLocation","split","component","Link","to","color","size","startIcon","typeAd","TypeAd","Buy","Sell","onClick","navigate","StyledBox","props","sellColor","notActive","buyColor","boxShadow","p","m","mt","px","pt","width","borderColor","bgcolor","borderRadius","children","useStyles","makeStyles","createStyles","root","display","flexDirection","alignItems","InfiniteScroll","classes","message","rootMargin","threshold","React","entry","setEntry","node","setNode","observer","current","disconnect","window","IntersectionObserver","currentObserver","observe","useIntersect","ref","isOk","setIsOk","intersectionRatio","fetchMore","setIsLoading","isVisible","className","id","isLoading","CircularProgress","style","height","Order","fullWidth","htmlFor","native","value","order","onChange","event","setOrder","target","inputProps","name","aria-label","QueryOrderBy","CreatedAtDesc","CreatedAtAsc","PriceDesc","PriceAsc","CardWine","ad","theme","useTheme","useMediaQuery","breakpoints","up","isBuy","pointerEvent","isActive","pointerEvents","RouterLink","_id","underline","variant","wineName","align","harvest","abv","litersTo","priceFrom","datePosted","PurpleCheckbox","withStyles","deepPurple","checked","Checkbox","Filter","isShowAll","setIsShowAll","showFilter","setShowFilter","priceTo","price","liters","filterAds","setFilterAds","list","length","filtredAds","array","filters","filterKeys","Object","keys","filter","item","every","key","multiFilter","setFilteredList","Button","Collapse","in","Divider","FormControlLabel","control","label","MyAds","me","myInfo","undefined","active","setActive","ads","setAds","adsFiltered","setAdsFiltered","hideNotActive","setHideNotActive","useAdsForUserLazyQuery","variables","offset","limit","orderBy","user","onError","error","console","log","query","result","data","adsForUser","catch","e","a","handleFetchMore","maxWidth","pageCount","loading","map"],"mappings":"sOAOaA,EAAuB,WAClC,IAAMC,EAAoBC,cAClBC,EAAaC,cAAbD,SACR,MAA+B,YAA3BA,EAASE,MAAM,KAAK,IAAoBF,EAASE,MAAM,KAAK,GAE5D,cAAC,IAAD,CACEC,UAAWC,IACXC,GAAG,WAEHC,MAAM,UACNC,KAAK,QACLC,UAAW,cAAC,IAAD,IANb,sBAWwB,OAAjBV,QAAiB,IAAjBA,OAAA,EAAAA,EAAmBW,UAAWC,IAAOC,KAAoB,SAAbX,EAEnD,cAAC,IAAD,CACEG,UAAWC,IACXC,GAAG,OAEHC,MAAM,UACNC,KAAK,QACLC,UAAW,cAAC,IAAD,IANb,qBAYe,OAAjBV,QAAiB,IAAjBA,OAAA,EAAAA,EAAmBW,UAAWC,IAAOE,MACxB,UAAbZ,EAGE,cAAC,IAAD,CACEG,UAAWC,IACXC,GAAG,QAEHC,MAAM,UACNC,KAAK,QACLC,UAAW,cAAC,IAAD,IANb,mBAaA,cAAC,IAAD,CACEF,MAAM,UACNC,KAAK,QACLC,UAAW,cAAC,IAAD,IACXK,QAAS,kBAAMC,aAAU,IAJ3B,8B,sGC3COC,EAAgC,SAACC,GAC5C,IAAMC,EAAYD,EAAME,UAAY,UAAY,QAC1CC,EAAWH,EAAME,UAAY,UAAY,eAE/C,OACE,cAAC,IAAD,CACEE,UAAW,EACXC,EAAG,EACHC,EAAG,EACHC,GAAI,EACJC,GAAI,EACJC,GAAI,EACJC,MAAOV,EAAMU,MACbpB,MAAOU,EAAMP,SAAWC,IAAOE,KAAO,eAAiB,QACvDe,YAAaX,EAAMP,SAAWC,IAAOE,KAAO,QAAU,eACtDgB,QAASZ,EAAMP,SAAWC,IAAOE,KAAOK,EAAYE,EACpDU,aAAc,GAXhB,SAaGb,EAAMc,a,kJCdPC,EAAYC,aAAW,kBAC3BC,YAAa,CACXC,KAAM,CACJC,QAAS,OACTC,cAAe,SACfC,WAAY,eAKLC,EAAgD,SAACtB,GAC5D,IAAMuB,EAAUR,IAEVS,EAAqC,aADtBvC,cAAbD,SACiBE,MAAM,KAAK,GAHkC,ECvB5C,SAAC,GAOvB,IAAD,IANHgC,YAMG,MANI,KAMJ,MALHO,kBAKG,MALU,MAKV,MAJHC,iBAIG,MAJS,EAIT,IACuBC,WACxB,MAFC,mBACIC,EADJ,KACWC,EADX,OAIqBF,WAAsC,MAJ3D,mBAIIG,EAJJ,KAIUC,EAJV,KAMGC,EAAWL,SAA0C,MAkB3D,OAhBAA,aAAgB,WACVK,EAASC,SACXD,EAASC,QAAQC,aAEnBF,EAASC,QAAU,IAAIE,OAAOC,sBAC5B,gBAAER,EAAF,2BAAaC,EAASD,KACtB,CAAEV,OAAMO,aAAYC,cANF,IASHW,EAAoBL,EAA7BC,QAKR,OAHIH,GACFO,EAAgBC,QAAQR,GAEnB,kBAAMO,EAAgBH,gBAC5B,CAACJ,EAAMZ,EAAMO,EAAYC,IACrB,CAACK,EAASH,GDJIW,CAAa,CAAEb,UAAW,IAJuB,mBAI/Dc,EAJ+D,KAI1DZ,EAJ0D,OAK9CD,YAAwB,GALsB,mBAK/Dc,EAL+D,KAKzDC,EALyD,KAiBtE,OAVAf,aAAgB,WACVC,IAAc,OAALA,QAAK,IAALA,OAAA,EAAAA,EAAOe,oBAAqB,IAAOF,GACzCzC,EAAM4C,YACX5C,EAAM6C,cAAgB7C,EAAM6C,cAAa,GACzCH,GAAQ,IAC8B,KAAxB,OAALd,QAAK,IAALA,OAAA,EAAAA,EAAOe,oBAA4BF,IAC5CC,GAAQ,GACR1C,EAAM6C,cAAgB7C,EAAM6C,cAAa,MAE1C,QAACjB,QAAD,IAACA,OAAD,EAACA,EAAOe,oBACPnB,EAEA,qCACGxB,EAAM8C,UACL,sBAAKC,UAAWxB,EAAQL,KAAM8B,GAAG,uBAAuBR,IAAKA,EAA7D,UACG,IACD,cAAC,IAAD,OAEA,KACHxC,EAAMc,YAMX,sBAAKiC,UAAWxB,EAAQL,KAAxB,UACGlB,EAAMc,SACNd,EAAM8C,UACL9C,EAAMiD,UACJ,cAACC,EAAA,EAAD,IAEA,sBAAKF,GAAG,uBAAuBR,IAAKA,EAAKW,MAAO,CAAEC,OAAQ,IAA1D,UACG,IACD,cAAC,IAAD,OAGF,U,wHExDGC,EAA8B,SAACrD,GAK1C,OACE,eAAC,IAAD,CAAasD,WAAS,EAAtB,UACE,cAAC,IAAD,CAAYH,MAAO,CAAE7D,MAAO,SAAWiE,QAAQ,QAA/C,8BAGA,eAAC,IAAD,CACEC,QAAM,EACNC,MAAOzD,EAAM0D,MACbC,SAZe,SAACC,GACpB5D,EAAM6D,SAASD,EAAME,OAAOL,QAYxBM,WAAY,CACVC,KAAM,QACNhB,GAAI,SANR,UASE,wBAAQiB,aAAW,OAAOR,MAAM,KAChC,wBAAQA,MAAOS,IAAaC,cAA5B,6BACA,wBAAQV,MAAOS,IAAaE,aAA5B,8BACA,wBAAQX,MAAOS,IAAaG,UAA5B,0BACA,wBAAQZ,MAAOS,IAAaI,SAA5B,mC,gJCzBKC,EAAmD,SAAC,GAAY,IAAVC,EAAS,EAATA,GAC3DC,EAAQC,cAERhE,EADUiE,YAAcF,EAAMG,YAAYC,GAAG,OAC3B,IAAM,IACxBC,GAAU,OAAFN,QAAE,IAAFA,OAAA,EAAAA,EAAI/E,UAAWC,IAAOC,IAC9BoF,GAAiB,OAAFP,QAAE,IAAFA,OAAA,EAAAA,EAAIQ,UAAW,OAAS,OAC7C,OAAKR,EAEH,cAAC,IAAD,CAAW9D,MAAOA,EAAOjB,OAAQ+E,EAAG/E,OAAQS,WAAYsE,EAAGQ,SAA3D,SACE,eAAC,IAAD,CACE7B,MAAO,CAAE8B,cAAeF,EAAc5D,QAAS,SAC/ChC,UAAW+F,IACX7F,GAAE,mBAAcmF,EAAGW,KACnBC,UAAU,OAJZ,UAME,eAAC,IAAD,CACEjG,UAAU,KACVkG,QAAQ,KACR/F,MAAOwF,EAAQ,gBAAkB,UAHnC,UAKGA,EAAQ,SAAW,QALtB,IAKgCN,EAAGc,SAAU,OAG7C,eAAC,IAAD,CACEC,MAAM,OACNF,QAAQ,QACR/F,MAAOwF,EAAQ,gBAAkB,UAHnC,qBAKWN,EAAGgB,QACZ,uBANF,eAOehB,EAAGiB,IAPlB,SAQE,uBARF,gBASajB,EAAGkB,SAThB,KAUE,uBAVF,WAWWlB,EAAGmB,UAXd,oBAaA,uBACA,eAAC,IAAD,CACEJ,MAAM,QACNF,QAAQ,UACR/F,MAAOwF,EAAQ,gBAAkB,UAHnC,oCAK0BN,EAAGoB,mBApCnB,O,8NCJX,IAAMC,EAAiBC,YAAW,CACvC5E,KAAM,CACJ5B,MAAOyG,IAAW,KAClB,YAAa,CACXzG,MAAOyG,IAAW,OAGtBC,QAAS,IAPmBF,EAQ3B,SAAC9F,GAAD,OAA0B,cAACiG,EAAA,EAAD,aAAU3G,MAAM,WAAcU,OAW9CkG,EAAgC,SAAClG,GAC5C,IAAMlB,EAAoBC,cAD4B,EAEpB4C,YAAwB,GAFJ,mBAE/CwE,EAF+C,KAEpCC,EAFoC,OAGlBzE,YAAwB,GAHN,mBAG/C0E,EAH+C,KAGnCC,EAHmC,OAIpB3E,WAAyB,CACzD4E,QAAS,SAACA,GAAD,OACPA,IAAO,OAAKzH,QAAL,IAAKA,OAAL,EAAKA,EAAmB0H,QACjCf,IAAK,SAACA,GAAD,OACHA,IAAO,OAAC3G,QAAD,IAACA,OAAD,EAACA,EAAmB2G,KAAiB,IAC5CA,IAAO,OAAC3G,QAAD,IAACA,OAAD,EAACA,EAAmB2G,KAAiB,IAC9CD,QAAS,SAACA,GAAD,OACPA,KAAO,OAAM1G,QAAN,IAAMA,OAAN,EAAMA,EAAmB0G,UAChCA,EAAU,KAAV,OAAiB1G,QAAjB,IAAiBA,OAAjB,EAAiBA,EAAmB0G,UACtCE,SAAU,SAACA,GAAD,OACRA,IAAQ,OAAK5G,QAAL,IAAKA,OAAL,EAAKA,EAAmB2H,WAdkB,mBAI/CC,EAJ+C,KAIpCC,EAJoC,KAgBtDhF,aAAgB,WACd,GAAI3B,EAAM4G,KAAKC,OAAS,EAAG,CACzB,IAAMC,ECvCL,SACLC,EACAC,GAEA,IAAMC,EAAaC,OAAOC,KAAKH,GAC/B,OAAOD,EAAMK,QAAO,SAACC,GAEnB,OAAOJ,EAAWK,OAAM,SAACC,GAEvB,MAA4B,oBAAjBP,EAAQO,IACZP,EAAQO,GAAKF,EAAKE,UD6BNC,CAAYxH,EAAM4G,KAAMF,GAC3C1G,EAAMyH,gBAAgBX,MAEvB,CAACJ,EAAW1G,EAAM4G,OAyBrB,OACE,qCACE,cAACc,EAAA,EAAD,CACE7H,QAAS,kBAAMyG,GAAeD,IAC9BpC,aAAW,SACX3E,MAAM,UACNC,KAAK,QACLC,UAAW,cAAC,IAAD,IALb,oBASA,eAACmI,EAAA,EAAD,CAAUC,GAAIvB,EAAd,UACE,cAACwB,EAAA,EAAD,IACA,cAACC,EAAA,EAAD,CACEC,QACE,cAAClC,EAAD,CACEG,QAASG,EACTxC,SAzCU,WASlBgD,EARGR,EAQU,CACXI,QAAS,SAACA,GAAD,OACPA,IAAO,OAAKzH,QAAL,IAAKA,OAAL,EAAKA,EAAmB0H,QACjCf,IAAK,SAACA,GAAD,OACHA,IAAO,OAAC3G,QAAD,IAACA,OAAD,EAACA,EAAmB2G,KAAiB,IAC5CA,IAAO,OAAC3G,QAAD,IAACA,OAAD,EAACA,EAAmB2G,KAAiB,IAC9CD,QAAS,SAACA,GAAD,OACPA,KAAO,OAAM1G,QAAN,IAAMA,OAAN,EAAMA,EAAmB0G,UAChCA,EAAU,KAAV,OAAiB1G,QAAjB,IAAiBA,OAAjB,EAAiBA,EAAmB0G,UACtCE,SAAU,SAACA,GAAD,OACRA,IAAQ,OAAK5G,QAAL,IAAKA,OAAL,EAAKA,EAAmB2H,UAjBvB,CACXF,QAAS,kBAAM,GACff,QAAS,kBAAM,GACfC,IAAK,kBAAM,GACXC,SAAU,kBAAM,KAgBpBU,GAAcD,IAoBJnC,KAAK,YAGTgE,MAAM,qD,8MEwCDC,UApH8B,WAC3C,IAAMC,EAAKC,cADsC,EAErBxG,gBAAiCyG,GAFZ,mBAE1CC,EAF0C,KAElCC,EAFkC,OAG3B3G,WAEpB,IAL+C,mBAG1C4G,EAH0C,KAGrCC,EAHqC,OAMX7G,WAEpC,IAR+C,mBAM1C8G,EAN0C,KAM7BC,EAN6B,OASvB/G,WACxBuC,IAAaC,eAVkC,mBAS1CT,EAT0C,KASnCG,EATmC,OAYPlC,YAAwB,GAZjB,mBAY1CgH,EAZ0C,KAY3BC,EAZ2B,OAazBC,YAAuB,CAC7CC,UAAW,CACTC,OAAQ,EACRC,MAAO,EACPC,QAAS/E,IAAaC,cACtB+E,KAAI,OAAEhB,QAAF,IAAEA,OAAF,EAAEA,EAAI/C,IACVH,SAAUqD,GAEZc,QAAS,SAACC,GAAD,OAAWC,QAAQC,IAAIF,MArBe,mBAa1CG,EAb0C,KAanCC,EAbmC,KAuBjD7H,aAAgB,YACd,OAAIuG,QAAJ,IAAIA,OAAJ,EAAIA,EAAI/C,MACNoE,MAED,CAACrB,IACJvG,aAAgB,WAAO,IAAD,GACpB,UAAI6H,EAAOC,YAAX,aAAI,EAAaC,aACflB,EAAOgB,EAAOC,KAAKC,WAAWnB,OAE/B,CAACiB,EAAOC,OACX9H,aAAgB,WACV4G,GAAOA,EAAI1B,QAAU2C,EAAO5G,WAC9B4G,EACG5G,UAAU,CACTkG,UAAW,CAAEG,QAASvF,EAAOsF,MAAOT,EAAI1B,UAEzC8C,OAAM,SAACC,GAAD,OAAOP,QAAQC,IAAIM,QAE7B,CAAClG,IACJ/B,aAAgB,WACd+G,EAAeH,GACXI,IAAa,OAAIJ,QAAJ,IAAIA,OAAJ,EAAIA,EAAK1B,SACxB6B,EAAc,OAACH,QAAD,IAACA,OAAD,EAACA,EAAKnB,QAAO,SAACyC,GAAD,cAAOA,QAAP,IAAOA,OAAP,EAAOA,EAAG7E,eAEtC,CAAC2D,EAAeJ,IAWnB,GAAoB,KAAb,OAAHA,QAAG,IAAHA,OAAA,EAAAA,EAAK1B,QACP,OAAO,gEAGT,UAAI0B,QAAJ,IAAIA,OAAJ,EAAIA,EAAK1B,OAAQ,CAAC,IAAD,IACTiD,EAAe,uCAAG,sBAAAD,EAAA,0DAClBL,EAAO5G,UADW,yCAGZ4G,EAAO5G,UAAU,CACrBkG,UAAW,CACTC,OAAM,OAAEN,QAAF,IAAEA,OAAF,EAAEA,EAAa5B,OACrBoC,QAASvF,EACTsB,SAAUqD,KAPI,sDAWlBgB,QAAQC,IAAR,MAXkB,wDAAH,qDAerB,OACE,eAAC,IAAD,CAAWnK,UAAU,OAAO4K,SAAS,KAArC,UACE,cAAC,IAAD,IACA,cAAC,IAAD,IACA,uBACA,cAAC,IAAD,CAAYzK,MAAM,UAAUH,UAAU,KAAKkG,QAAQ,KAAnD,wCAGA,uBACA,cAAC,IAAD,CAAOxB,SAAUA,EAAUH,MAAOA,IAClC,cAAC,IAAD,IACA,cAAC,IAAD,CACEqE,QACE,cAAC,IAAD,CACE/B,QAAS2C,EACThF,SA7CS,WACnBiF,GAAkBD,GACdA,GACFL,OAAUF,GACVM,EAAeH,IAEfD,GAAU,IAwCFtE,KAAK,YAGTgE,MAAM,kCAER,eAAC,IAAD,CACEpF,UAAWkH,EACXhH,WAAsB,OAAX2F,QAAW,IAAXA,OAAA,EAAAA,EAAa5B,WAAb,UAAwB2C,EAAOC,YAA/B,iBAAwB,EAAaC,kBAArC,aAAwB,EAAyBM,WAC5D/G,UAAWuG,EAAOS,QAHpB,UAKG,IACAxB,GACCA,EAAYyB,KAAI,SAAC1F,GAAD,OACd,cAAC,IAAD,CAA6BA,GAAIA,GAAlBA,GAAMA,EAAGW,cAMpC,OAAO,cAAC,IAAD","file":"static/js/10.c4761ecc.chunk.js","sourcesContent":["import Button from '@material-ui/core/Button';\nimport * as React from 'react';\nimport { searchedWine } from '../cache';\nimport { Link, useLocation, navigate } from '@reach/router';\nimport ArrowBackIosIcon from '@material-ui/icons/ArrowBackIos';\nimport { TypeAd } from '../generated/graphql';\n\nexport const BackButton: React.FC = () => {\n  const searchedWineCache = searchedWine();\n  const { pathname } = useLocation();\n  if (pathname.split('/')[1] === 'annunci' && pathname.split('/')[2]) {\n    return (\n      <Button\n        component={Link}\n        to='/annunci'\n        //variant='contained'\n        color='primary'\n        size='large'\n        startIcon={<ArrowBackIosIcon />}\n      >\n        Annunci\n      </Button>\n    );\n  } else if (searchedWineCache?.typeAd === TypeAd.Buy && pathname !== '/buy') {\n    return (\n      <Button\n        component={Link}\n        to='/buy'\n        //variant='contained'\n        color='primary'\n        size='large'\n        startIcon={<ArrowBackIosIcon />}\n      >\n        Compra\n      </Button>\n    );\n  } else if (\n    searchedWineCache?.typeAd === TypeAd.Sell &&\n    pathname !== '/sell'\n  ) {\n    return (\n      <Button\n        component={Link}\n        to='/sell'\n        //variant='contained'\n        color='primary'\n        size='large'\n        startIcon={<ArrowBackIosIcon />}\n      >\n        Vendi\n      </Button>\n    );\n  } else\n    return (\n      <Button\n        color='primary'\n        size='large'\n        startIcon={<ArrowBackIosIcon />}\n        onClick={() => navigate(-1)}\n      >\n        Torna indietro\n      </Button>\n    );\n};\n","import * as React from 'react';\nimport Box from '@material-ui/core/Box';\nimport { TypeAd } from '../generated/graphql';\n\ninterface BoxProps {\n  width: number;\n  typeAd: TypeAd;\n  children: React.ReactNode;\n  notActive?: boolean;\n}\n\nexport const StyledBox: React.FC<BoxProps> = (props) => {\n  const sellColor = props.notActive ? '#b2b2b2' : 'white';\n  const buyColor = props.notActive ? '#8a425a' : 'primary.main';\n\n  return (\n    <Box\n      boxShadow={3}\n      p={2}\n      m={2}\n      mt={2}\n      px={2}\n      pt={2}\n      width={props.width}\n      color={props.typeAd === TypeAd.Sell ? 'primary.main' : 'white'}\n      borderColor={props.typeAd === TypeAd.Sell ? 'white' : 'primary.main'}\n      bgcolor={props.typeAd === TypeAd.Sell ? sellColor : buyColor}\n      borderRadius={16}\n    >\n      {props.children}\n    </Box>\n  );\n};\n","import { useLocation } from '@reach/router';\nimport * as React from 'react';\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\nimport { useIntersect } from '../utils/useIntersectionHook';\nimport { makeStyles, createStyles } from '@material-ui/core';\nimport CircularProgress from '@material-ui/core/CircularProgress';\n\ninterface InfiniteScrollProps {\n  children: React.ReactNode;\n  fetchMore: () => void;\n  isVisible: boolean;\n  isLoading: boolean;\n  setIsLoading?: React.Dispatch<React.SetStateAction<boolean>>;\n}\n\nconst useStyles = makeStyles(() =>\n  createStyles({\n    root: {\n      display: 'flex',\n      flexDirection: 'column',\n      alignItems: 'center',\n    },\n  })\n);\n\nexport const InfiniteScroll: React.FC<InfiniteScrollProps> = (props) => {\n  const classes = useStyles();\n  const { pathname } = useLocation();\n  const message = pathname.split('/')[1] === 'messaggi';\n  const [ref, entry] = useIntersect({ threshold: 0 });\n  const [isOk, setIsOk] = React.useState<boolean>(true);\n\n  React.useEffect(() => {\n    if (entry && entry?.intersectionRatio >= 0.5 && isOk) {\n      void props.fetchMore();\n      props.setIsLoading && props.setIsLoading(true);\n      setIsOk(false);\n    } else if (entry?.intersectionRatio === 0 && !isOk) {\n      setIsOk(true);\n      props.setIsLoading && props.setIsLoading(false);\n    }\n  }, [entry?.intersectionRatio]);\n  if (message) {\n    return (\n      <>\n        {props.isVisible ? (\n          <div className={classes.root} id='page-bottom-boundary' ref={ref}>\n            {' '}\n            <ExpandMoreIcon />\n          </div>\n        ) : null}\n        {props.children}\n      </>\n    );\n  }\n\n  return (\n    <div className={classes.root}>\n      {props.children}\n      {props.isVisible ? (\n        props.isLoading ? (\n          <CircularProgress />\n        ) : (\n          <div id='page-bottom-boundary' ref={ref} style={{ height: 30 }}>\n            {' '}\n            <ExpandMoreIcon />\n          </div>\n        )\n      ) : null}\n    </div>\n  );\n};\n","import * as React from 'react';\n\nexport const useIntersect = ({\n  root = null,\n  rootMargin = '0px',\n  threshold = 0,\n}): [\n  React.Dispatch<React.SetStateAction<HTMLDivElement | null>>,\n  IntersectionObserverEntry | null\n] => {\n  const [entry, setEntry] = React.useState<IntersectionObserverEntry | null>(\n    null\n  );\n  const [node, setNode] = React.useState<HTMLDivElement | null>(null);\n\n  const observer = React.useRef<IntersectionObserver | null>(null);\n\n  React.useEffect(() => {\n    if (observer.current) {\n      observer.current.disconnect();\n    }\n    observer.current = new window.IntersectionObserver(\n      ([entry]) => setEntry(entry),\n      { root, rootMargin, threshold }\n    );\n\n    const { current: currentObserver } = observer;\n\n    if (node) {\n      currentObserver.observe(node);\n    }\n    return () => currentObserver.disconnect();\n  }, [node, root, rootMargin, threshold]);\n  return [setNode, entry];\n};\n","/* eslint-disable @typescript-eslint/no-unsafe-member-access */\nimport * as React from 'react';\nimport Select from '@material-ui/core/Select';\nimport FormControl from '@material-ui/core/FormControl';\nimport InputLabel from '@material-ui/core/InputLabel';\nimport { QueryOrderBy } from '../../generated/graphql';\n\ninterface OrderProps {\n  setOrder: React.Dispatch<React.SetStateAction<QueryOrderBy>>;\n  order: QueryOrderBy;\n}\n\nexport const Order: React.FC<OrderProps> = (props) => {\n  const handleChange = (event: React.ChangeEvent<{ value: unknown }>) => {\n    props.setOrder(event.target.value as QueryOrderBy);\n  };\n\n  return (\n    <FormControl fullWidth>\n      <InputLabel style={{ color: 'black' }} htmlFor='order'>\n        Ordine risultati\n      </InputLabel>\n      <Select\n        native\n        value={props.order}\n        onChange={handleChange}\n        inputProps={{\n          name: 'order',\n          id: 'order',\n        }}\n      >\n        <option aria-label='None' value='' />\n        <option value={QueryOrderBy.CreatedAtDesc}>Dal piu recente</option>\n        <option value={QueryOrderBy.CreatedAtAsc}>Dal meno recente</option>\n        <option value={QueryOrderBy.PriceDesc}>Dal piu caro</option>\n        <option value={QueryOrderBy.PriceAsc}>Dal meno caro</option>\n      </Select>\n    </FormControl>\n  );\n};\n","import * as React from 'react';\nimport { StyledBox } from './StyledBox';\nimport Typography from '@material-ui/core/Typography';\nimport Link from '@material-ui/core/Link';\nimport { Link as RouterLink } from '@reach/router';\nimport { TypeAd } from '../generated/graphql';\nimport { useTheme } from '@material-ui/core/styles';\nimport useMediaQuery from '@material-ui/core/useMediaQuery';\nimport { AdsWineResult } from '../types';\n\nexport const CardWine: React.FC<{ ad: AdsWineResult | null }> = ({ ad }) => {\n  const theme = useTheme();\n  const matches = useMediaQuery(theme.breakpoints.up('sm'));\n  const width = matches ? 400 : 250;\n  const isBuy = ad?.typeAd === TypeAd.Buy ? true : false;\n  const pointerEvent = ad?.isActive ? 'auto' : 'none';\n  if (!ad) return null;\n  return (\n    <StyledBox width={width} typeAd={ad.typeAd} notActive={!ad.isActive}>\n      <Link\n        style={{ pointerEvents: pointerEvent, display: 'block' }}\n        component={RouterLink}\n        to={`/annunci/${ad._id}`}\n        underline='none'\n      >\n        <Typography\n          component='h5'\n          variant='h6'\n          color={isBuy ? 'textSecondary' : 'primary'}\n        >\n          {isBuy ? 'Compro' : 'Vendo'} {ad.wineName}{' '}\n          {/* {ad.wine.denominazioneZona} */}\n        </Typography>\n        <Typography\n          align='left'\n          variant='body1'\n          color={isBuy ? 'textSecondary' : 'primary'}\n        >\n          Annata: {ad.harvest}\n          <br />\n          Gradazione: {ad.abv} % Vol\n          <br />\n          Quantit√†: {ad.litersTo} l\n          <br />\n          Prezzo: {ad.priceFrom} euro al litro\n        </Typography>\n        <br />\n        <Typography\n          align='right'\n          variant='caption'\n          color={isBuy ? 'textSecondary' : 'primary'}\n        >\n          Annuncio pubblicato il {ad.datePosted}\n        </Typography>\n      </Link>\n    </StyledBox>\n  );\n};\n","import * as React from 'react';\nimport Button from '@material-ui/core/Button';\nimport Collapse from '@material-ui/core/Collapse';\nimport FilterListIcon from '@material-ui/icons/FilterList';\nimport Divider from '@material-ui/core/Divider';\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\nimport Checkbox, { CheckboxProps } from '@material-ui/core/Checkbox';\nimport { withStyles } from '@material-ui/core/styles';\nimport { deepPurple } from '@material-ui/core/colors';\nimport { searchedWine } from '../../cache';\nimport { IFilters, multiFilter } from '../../utils/multiFilter';\n\nexport const PurpleCheckbox = withStyles({\n  root: {\n    color: deepPurple[400],\n    '&$checked': {\n      color: deepPurple[600],\n    },\n  },\n  checked: {},\n})((props: CheckboxProps) => <Checkbox color='default' {...props} />);\n\ninterface FilterProps {\n  setList: React.Dispatch<React.SetStateAction<Array<any> | undefined | null>>;\n  list: Array<any>;\n  filteredList?: Array<any>;\n  setFilteredList: React.Dispatch<\n    React.SetStateAction<Array<any> | undefined | null>\n  >;\n}\n\nexport const Filter: React.FC<FilterProps> = (props) => {\n  const searchedWineCache = searchedWine();\n  const [isShowAll, setIsShowAll] = React.useState<boolean>(false);\n  const [showFilter, setShowFilter] = React.useState<boolean>(false);\n  const [filterAds, setFilterAds] = React.useState<IFilters>({\n    priceTo: (priceTo: number) =>\n      priceTo <= (searchedWineCache?.price as number),\n    abv: (abv: number) =>\n      abv >= (searchedWineCache?.abv as number) - 0.5 ||\n      abv <= (searchedWineCache?.abv as number) + 0.5,\n    harvest: (harvest: number) =>\n      harvest === (searchedWineCache?.harvest as number) ||\n      harvest - 1 === (searchedWineCache?.harvest as number),\n    litersTo: (litersTo: number) =>\n      litersTo >= (searchedWineCache?.liters as number),\n  });\n  React.useEffect(() => {\n    if (props.list.length > 0) {\n      const filtredAds = multiFilter(props.list, filterAds);\n      props.setFilteredList(filtredAds);\n    }\n  }, [filterAds, props.list]);\n  const handleShowAll = () => {\n    if (!isShowAll) {\n      setFilterAds({\n        priceTo: () => true,\n        harvest: () => true,\n        abv: () => true,\n        litersTo: () => true,\n      });\n    } else {\n      setFilterAds({\n        priceTo: (priceTo: number) =>\n          priceTo <= (searchedWineCache?.price as number),\n        abv: (abv: number) =>\n          abv >= (searchedWineCache?.abv as number) - 0.5 ||\n          abv <= (searchedWineCache?.abv as number) + 0.5,\n        harvest: (harvest: number) =>\n          harvest === (searchedWineCache?.harvest as number) ||\n          harvest - 1 === (searchedWineCache?.harvest as number),\n        litersTo: (litersTo: number) =>\n          litersTo >= (searchedWineCache?.liters as number),\n      });\n    }\n    setIsShowAll(!isShowAll);\n  };\n  return (\n    <>\n      <Button\n        onClick={() => setShowFilter(!showFilter)}\n        aria-label='filter'\n        color='primary'\n        size='large'\n        startIcon={<FilterListIcon />}\n      >\n        Filtri\n      </Button>\n      <Collapse in={showFilter}>\n        <Divider />\n        <FormControlLabel\n          control={\n            <PurpleCheckbox\n              checked={isShowAll}\n              onChange={handleShowAll}\n              name='showAll'\n            />\n          }\n          label='Mostra tutti gli annunci per questo vino'\n        />\n      </Collapse>\n    </>\n  );\n};\n","export interface IFilters {\n  [key: string]: (value: any) => boolean;\n}\n\ninterface IArray {\n  [key: string]: any;\n}\n\n// function taken from https://gist.github.com/jherax/f11d669ba286f21b7a2dcff69621eb72\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nexport function multiFilter(\n  array: Array<IArray>,\n  filters: IFilters\n): Array<IArray> {\n  const filterKeys = Object.keys(filters);\n  return array.filter((item) => {\n    // validates all filter criteria\n    return filterKeys.every((key) => {\n      // ignores non-function predicates\n      if (typeof filters[key] !== 'function') return true;\n      return filters[key](item[key]);\n    });\n  });\n}\n","import * as React from 'react';\nimport Typography from '@material-ui/core/Typography';\nimport Skeleton from '@material-ui/lab/Skeleton';\nimport CssBaseline from '@material-ui/core/CssBaseline';\nimport Container from '@material-ui/core/Container';\nimport { RouteComponentProps } from '@reach/router';\nimport {\n  QueryOrderBy,\n  useAdsForUserLazyQuery,\n  AdsWineQuery,\n} from '../generated/graphql';\nimport { BackButton } from '../components/BackButton';\nimport { Order } from '../components/FilterAds/Order';\nimport { InfiniteScroll } from '../components/InfiniteScrollFetch';\nimport { myInfo } from '../cache';\nimport { DeepExtractType } from 'ts-deep-extract-types';\nimport { CardWine } from '../components/CardWine';\nimport { AdsWineResult } from '../types';\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\nimport Divider from '@material-ui/core/Divider';\nimport { PurpleCheckbox } from '../components/FilterAds';\n\nconst MyAds: React.FC<RouteComponentProps> = () => {\n  const me = myInfo();\n  const [active, setActive] = React.useState<true | undefined>(undefined);\n  const [ads, setAds] = React.useState<\n    DeepExtractType<AdsWineQuery, ['ads']>['ads']\n  >([]);\n  const [adsFiltered, setAdsFiltered] = React.useState<\n    DeepExtractType<AdsWineQuery, ['ads']>['ads']\n  >([]);\n  const [order, setOrder] = React.useState<QueryOrderBy>(\n    QueryOrderBy.CreatedAtDesc\n  );\n  const [hideNotActive, setHideNotActive] = React.useState<boolean>(false);\n  const [query, result] = useAdsForUserLazyQuery({\n    variables: {\n      offset: 0,\n      limit: 4,\n      orderBy: QueryOrderBy.CreatedAtDesc,\n      user: me?._id as string,\n      isActive: active,\n    },\n    onError: (error) => console.log(error),\n  });\n  React.useEffect(() => {\n    if (me?._id) {\n      query();\n    }\n  }, [me]);\n  React.useEffect(() => {\n    if (result.data?.adsForUser) {\n      setAds(result.data.adsForUser.ads);\n    }\n  }, [result.data]);\n  React.useEffect(() => {\n    if (ads && ads.length && result.fetchMore) {\n      result\n        .fetchMore({\n          variables: { orderBy: order, limit: ads.length },\n        })\n        .catch((e) => console.log(e));\n    }\n  }, [order]);\n  React.useEffect(() => {\n    setAdsFiltered(ads);\n    if (hideNotActive && ads?.length) {\n      setAdsFiltered(ads?.filter((a) => a?.isActive));\n    }\n  }, [hideNotActive, ads]);\n  const handleChange = () => {\n    setHideNotActive(!hideNotActive);\n    if (hideNotActive) {\n      setActive(undefined);\n      setAdsFiltered(ads);\n    } else {\n      setActive(true);\n    }\n  };\n\n  if (ads?.length === 0) {\n    return <div>Non hai ancora creato annunci</div>;\n  }\n\n  if (ads?.length) {\n    const handleFetchMore = async () => {\n      if (result.fetchMore) {\n        try {\n          await result.fetchMore({\n            variables: {\n              offset: adsFiltered?.length,\n              orderBy: order,\n              isActive: active,\n            },\n          });\n        } catch (e) {\n          console.log(e);\n        }\n      }\n    };\n    return (\n      <Container component='main' maxWidth='xs'>\n        <CssBaseline />\n        <BackButton />\n        <br />\n        <Typography color='primary' component='h3' variant='h5'>\n          Gli annunci che hai creato\n        </Typography>\n        <br />\n        <Order setOrder={setOrder} order={order} />\n        <Divider />\n        <FormControlLabel\n          control={\n            <PurpleCheckbox\n              checked={hideNotActive}\n              onChange={handleChange}\n              name='showAll'\n            />\n          }\n          label='Nascondi gli annunci inattivi'\n        />\n        <InfiniteScroll\n          fetchMore={handleFetchMore}\n          isVisible={adsFiltered?.length !== result.data?.adsForUser?.pageCount}\n          isLoading={result.loading}\n        >\n          {' '}\n          {adsFiltered &&\n            adsFiltered.map((ad) => (\n              <CardWine key={ad && ad._id} ad={ad as AdsWineResult} />\n            ))}\n        </InfiniteScroll>\n      </Container>\n    );\n  }\n  return <Skeleton />;\n};\n\nexport default MyAds;\n"],"sourceRoot":""}