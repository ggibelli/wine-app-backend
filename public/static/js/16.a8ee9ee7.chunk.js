(this["webpackJsonpwine-app-frontend"]=this["webpackJsonpwine-app-frontend"]||[]).push([[16],{480:function(e,n,t){"use strict";t.d(n,"a",(function(){return l}));var i=t(458),r=(t(0),t(42)),a=t(481),c=t.n(a),o=t(3),l=function(){return Object(o.jsx)(i.a,{"aria-label":"previous-page",color:"primary",size:"large",startIcon:Object(o.jsx)(c.a,{}),onClick:function(){return Object(r.c)(-1)},children:"Torna indietro"})}},562:function(e,n,t){"use strict";t.r(n);var i=t(31),r=t(0),a=t(455),c=t(470),o=t(12),l=t(17),s=t(480),d=t(164),j=t(458),u=t(468),b=t(472),O=t(469),f=t(555),h=t(495),x=t(3),v=function(e){var n=e.open,t=e.handleClose,i=e.content;return Object(x.jsx)("div",{children:Object(x.jsxs)(u.a,{open:n,onClose:t,"aria-labelledby":"responsive-dialog-title",children:[Object(x.jsx)(h.a,{id:"responsive-dialog-title",children:"Notifica app"}),Object(x.jsx)(O.a,{children:Object(x.jsx)(f.a,{color:"primary",children:i})}),Object(x.jsx)(b.a,{children:Object(x.jsx)(j.a,{autoFocus:!0,onClick:t,color:"primary",children:"Chiudi"})})]})})},p=t(22),m=t(497),g=t(473),y=t(37),C=t(459),w=t(559),N=t(554),k=t(457),_=t(463),B=t(538),V=t.n(B),S=t(537),T=t.n(S),A=t(519),E=t.n(A),I=t(464),J=t(465),W=t(466),z=t(507),F=t.n(z),M=t(42),P=function(e){var n=e.messages,t=e.id,i=Object(l.c)();if(!n)return null;var a=n.filter((function(e){return e.sentTo._id===(null===i||void 0===i?void 0:i._id)})),c=n.filter((function(e){return e.sentBy._id===(null===i||void 0===i?void 0:i._id)})),o=null===a||void 0===a?void 0:a.filter((function(e){return!e.isViewed})).length,s=a.length?a[0].sentBy.firstName:c[0].sentTo.firstName,d=a.length?a[0].negotiation.ad.wineName:c[0].negotiation.ad.wineName;return Object(x.jsxs)(I.a,{divider:!0,button:!0,component:r.forwardRef((function(e,n){return Object(x.jsx)(M.a,Object(p.a)({to:"/messaggi/".concat(t),ref:n},e))})),children:[Object(x.jsx)(J.a,{children:Object(x.jsx)(k.a,{badgeContent:o,color:"primary",children:Object(x.jsx)(F.a,{})})}),Object(x.jsx)(W.a,{primary:"Cantina ".concat(s," - ").concat(d)})]})},R=t(24),q=t(140),D=function(e){var n=e.notification,t=e.handleClick;return Object(x.jsxs)(I.a,{divider:!0,button:!0,onClick:function(){return t(n._id)},children:[Object(x.jsx)(J.a,{children:Object(x.jsx)(k.a,{badgeContent:n.isViewed?0:1,color:"primary",children:Object(x.jsx)(F.a,{})})}),Object(x.jsx)(W.a,{primary:n.content})]},n._id)},G=["children","value","index"];function H(e){var n=e.children,t=e.value,i=e.index,r=Object(m.a)(e,G);return Object(x.jsx)("div",Object(p.a)(Object(p.a)({role:"tabpanel",hidden:t!==i,id:"full-width-tabpanel-".concat(i),"aria-labelledby":"full-width-tab-".concat(i)},r),{},{children:t===i&&Object(x.jsx)(g.a,{p:3,children:n})}))}function K(e){return{id:"full-width-tab-".concat(e),"aria-controls":"full-width-tabpanel-".concat(e)}}var L=function(e){var n,t,a=Object(q.c)(),c=Object(y.a)(),o=Object(l.c)(),s=r.useState(0),d=Object(i.a)(s,2),j=d[0],u=d[1],b=null===(n=e.messages)||void 0===n?void 0:n.filter((function(e){return"Amministratore"===e.sentBy.firstName})),O=null===(t=e.messages)||void 0===t?void 0:t.filter((function(e){return"Amministratore"!==e.sentBy.firstName})),f=Object(R.groupBy)(O,(function(e){return e.negotiation._id})),h=Object.entries(f).sort((function(e,n){return e[0].localeCompare(n[0])})),v=h.map((function(e){return e[1]})).flat(),m=null===b||void 0===b?void 0:b.filter((function(e){return!e.isViewed})).length,g=v.filter((function(e){return!e.isViewed&&e.sentBy._id!==(null===o||void 0===o?void 0:o._id)})).length;return Object(x.jsxs)("div",{className:a.paper,children:[Object(x.jsx)(C.a,{position:"static",color:"transparent",style:{boxShadow:"none"},children:Object(x.jsxs)(w.a,{value:j,onChange:function(e,n){u(n)},style:{color:"#6d1331"},indicatorColor:"secondary",textColor:"inherit",variant:"fullWidth","aria-label":"notifications",children:[Object(x.jsx)(N.a,Object(p.a)({icon:Object(x.jsx)(T.a,{}),label:Object(x.jsx)(k.a,{badgeContent:g,color:"primary",children:"Messaggi"})},K(0))),Object(x.jsx)(N.a,Object(p.a)({icon:Object(x.jsx)(V.a,{}),label:Object(x.jsx)(k.a,{badgeContent:m,color:"primary",children:"Notifiche"})},K(1)))]})}),Object(x.jsxs)(E.a,{axis:"rtl"===c.direction?"x-reverse":"x",index:j,onChangeIndex:function(e){u(e)},children:[Object(x.jsx)(H,{value:j,index:0,dir:c.direction,children:Object(x.jsx)(_.a,{children:h.map((function(e){return Object(x.jsx)(P,{messages:e[1],id:e[0]},e[0])}))})}),Object(x.jsx)(H,{value:j,index:1,dir:c.direction,children:Object(x.jsx)(_.a,{children:null===b||void 0===b?void 0:b.map((function(n){return Object(x.jsx)(D,{notification:n,handleClick:e.handleClickNotification},n._id)}))})})]})]})};n.default=function(){var e,n,t=Object(o.C)({fetchPolicy:"network-only",onError:function(e){Object(l.d)({type:"error",message:e.message})}}),j=t.data,u=t.loading,b=t.error,O=Object(o.w)({onError:function(e){Object(l.d)({type:"error",message:e.message})}}),f=Object(i.a)(O,2),h=f[0],p=f[1],m=r.useState(!1),g=Object(i.a)(m,2),y=g[0],C=g[1];return u?Object(x.jsx)(d.a,{}):b?Object(x.jsx)("div",{children:"error"}):Object(x.jsxs)(c.a,{component:"main",maxWidth:"sm",children:[Object(x.jsx)(a.a,{}),Object(x.jsx)(s.a,{}),Object(x.jsx)(L,{messages:null===j||void 0===j?void 0:j.messages,handleClickNotification:function(e){h({variables:{id:e}}),C(!0)}}),p.loading?Object(x.jsx)(d.a,{}):Object(x.jsx)(v,{open:y,handleClose:function(){C(!1)},content:null===(e=p.data)||void 0===e||null===(n=e.message)||void 0===n?void 0:n.content,loading:p.loading})]})}}}]);