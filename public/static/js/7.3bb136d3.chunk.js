(this["webpackJsonpwine-app-frontend"]=this["webpackJsonpwine-app-frontend"]||[]).push([[7],{450:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var i=n(4),a=n(436),o=(n(0),n(23)),r=n(41),c=n(451),s=n.n(c),d=n(15),l=function(){var e=Object(o.e)(),t=Object(r.d)().pathname;return"annunci"===t.split("/")[1]&&t.split("/")[2]?Object(i.jsx)(a.a,{component:r.a,to:"/annunci",color:"primary",size:"large",startIcon:Object(i.jsx)(s.a,{}),children:"Annunci"}):(null===e||void 0===e?void 0:e.typeAd)===d.k.Buy&&"/buy"!==t?Object(i.jsx)(a.a,{component:r.a,to:"/buy",color:"primary",size:"large",startIcon:Object(i.jsx)(s.a,{}),children:"Compra"}):(null===e||void 0===e?void 0:e.typeAd)===d.k.Sell&&"/sell"!==t?Object(i.jsx)(a.a,{component:r.a,to:"/sell",color:"primary",size:"large",startIcon:Object(i.jsx)(s.a,{}),children:"Vendi"}):Object(i.jsx)(a.a,{color:"primary",size:"large",startIcon:Object(i.jsx)(s.a,{}),onClick:function(){return Object(r.c)(-1)},children:"Torna indietro"})}},451:function(e,t,n){"use strict";var i=n(46),a=n(47);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=a(n(0)),r=(0,i(n(48)).default)(o.createElement("path",{d:"M11.67 3.87L9.9 2.1 0 12l9.9 9.9 1.77-1.77L3.54 12z"}),"ArrowBackIos");t.default=r},452:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(4),a=(n(0),n(445)),o=n(15),r=function(e){var t=e.notActive?"#b2b2b2":"white",n=e.notActive?"#8a425a":"primary.main";return Object(i.jsx)(a.a,{boxShadow:3,p:2,m:2,mt:2,px:2,pt:2,width:e.width,color:e.typeAd===o.k.Sell?"primary.main":"white",borderColor:e.typeAd===o.k.Sell?"white":"primary.main",bgcolor:e.typeAd===o.k.Sell?t:n,borderRadius:16,children:e.children})}},453:function(e,t,n){"use strict";var i=n(46),a=n(47);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=a(n(0)),r=(0,i(n(48)).default)(o.createElement("path",{d:"M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z"}),"ExpandMore");t.default=r},456:function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));var i=n(4),a=n(81),o=n.n(a),r=n(103),c=n(26),s=n(436),d=(n(0),n(23)),l=n(15),u=n(131),v=function(e){var t=e.id,n=e.isBuy,a=Object(u.c)(),v=Object(l.L)({onCompleted:function(e){var t,n;if(null===(t=e.updateNegotiation)||void 0===t||null===(n=t.errors)||void 0===n?void 0:n.length){var i,a=null===(i=e.updateNegotiation)||void 0===i?void 0:i.errors.map((function(e){return null===e||void 0===e?void 0:e.text}));Object(d.d)({type:"error",message:"".concat(a.toString())})}else Object(d.d)({message:"trattativa chiusa con successo",type:"success"})},onError:function(e){return Object(d.d)({type:"error",message:e.message})}}),j=Object(c.a)(v,2),b=j[0],p=j[1].loading,m=function(){var e=Object(r.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b({variables:{negotiation:{_id:t,isConcluded:!0}}});case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(i.jsx)(s.a,{className:n?a.buyButton:a.sellButton,disabled:p,onClick:m,children:"Dichiara chiusa la trattativa"})}},468:function(e,t,n){"use strict";var i=n(1),a=n(5),o=n(0),r=(n(10),n(7)),c=n(8),s=n(11),d=44,l=o.forwardRef((function(e,t){var n=e.classes,c=e.className,l=e.color,u=void 0===l?"primary":l,v=e.disableShrink,j=void 0!==v&&v,b=e.size,p=void 0===b?40:b,m=e.style,f=e.thickness,h=void 0===f?3.6:f,O=e.value,x=void 0===O?0:O,y=e.variant,g=void 0===y?"indeterminate":y,k=Object(a.a)(e,["classes","className","color","disableShrink","size","style","thickness","value","variant"]),E={},C={},w={};if("determinate"===g||"static"===g){var N=2*Math.PI*((d-h)/2);E.strokeDasharray=N.toFixed(3),w["aria-valuenow"]=Math.round(x),E.strokeDashoffset="".concat(((100-x)/100*N).toFixed(3),"px"),C.transform="rotate(-90deg)"}return o.createElement("div",Object(i.a)({className:Object(r.a)(n.root,c,"inherit"!==u&&n["color".concat(Object(s.a)(u))],{determinate:n.determinate,indeterminate:n.indeterminate,static:n.static}[g]),style:Object(i.a)({width:p,height:p},C,m),ref:t,role:"progressbar"},w,k),o.createElement("svg",{className:n.svg,viewBox:"".concat(22," ").concat(22," ").concat(d," ").concat(d)},o.createElement("circle",{className:Object(r.a)(n.circle,j&&n.circleDisableShrink,{determinate:n.circleDeterminate,indeterminate:n.circleIndeterminate,static:n.circleStatic}[g]),style:E,cx:d,cy:d,r:(d-h)/2,fill:"none",strokeWidth:h})))}));t.a=Object(c.a)((function(e){return{root:{display:"inline-block"},static:{transition:e.transitions.create("transform")},indeterminate:{animation:"$circular-rotate 1.4s linear infinite"},determinate:{transition:e.transitions.create("transform")},colorPrimary:{color:e.palette.primary.main},colorSecondary:{color:e.palette.secondary.main},svg:{display:"block"},circle:{stroke:"currentColor"},circleStatic:{transition:e.transitions.create("stroke-dashoffset")},circleIndeterminate:{animation:"$circular-dash 1.4s ease-in-out infinite",strokeDasharray:"80px, 200px",strokeDashoffset:"0px"},circleDeterminate:{transition:e.transitions.create("stroke-dashoffset")},"@keyframes circular-rotate":{"0%":{transformOrigin:"50% 50%"},"100%":{transform:"rotate(360deg)"}},"@keyframes circular-dash":{"0%":{strokeDasharray:"1px, 200px",strokeDashoffset:"0px"},"50%":{strokeDasharray:"100px, 200px",strokeDashoffset:"-15px"},"100%":{strokeDasharray:"100px, 200px",strokeDashoffset:"-125px"}},circleDisableShrink:{animation:"none"}}}),{name:"MuiCircularProgress",flip:!1})(l)},486:function(e,t,n){"use strict";var i=n(1),a=n(49),o=n(5),r=n(0),c=n(7),s=(n(10),n(231)),d=n(8),l=n(29),u=n(36),v=n(35),j=n(16),b=r.forwardRef((function(e,t){var n=e.children,d=e.classes,b=e.className,p=e.collapsedHeight,m=void 0===p?"0px":p,f=e.component,h=void 0===f?"div":f,O=e.disableStrictModeCompat,x=void 0!==O&&O,y=e.in,g=e.onEnter,k=e.onEntered,E=e.onEntering,C=e.onExit,w=e.onExited,N=e.onExiting,A=e.style,_=e.timeout,z=void 0===_?l.b.standard:_,B=e.TransitionComponent,D=void 0===B?s.a:B,S=Object(o.a)(e,["children","classes","className","collapsedHeight","component","disableStrictModeCompat","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"]),M=Object(v.a)(),I=r.useRef(),L=r.useRef(null),F=r.useRef(),P="number"===typeof m?"".concat(m,"px"):m;r.useEffect((function(){return function(){clearTimeout(I.current)}}),[]);var R=M.unstable_strictMode&&!x,H=r.useRef(null),T=Object(j.a)(t,R?H:void 0),Q=function(e){return function(t,n){if(e){var i=R?[H.current,t]:[t,n],o=Object(a.a)(i,2),r=o[0],c=o[1];void 0===c?e(r):e(r,c)}}},V=Q((function(e,t){e.style.height=P,g&&g(e,t)})),q=Q((function(e,t){var n=L.current?L.current.clientHeight:0,i=Object(u.a)({style:A,timeout:z},{mode:"enter"}).duration;if("auto"===z){var a=M.transitions.getAutoHeightDuration(n);e.style.transitionDuration="".concat(a,"ms"),F.current=a}else e.style.transitionDuration="string"===typeof i?i:"".concat(i,"ms");e.style.height="".concat(n,"px"),E&&E(e,t)})),W=Q((function(e,t){e.style.height="auto",k&&k(e,t)})),J=Q((function(e){var t=L.current?L.current.clientHeight:0;e.style.height="".concat(t,"px"),C&&C(e)})),$=Q(w),G=Q((function(e){var t=L.current?L.current.clientHeight:0,n=Object(u.a)({style:A,timeout:z},{mode:"exit"}).duration;if("auto"===z){var i=M.transitions.getAutoHeightDuration(t);e.style.transitionDuration="".concat(i,"ms"),F.current=i}else e.style.transitionDuration="string"===typeof n?n:"".concat(n,"ms");e.style.height=P,N&&N(e)}));return r.createElement(D,Object(i.a)({in:y,onEnter:V,onEntered:W,onEntering:q,onExit:J,onExited:$,onExiting:G,addEndListener:function(e,t){var n=R?e:t;"auto"===z&&(I.current=setTimeout(n,F.current||0))},nodeRef:R?H:void 0,timeout:"auto"===z?null:z},S),(function(e,t){return r.createElement(h,Object(i.a)({className:Object(c.a)(d.container,b,{entered:d.entered,exited:!y&&"0px"===P&&d.hidden}[e]),style:Object(i.a)({minHeight:P},A),ref:T},t),r.createElement("div",{className:d.wrapper,ref:L},r.createElement("div",{className:d.wrapperInner},n)))}))}));b.muiSupportAuto=!0,t.a=Object(d.a)((function(e){return{container:{height:0,overflow:"hidden",transition:e.transitions.create("height")},entered:{height:"auto",overflow:"visible"},hidden:{visibility:"hidden"},wrapper:{display:"flex"},wrapperInner:{width:"100%"}}}),{name:"MuiCollapse"})(b)},487:function(e,t,n){"use strict";var i=n(46),a=n(47);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=a(n(0)),r=(0,i(n(48)).default)(o.createElement("path",{d:"M16.5 3c-1.74 0-3.41.81-4.5 2.09C10.91 3.81 9.24 3 7.5 3 4.42 3 2 5.42 2 8.5c0 3.78 3.4 6.86 8.55 11.54L12 21.35l1.45-1.32C18.6 15.36 22 12.28 22 8.5 22 5.42 19.58 3 16.5 3zm-4.4 15.55l-.1.1-.1-.1C7.14 14.24 4 11.39 4 8.5 4 6.5 5.5 5 7.5 5c1.54 0 3.04.99 3.57 2.36h1.87C13.46 5.99 14.96 5 16.5 5c2 0 3.5 1.5 3.5 3.5 0 2.89-3.14 5.74-7.9 10.05z"}),"FavoriteBorder");t.default=r},488:function(e,t,n){"use strict";var i=n(46),a=n(47);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=a(n(0)),r=(0,i(n(48)).default)(o.createElement("path",{d:"M12 8l-6 6 1.41 1.41L12 10.83l4.59 4.58L18 14z"}),"ExpandLess");t.default=r},513:function(e,t,n){"use strict";n.r(t);var i=n(4),a=n(26),o=n(0),r=n(41),c=n(15),s=n(377),d=n(468),l=n(23),u=n(90),v=n(436),j=n(437),b=n(487),p=n.n(b),m=n(378),f=n(173),h=n.n(f),O=n(34),x=n.n(O),y=function(e){var t=e.ad,n=Object(c.K)({onError:function(e){return console.log(e)},update:function(e,n){var i=x.a.cloneDeep(e.readQuery({query:c.b}));if((null===i||void 0===i?void 0:i.me.savedAds)&&l){var a=null===i||void 0===i?void 0:i.me.savedAds.findIndex((function(e){return e._id===(null===t||void 0===t?void 0:t._id)}));null===i||void 0===i||i.me.savedAds.splice(a,1)}else if(null===i||void 0===i?void 0:i.me.savedAds){var o,r;null===i||void 0===i||i.me.savedAds.push(null===(o=n.data)||void 0===o||null===(r=o.saveAd)||void 0===r?void 0:r.response)}e.writeQuery({query:c.b,data:i})}}),r=Object(a.a)(n,1)[0],s=o.useState(!1),d=Object(a.a)(s,2),l=d[0],u=d[1];return Object(i.jsx)(m.a,{"aria-label":"save",onClick:function(){return e=null===t||void 0===t?void 0:t._id,r({variables:{id:e}}),void u(!l);var e},children:l?Object(i.jsx)(h.a,{}):Object(i.jsx)(p.a,{})})},g=n(438),k=n(440),E=n(439),C=function(e){var t=e.handleClose,n=e.open,a=e.createNegotiation;return Object(i.jsx)("div",{children:Object(i.jsxs)(g.a,{open:n,onClose:t,"aria-labelledby":"open-negotiation",children:[Object(i.jsx)(E.a,{children:Object(i.jsx)(v.a,{onClick:function(){a(),t()},children:" Apri la trattativa"})}),Object(i.jsx)(k.a,{children:Object(i.jsx)(v.a,{onClick:t,color:"primary",children:"Cancel"})})]})})},w=n(452),N=n(131),A=function(e){var t,n,r,s,d=e.ad,l=e.createNegotiation,b=e.me,p=Object(N.c)(),m=(null===d||void 0===d?void 0:d.typeAd)===c.k.Buy,f=o.useState(!1),h=Object(a.a)(f,2),O=h[0],x=h[1],g=function(){x(!0)},k=function(){x(!1)},E=function(){var e;return(null===b||void 0===b?void 0:b._id)===(null===d||void 0===d?void 0:d.postedBy._id)?Object(i.jsx)(v.a,{className:m?p.buyButton:p.sellButton,children:"Modifica l annuncio"}):(null===b||void 0===b||null===(e=b.negotiations)||void 0===e?void 0:e.find((function(e){return(null===e||void 0===e?void 0:e.ad._id)===(null===d||void 0===d?void 0:d._id)})))?Object(i.jsx)("div",{children:"negoziazione gia aperta"}):(null===d||void 0===d?void 0:d.isActive)?Object(i.jsxs)(i.Fragment,{children:[Object(i.jsxs)(v.a,{className:m?p.buyButton:p.sellButton,onClick:g,children:["Contatta il ",(null===d||void 0===d?void 0:d.typeAd)===c.k.Buy?"compratore":"venditore"]}),Object(i.jsx)(C,{handleClose:k,open:O,createNegotiation:l})]}):Object(i.jsx)(u.a,{children:"Annuncio non piu attivo "})},A="AdWine"===(null===d||void 0===d?void 0:d.__typename)?d:null;return Object(i.jsxs)(w.a,{width:1,typeAd:null===d||void 0===d?void 0:d.typeAd,children:[(null===d||void 0===d?void 0:d.postedBy._id)!==(null===b||void 0===b?void 0:b._id)?Object(i.jsx)(y,{ad:d}):null,Object(i.jsxs)(u.a,{component:"h5",variant:"h5",children:["L'utente ",null===d||void 0===d?void 0:d.postedBy.firstName," ",m?"compra":"vende",":"]}),Object(i.jsxs)(u.a,{align:"left",variant:"h6",children:[null===A||void 0===A?void 0:A.wineName," ",null===A||void 0===A||null===(t=A.wine)||void 0===t?void 0:t.denominazioneZona,Object(i.jsx)("br",{}),"Annata: ",null===d||void 0===d?void 0:d.harvest,Object(i.jsx)("br",{}),"Gradazione: ",null===d||void 0===d?void 0:d.abv," % Vol",Object(i.jsx)("br",{}),"Quantit\xe0: ",null===A||void 0===A?void 0:A.litersTo,Object(i.jsx)("br",{}),"Prezzo: ",null===d||void 0===d?void 0:d.priceFrom," euro al litro"]}),Object(i.jsx)("br",{}),Object(i.jsx)(u.a,{align:"left",component:"h5",variant:"h5",children:"Indirizzo"}),Object(i.jsx)("br",{}),Object(i.jsxs)(u.a,{align:"left",variant:"h6",children:["Regione: ",null===d||void 0===d||null===(n=d.address)||void 0===n?void 0:n.regione,Object(i.jsx)("br",{}),"Provincia: ",null===d||void 0===d||null===(r=d.address)||void 0===r?void 0:r.provincia,Object(i.jsx)("br",{}),"Comune: ",null===d||void 0===d||null===(s=d.address)||void 0===s?void 0:s.comune]}),Object(i.jsx)("br",{}),Object(i.jsx)(E,{}),Object(i.jsxs)(j.a,{container:!0,justify:"space-between",children:[Object(i.jsxs)(u.a,{align:"left",variant:"caption",children:["Annuncio visualizzato ",null===d||void 0===d?void 0:d.numberViews," volte"]}),Object(i.jsxs)(u.a,{align:"right",variant:"caption",children:["Negoziazioni attive: ",null===d||void 0===d?void 0:d.activeNegotiations]})]})]})},_=n(434),z=n(435),B=n(450),D=n(97),S=n(430),M=n(426),I=n(423),L=n(456),F=n(486),P=n(453),R=n.n(P),H=n(488),T=n.n(H),Q=function(e){var t,n,c=e.data,s=e.showNegotiations,d=Object(N.c)(),l=o.useState(!1),j=Object(a.a)(l,2),b=j[0],p=j[1];return c.loading?Object(i.jsx)("div",{children:"loading"}):c.error?Object(i.jsx)("div",{children:"error"}):Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)(m.a,{onClick:function(){b||s(),p(!b)},children:b?Object(i.jsx)(T.a,{}):Object(i.jsx)(R.a,{})}),Object(i.jsx)(F.a,{in:b,children:Object(i.jsx)(S.a,{"aria-label":"negotiations",children:null===c||void 0===c||null===(t=c.data)||void 0===t||null===(n=t.negotiationsForAd)||void 0===n?void 0:n.map((function(e){return Object(i.jsxs)("div",{children:[Object(i.jsx)(M.a,{children:Object(i.jsxs)("div",{children:[Object(i.jsx)(u.a,{color:"primary",component:"h3",variant:"h5",children:e.createdBy.firstName}),Object(i.jsx)("br",{}),Object(i.jsxs)(u.a,{color:"secondary",variant:"body1",children:["aperta il ",e.dateCreated," ",e.dateConcluded?"chiusa il ".concat(e.dateConcluded):null]}),Object(i.jsx)("br",{}),Object(i.jsx)(v.a,{className:d.buyButton,component:r.a,to:"/messaggi/".concat(e._id),children:"Vai alla chat"}),Object(i.jsx)("br",{}),e.isConcluded?Object(i.jsx)(v.a,{children:"Lascia una recensione"}):Object(i.jsx)(L.a,{isBuy:!0,id:e._id})]})}),Object(i.jsx)(I.a,{})]},e._id)}))})})]})};t.default=function(){var e,t=o.useState(void 0),n=Object(a.a)(t,2),v=n[0],j=n[1],b=Object(r.e)().id,p=Object(c.n)({variables:{id:b},onCompleted:function(e){return(null===e||void 0===e?void 0:e.ad)?j(null===e||void 0===e?void 0:e.ad):null}}),m=p.data,f=p.loading,h=p.error;o.useEffect((function(){(null===m||void 0===m?void 0:m.ad)&&j(null===m||void 0===m?void 0:m.ad)}),[null===m||void 0===m||null===(e=m.ad)||void 0===e?void 0:e.activeNegotiations]);var O=Object(c.s)({onCompleted:function(e){var t,n;if(null===(t=e.createNegotiation)||void 0===t||null===(n=t.errors)||void 0===n?void 0:n.length){var i,a=null===(i=e.createNegotiation)||void 0===i?void 0:i.errors.map((function(e){return null===e||void 0===e?void 0:e.text}));Object(l.d)({type:"error",message:"".concat(a.toString())})}else Object(l.d)({message:"trattativa creata con successo",type:"success"})},onError:function(e){return Object(l.d)({type:"error",message:"errore durante creazione trattativa: ".concat(e.message)})},update:function(e,t){var n,i;Object(D.d)(e,null===(n=t.data)||void 0===n||null===(i=n.createNegotiation)||void 0===i?void 0:i.response)}}),x=Object(a.a)(O,1)[0],y=Object(c.F)(),g=Object(a.a)(y,2),k=g[0],E=g[1],C=Object(N.c)();if(h&&!f)return Object(l.d)({type:"error",message:"".concat(h.message)}),Object(i.jsx)("div",{children:"Errore"});var w,S=(null===v||void 0===v?void 0:v.typeAd)===c.k.Buy?"L'acquirente":"Il venditore";return(null===v||void 0===v?void 0:v._id)?Object(i.jsxs)(_.a,{component:"main",maxWidth:"xs",children:[Object(i.jsx)(z.a,{}),Object(i.jsx)(B.a,{}),Object(i.jsxs)("div",{className:C.paper,children:[Object(i.jsxs)(u.a,{color:"primary",component:"h3",variant:"h5",children:["Contatta ",S]}),Object(i.jsx)(u.a,{color:"secondary",variant:"body1",children:"Questo \xe8 uno degli annunci che abbiamo selezionato per te: verifica anche tu i parametri e decidi se procedere."})]}),Object(i.jsx)(A,{ad:v,createNegotiation:function(){var e={forUserAd:null===v||void 0===v?void 0:v.postedBy._id,ad:null===v||void 0===v?void 0:v._id,type:null===v||void 0===v?void 0:v.typeAd};x({variables:{negotiation:e}})},me:null===m||void 0===m?void 0:m.me}),(null===m||void 0===m||null===(w=m.me)||void 0===w?void 0:w._id)===v.postedBy._id?Object(i.jsx)(Q,{data:E,showNegotiations:function(){k({variables:{ad:b}})}}):null]}):Object(i.jsx)(i.Fragment,{children:Object(i.jsx)(s.a,{className:C.backdrop,open:f,children:Object(i.jsx)(d.a,{color:"inherit"})})})}}}]);
//# sourceMappingURL=7.3bb136d3.chunk.js.map