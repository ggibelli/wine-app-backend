{"version":3,"sources":["components/BackButton.tsx","../node_modules/@material-ui/icons/ArrowBackIos.js","../node_modules/@material-ui/lab/esm/Skeleton/Skeleton.js","../node_modules/@material-ui/icons/MailOutline.js","components/MessageListEl.tsx","pages/Messages.tsx"],"names":["BackButton","searchedWineCache","searchedWine","pathname","useLocation","split","component","Link","to","color","size","startIcon","typeAd","TypeAd","Buy","Sell","onClick","navigate","_interopRequireDefault","require","_interopRequireWildcard","Object","defineProperty","exports","value","default","React","_default","createElement","d","Skeleton","props","ref","_props$animation","animation","classes","className","_props$component","Component","height","_props$variant","variant","width","other","_objectWithoutProperties","hasChildren","Boolean","children","_extends","clsx","root","withChildren","fitContent","heightAuto","style","withStyles","theme","display","backgroundColor","fade","palette","text","primary","type","marginTop","marginBottom","transformOrigin","transform","borderRadius","shape","content","rect","circle","pulse","opacity","wave","position","overflow","background","concat","action","hover","bottom","left","right","top","visibility","maxWidth","name","MessageListEl","messages","id","me","myInfo","messagesForMe","filter","message","sentTo","_id","messagesFromMe","sentBy","unreadMessages","isViewed","length","recipient","firstName","ad","negotiation","wineName","ListItem","button","itemProps","ListItemIcon","Badge","badgeContent","ListItemText","Divider","Messages","messagesResult","useMessagesQuery","fetchPolicy","onError","error","notification","data","messagesForNegotiationObj","_","groupBy","messagesForNegotiation","entries","sort","a","b","localeCompare","loading","Container","CssBaseline","List","map","el"],"mappings":"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","file":"static/js/12.2c5507fa.chunk.js","sourcesContent":["import Button from '@material-ui/core/Button';\nimport * as React from 'react';\nimport { searchedWine } from '../cache';\nimport { Link, useLocation, navigate } from '@reach/router';\nimport ArrowBackIosIcon from '@material-ui/icons/ArrowBackIos';\nimport { TypeAd } from '../generated/graphql';\n\nexport const BackButton: React.FC = () => {\n  const searchedWineCache = searchedWine();\n  const { pathname } = useLocation();\n  if (pathname.split('/')[1] === 'annunci' && pathname.split('/')[2]) {\n    return (\n      <Button\n        component={Link}\n        to='/annunci'\n        //variant='contained'\n        color='primary'\n        size='large'\n        startIcon={<ArrowBackIosIcon />}\n      >\n        Annunci\n      </Button>\n    );\n  } else if (searchedWineCache?.typeAd === TypeAd.Buy && pathname !== '/buy') {\n    return (\n      <Button\n        component={Link}\n        to='/buy'\n        //variant='contained'\n        color='primary'\n        size='large'\n        startIcon={<ArrowBackIosIcon />}\n      >\n        Compra\n      </Button>\n    );\n  } else if (\n    searchedWineCache?.typeAd === TypeAd.Sell &&\n    pathname !== '/sell'\n  ) {\n    return (\n      <Button\n        component={Link}\n        to='/sell'\n        //variant='contained'\n        color='primary'\n        size='large'\n        startIcon={<ArrowBackIosIcon />}\n      >\n        Vendi\n      </Button>\n    );\n  } else\n    return (\n      <Button\n        color='primary'\n        size='large'\n        startIcon={<ArrowBackIosIcon />}\n        onClick={() => navigate(-1)}\n      >\n        Torna indietro\n      </Button>\n    );\n};\n","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar React = _interopRequireWildcard(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M11.67 3.87L9.9 2.1 0 12l9.9 9.9 1.77-1.77L3.54 12z\"\n}), 'ArrowBackIos');\n\nexports.default = _default;","import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport * as React from 'react';\nimport clsx from 'clsx';\nimport PropTypes from 'prop-types';\nimport { fade, withStyles } from '@material-ui/core/styles';\nexport var styles = function styles(theme) {\n  return {\n    /* Styles applied to the root element. */\n    root: {\n      display: 'block',\n      // Create a \"on paper\" color with sufficient contrast retaining the color\n      backgroundColor: fade(theme.palette.text.primary, theme.palette.type === 'light' ? 0.11 : 0.13),\n      height: '1.2em'\n    },\n\n    /* Styles applied to the root element if `variant=\"text\"`. */\n    text: {\n      marginTop: 0,\n      marginBottom: 0,\n      height: 'auto',\n      transformOrigin: '0 60%',\n      transform: 'scale(1, 0.60)',\n      borderRadius: theme.shape.borderRadius,\n      '&:empty:before': {\n        content: '\"\\\\00a0\"'\n      }\n    },\n\n    /* Styles applied to the root element if `variant=\"rect\"`. */\n    rect: {},\n\n    /* Styles applied to the root element if `variant=\"circle\"`. */\n    circle: {\n      borderRadius: '50%'\n    },\n\n    /* Styles applied to the root element if `animation=\"pulse\"`. */\n    pulse: {\n      animation: '$pulse 1.5s ease-in-out 0.5s infinite'\n    },\n    '@keyframes pulse': {\n      '0%': {\n        opacity: 1\n      },\n      '50%': {\n        opacity: 0.4\n      },\n      '100%': {\n        opacity: 1\n      }\n    },\n\n    /* Styles applied to the root element if `animation=\"wave\"`. */\n    wave: {\n      position: 'relative',\n      overflow: 'hidden',\n      '&::after': {\n        animation: '$wave 1.6s linear 0.5s infinite',\n        background: \"linear-gradient(90deg, transparent, \".concat(theme.palette.action.hover, \", transparent)\"),\n        content: '\"\"',\n        position: 'absolute',\n        transform: 'translateX(-100%)',\n        // Avoid flash during server-side hydration\n        bottom: 0,\n        left: 0,\n        right: 0,\n        top: 0\n      }\n    },\n    '@keyframes wave': {\n      '0%': {\n        transform: 'translateX(-100%)'\n      },\n      '60%': {\n        // +0.5s of delay between each loop\n        transform: 'translateX(100%)'\n      },\n      '100%': {\n        transform: 'translateX(100%)'\n      }\n    },\n\n    /* Styles applied when the component is passed children. */\n    withChildren: {\n      '& > *': {\n        visibility: 'hidden'\n      }\n    },\n\n    /* Styles applied when the component is passed children and no width. */\n    fitContent: {\n      maxWidth: 'fit-content'\n    },\n\n    /* Styles applied when the component is passed children and no height. */\n    heightAuto: {\n      height: 'auto'\n    }\n  };\n};\nvar Skeleton = /*#__PURE__*/React.forwardRef(function Skeleton(props, ref) {\n  var _props$animation = props.animation,\n      animation = _props$animation === void 0 ? 'pulse' : _props$animation,\n      classes = props.classes,\n      className = props.className,\n      _props$component = props.component,\n      Component = _props$component === void 0 ? 'span' : _props$component,\n      height = props.height,\n      _props$variant = props.variant,\n      variant = _props$variant === void 0 ? 'text' : _props$variant,\n      width = props.width,\n      other = _objectWithoutProperties(props, [\"animation\", \"classes\", \"className\", \"component\", \"height\", \"variant\", \"width\"]);\n\n  var hasChildren = Boolean(other.children);\n  return /*#__PURE__*/React.createElement(Component, _extends({\n    ref: ref,\n    className: clsx(classes.root, classes[variant], className, hasChildren && [classes.withChildren, !width && classes.fitContent, !height && classes.heightAuto], animation !== false && classes[animation])\n  }, other, {\n    style: _extends({\n      width: width,\n      height: height\n    }, other.style)\n  }));\n});\nprocess.env.NODE_ENV !== \"production\" ? Skeleton.propTypes = {\n  /**\n   * The animation.\n   * If `false` the animation effect is disabled.\n   */\n  animation: PropTypes.oneOf(['pulse', 'wave', false]),\n\n  /**\n   * Optional children to infer width and height from.\n   */\n  children: PropTypes.node,\n\n  /**\n   * Override or extend the styles applied to the component.\n   * See [CSS API](#css) below for more details.\n   */\n  classes: PropTypes.object.isRequired,\n\n  /**\n   * @ignore\n   */\n  className: PropTypes.string,\n\n  /**\n   * The component used for the root node.\n   * Either a string to use a HTML element or a component.\n   */\n  component: PropTypes\n  /* @typescript-to-proptypes-ignore */\n  .elementType,\n\n  /**\n   * Height of the skeleton.\n   * Useful when you don't want to adapt the skeleton to a text element but for instance a card.\n   */\n  height: PropTypes.oneOfType([PropTypes.number, PropTypes.string]),\n\n  /**\n   * The type of content that will be rendered.\n   */\n  variant: PropTypes.oneOf(['text', 'rect', 'circle']),\n\n  /**\n   * Width of the skeleton.\n   * Useful when the skeleton is inside an inline element with no width of its own.\n   */\n  width: PropTypes.oneOfType([PropTypes.number, PropTypes.string])\n} : void 0;\nexport default withStyles(styles, {\n  name: 'MuiSkeleton'\n})(Skeleton);","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar React = _interopRequireWildcard(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 14H4V8l8 5 8-5v10zm-8-7L4 6h16l-8 5z\"\n}), 'MailOutline');\n\nexports.default = _default;","/* eslint-disable @typescript-eslint/restrict-template-expressions */\nimport * as React from 'react';\nimport Divider from '@material-ui/core/Divider';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport MailOutlineIcon from '@material-ui/icons/MailOutline';\nimport Badge from '@material-ui/core/Badge';\nimport { Link as RouterLink } from '@reach/router';\nimport { myInfo } from '../cache';\nimport { MessagesQuery } from '../generated/graphql';\n\nexport const MessageListEl: React.FC<{\n  id: string;\n  messages: MessagesQuery['messages'];\n}> = ({ messages, id }) => {\n  const me = myInfo();\n  if (!messages) return null;\n  const messagesForMe = messages.filter(\n    (message) => message.sentTo._id === me?._id\n  );\n  const messagesFromMe = messages.filter(\n    (message) => message.sentBy._id === me?._id\n  );\n  const unreadMessages = messagesForMe?.filter((message) => !message.isViewed)\n    .length;\n\n  const recipient = messagesForMe.length\n    ? messagesForMe[0].sentBy.firstName\n    : messagesFromMe[0].sentTo.firstName;\n  // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment\n  const ad = messagesForMe.length\n    ? //@ts-expect-error I know is a adWine\n      (messagesForMe[0].negotiation.ad.wineName as string)\n    : //@ts-expect-error I know is a adWine\n      (messagesFromMe[0].negotiation.ad.wineName as string);\n\n  return (\n    <>\n      <ListItem\n        button\n        // eslint-disable-next-line react/display-name\n        component={React.forwardRef((itemProps, ref) => (\n          //ts ignore because followed the mui docs\n\n          <RouterLink\n            to={`/messaggi/${id}`}\n            // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n            //@ts-ignore\n            ref={ref}\n            {...itemProps}\n          />\n        ))}\n      >\n        <ListItemIcon>\n          <Badge badgeContent={unreadMessages} color='primary'>\n            <MailOutlineIcon />\n          </Badge>\n        </ListItemIcon>\n        <ListItemText\n          primary={\n            recipient === 'Amministratore'\n              ? 'Amministratore'\n              : `Cantina ${recipient} - ${ad}`\n          }\n        />\n      </ListItem>\n      <Divider />\n    </>\n  );\n};\n","import * as React from 'react';\nimport Skeleton from '@material-ui/lab/Skeleton';\nimport CssBaseline from '@material-ui/core/CssBaseline';\nimport Container from '@material-ui/core/Container';\nimport List from '@material-ui/core/List';\nimport { useMessagesQuery } from '../generated/graphql';\nimport _ from 'lodash';\nimport { MessageListEl } from '../components/MessageListEl';\nimport { notification } from '../cache';\nimport { RouteComponentProps } from '@reach/router';\nimport { BackButton } from '../components/BackButton';\n\nconst Messages: React.FC<RouteComponentProps> = () => {\n  const messagesResult = useMessagesQuery({\n    fetchPolicy: 'network-only',\n    onError: (error) => {\n      notification({\n        type: 'error',\n        message: error.message,\n      });\n    },\n  });\n  const messages =\n    messagesResult.data?.messages && messagesResult.data?.messages;\n  const messagesForNegotiationObj = _.groupBy(\n    messages,\n    (message) => message.negotiation._id\n  );\n  const messagesForNegotiation = Object.entries(\n    messagesForNegotiationObj\n  ).sort((a, b) => a[0].localeCompare(b[0]));\n  if (messagesResult.loading) {\n    return <Skeleton />;\n  }\n  if (messagesResult.error) return <div>error</div>;\n  if (!messagesForNegotiation.length) return <div>nno ci sono messaggi</div>;\n  if (!messages) return null;\n  return (\n    <Container component='main' maxWidth='sm'>\n      <CssBaseline />\n      <BackButton />\n      <List>\n        {messagesForNegotiation.map((el) => (\n          <div key={el[0]}>\n            <MessageListEl messages={el[1]} id={el[0]} />\n          </div>\n        ))}\n      </List>\n    </Container>\n  );\n};\n\nexport default Messages;\n"],"sourceRoot":""}