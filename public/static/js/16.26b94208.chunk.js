(this["webpackJsonpwine-app-frontend"]=this["webpackJsonpwine-app-frontend"]||[]).push([[16],{454:function(e,n,t){"use strict";t.d(n,"a",(function(){return l}));var i=t(4),r=t(439),a=(t(0),t(41)),c=t(455),o=t.n(c),l=function(){return Object(i.jsx)(r.a,{"aria-label":"previous-page",color:"primary",size:"large",startIcon:Object(i.jsx)(o.a,{}),onClick:function(){return Object(a.c)(-1)},children:"Torna indietro"})}},535:function(e,n,t){"use strict";t.r(n);var i=t(4),r=t(28),a=t(0),c=t(438),o=t(437),l=t(14),s=t(19),d=t(454),j=t(155),u=t(439),b=t(441),O=t(443),f=t(442),h=t(527),x=t(468),v=function(e){var n=e.open,t=e.handleClose,r=e.content;return Object(i.jsx)("div",{children:Object(i.jsxs)(b.a,{open:n,onClose:t,"aria-labelledby":"responsive-dialog-title",children:[Object(i.jsx)(x.a,{id:"responsive-dialog-title",children:"Notifica app"}),Object(i.jsx)(f.a,{children:Object(i.jsx)(h.a,{color:"primary",children:r})}),Object(i.jsx)(O.a,{children:Object(i.jsx)(u.a,{autoFocus:!0,onClick:t,color:"primary",children:"Chiudi"})})]})})},p=t(24),m=t(470),g=t(449),y=t(35),C=t(445),w=t(532),N=t(528),k=t(444),_=t(431),B=t(511),V=t.n(B),S=t(510),T=t.n(S),A=t(492),E=t.n(A),I=t(432),J=t(433),W=t(434),z=t(480),F=t.n(z),M=t(41),P=function(e){var n=e.messages,t=e.id,r=Object(s.c)();if(!n)return null;var c=n.filter((function(e){return e.sentTo._id===(null===r||void 0===r?void 0:r._id)})),o=n.filter((function(e){return e.sentBy._id===(null===r||void 0===r?void 0:r._id)})),l=null===c||void 0===c?void 0:c.filter((function(e){return!e.isViewed})).length,d=c.length?c[0].sentBy.firstName:o[0].sentTo.firstName,j=c.length?c[0].negotiation.ad.wineName:o[0].negotiation.ad.wineName;return Object(i.jsxs)(I.a,{divider:!0,button:!0,component:a.forwardRef((function(e,n){return Object(i.jsx)(M.a,Object(p.a)({to:"/messaggi/".concat(t),ref:n},e))})),children:[Object(i.jsx)(J.a,{children:Object(i.jsx)(k.a,{badgeContent:l,color:"primary",children:Object(i.jsx)(F.a,{})})}),Object(i.jsx)(W.a,{primary:"Cantina ".concat(d," - ").concat(j)})]})},R=t(25),q=t(133),D=function(e){var n=e.notification,t=e.handleClick;return Object(i.jsxs)(I.a,{divider:!0,button:!0,onClick:function(){return t(n._id)},children:[Object(i.jsx)(J.a,{children:Object(i.jsx)(k.a,{badgeContent:n.isViewed?0:1,color:"primary",children:Object(i.jsx)(F.a,{})})}),Object(i.jsx)(W.a,{primary:n.content})]},n._id)};function G(e){var n=e.children,t=e.value,r=e.index,a=Object(m.a)(e,["children","value","index"]);return Object(i.jsx)("div",Object(p.a)(Object(p.a)({role:"tabpanel",hidden:t!==r,id:"full-width-tabpanel-".concat(r),"aria-labelledby":"full-width-tab-".concat(r)},a),{},{children:t===r&&Object(i.jsx)(g.a,{p:3,children:n})}))}function H(e){return{id:"full-width-tab-".concat(e),"aria-controls":"full-width-tabpanel-".concat(e)}}var K=function(e){var n,t,c=Object(q.c)(),o=Object(y.a)(),l=Object(s.c)(),d=a.useState(0),j=Object(r.a)(d,2),u=j[0],b=j[1],O=null===(n=e.messages)||void 0===n?void 0:n.filter((function(e){return"Amministratore"===e.sentBy.firstName})),f=null===(t=e.messages)||void 0===t?void 0:t.filter((function(e){return"Amministratore"!==e.sentBy.firstName})),h=Object(R.groupBy)(f,(function(e){return e.negotiation._id})),x=Object.entries(h).sort((function(e,n){return e[0].localeCompare(n[0])})),v=x.map((function(e){return e[1]})).flat(),m=null===O||void 0===O?void 0:O.filter((function(e){return!e.isViewed})).length,g=v.filter((function(e){return!e.isViewed&&e.sentBy._id!==(null===l||void 0===l?void 0:l._id)})).length;return Object(i.jsxs)("div",{className:c.paper,children:[Object(i.jsx)(C.a,{position:"static",color:"transparent",style:{boxShadow:"none"},children:Object(i.jsxs)(w.a,{value:u,onChange:function(e,n){b(n)},style:{color:"#6d1331"},indicatorColor:"secondary",textColor:"inherit",variant:"fullWidth","aria-label":"notifications",children:[Object(i.jsx)(N.a,Object(p.a)({icon:Object(i.jsx)(T.a,{}),label:Object(i.jsx)(k.a,{badgeContent:g,color:"primary",children:"Messaggi"})},H(0))),Object(i.jsx)(N.a,Object(p.a)({icon:Object(i.jsx)(V.a,{}),label:Object(i.jsx)(k.a,{badgeContent:m,color:"primary",children:"Notifiche"})},H(1)))]})}),Object(i.jsxs)(E.a,{axis:"rtl"===o.direction?"x-reverse":"x",index:u,onChangeIndex:function(e){b(e)},children:[Object(i.jsx)(G,{value:u,index:0,dir:o.direction,children:Object(i.jsx)(_.a,{children:x.map((function(e){return Object(i.jsx)(P,{messages:e[1],id:e[0]},e[0])}))})}),Object(i.jsx)(G,{value:u,index:1,dir:o.direction,children:Object(i.jsx)(_.a,{children:null===O||void 0===O?void 0:O.map((function(n){return Object(i.jsx)(D,{notification:n,handleClick:e.handleClickNotification},n._id)}))})})]})]})};n.default=function(){var e,n,t=Object(l.B)({fetchPolicy:"network-only",onError:function(e){Object(s.d)({type:"error",message:e.message})}}),u=t.data,b=t.loading,O=t.error,f=Object(l.v)({onError:function(e){Object(s.d)({type:"error",message:e.message})}}),h=Object(r.a)(f,2),x=h[0],p=h[1],m=a.useState(!1),g=Object(r.a)(m,2),y=g[0],C=g[1];return b?Object(i.jsx)(j.a,{}):O?Object(i.jsx)("div",{children:"error"}):Object(i.jsxs)(o.a,{component:"main",maxWidth:"sm",children:[Object(i.jsx)(c.a,{}),Object(i.jsx)(d.a,{}),Object(i.jsx)(K,{messages:null===u||void 0===u?void 0:u.messages,handleClickNotification:function(e){x({variables:{id:e}}),C(!0)}}),p.loading?Object(i.jsx)(j.a,{}):Object(i.jsx)(v,{open:y,handleClose:function(){C(!1)},content:null===(e=p.data)||void 0===e||null===(n=e.message)||void 0===n?void 0:n.content,loading:p.loading})]})}}}]);