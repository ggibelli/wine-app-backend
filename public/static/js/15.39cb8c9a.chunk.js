(this["webpackJsonpwine-app-frontend"]=this["webpackJsonpwine-app-frontend"]||[]).push([[15],{454:function(e,n,r){"use strict";r.d(n,"a",(function(){return s}));var i=r(4),t=r(439),o=(r(0),r(41)),l=r(455),a=r.n(l),s=function(){return Object(i.jsx)(t.a,{"aria-label":"previous-page",color:"primary",size:"large",startIcon:Object(i.jsx)(a.a,{}),onClick:function(){return Object(o.c)(-1)},children:"Torna indietro"})}},455:function(e,n,r){"use strict";var i=r(53),t=r(54);Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var o=t(r(0)),l=(0,i(r(55)).default)(o.createElement("path",{d:"M11.67 3.87L9.9 2.1 0 12l9.9 9.9 1.77-1.77L3.54 12z"}),"ArrowBackIos");n.default=l},539:function(e,n,r){"use strict";r.r(n);var i=r(4),t=r(56),o=r.n(t),l=r(24),a=r(82),s=r(28),d=(r(0),r(41)),u=r(14),c=r(21),p=r(71),m=r(114),b=r(381),j=r(383),v=function(e){var n=Object(p.d)({name:e.name,type:e.type}),r=Object(s.a)(n,2),t=r[0],o=r[1],a=o.error,d=o.touched;return Object(i.jsx)(b.a,Object(l.a)(Object(l.a)({required:!0},t),{},{fullWidth:!0,type:e.type,inputProps:{"aria-label":e.name,min:e.min,max:e.max,step:e.step},InputLabelProps:{style:{color:e.labelTextColor}},className:e.class,InputProps:{endAdornment:Object(i.jsx)(j.a,{position:"end",children:e.adornment}),className:e.inputTextColor,classes:{underline:e.underlineColor}},error:void 0!==a&&d,"data-testid":e.name,placeholder:e.placeholder,label:e.label,helperText:a}))},x=r(162),O=r(538),f=r(131),h=Object(f.a)({option:{color:"#000"},groupLabel:{color:"#707070"}}),y=function(e){var n=e.items,r=e.label,t=e.name,o=e.setFieldValue,a=e.defaultWine,d=e.labelTextColor,u=e.underlineColor,c=Object(p.d)({name:t}),m=Object(s.a)(c,2),j=(m[0],m[1]),v=j.error,x=j.touched,f=h(),y=n.map((function(e){return{regione:e.regione[0],denominazioneVino:e.denominazioneVino}}));return Object(i.jsx)(O.a,{"data-testid":"combobox-wines",options:y.sort((function(e,n){return-n.regione.localeCompare(e.regione)})),groupBy:function(e){return e.regione},getOptionSelected:function(e,n){return e.denominazioneVino===n.denominazioneVino},defaultValue:a?{regione:"",denominazioneVino:a}:null,classes:{option:f.option,groupLabel:f.groupLabel,inputRoot:u},getOptionLabel:function(e){return e.denominazioneVino},fullWidth:!0,onChange:function(e,n){o(t,null===n||void 0===n?void 0:n.denominazioneVino)},renderInput:function(e){return Object(i.jsx)(p.a,Object(l.a)(Object(l.a)({required:!0,component:b.a},e),{},{label:r,error:x&&void 0!==v,helperText:v,inputProps:Object(l.a)(Object(l.a)({},e.inputProps),{},{autoComplete:"new-password"}),InputLabelProps:{style:{color:d}}}))}})},g=r(439),C=r(91),B=r(235),S=r(232),z=r(231),q=r(386),w=function(e){var n=Object(p.d)({name:e.name}),r=Object(s.a)(n,2),t=r[0],o=r[1],a=o.error,d=o.touched;return Object(i.jsxs)(z.a,{fullWidth:!0,error:void 0!==a&&d,children:[Object(i.jsx)(B.a,{style:{color:e.labelColor},htmlFor:"select-label-".concat(e.name),children:e.label}),Object(i.jsx)(q.a,Object(l.a)(Object(l.a)({native:!0,className:e.underlineColor,classes:{root:e.underlineColor,icon:e.textColor},inputProps:{id:"select-label-".concat(e.name),name:t.name}},t),{},{children:e.options.map((function(e){return Object(i.jsx)("option",{value:e,children:e},e)}))})),Object(i.jsx)(S.a,{children:a})]})},T=r(478),V=r(440),A=r(481),N=r(479),P=r(480),L=r(476),F=function(e){var n=e.setFieldValue;return!0===Object(p.e)().values.isSameAddress?null:Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)(V.a,{item:!0,xs:12,children:Object(i.jsx)(N.a,{setFieldValue:n,name:"address.regione",label:"Regione",items:L.a})}),Object(i.jsx)(V.a,{item:!0,xs:12,children:Object(i.jsx)(P.a,{setFieldValue:n,name:"address.provincia",label:"Provincia"})}),Object(i.jsx)(V.a,{item:!0,xs:12,children:Object(i.jsx)(A.a,{setFieldValue:n,name:"address.comune",label:"Comune"})})]})},R=r(133),I=r(155),W={comune:"",provincia:"",regione:""},k=function(e){var n,r,t=e.onSubmit,o=e.adType,l=e.wines,a=(null===(n=l.data)||void 0===n?void 0:n.wines)?null===(r=l.data)||void 0===r?void 0:r.wines.map((function(e){return{denominazioneVino:e.denominazioneVino,regione:e.regione}})):null,s=Object(R.d)(),d=(new Date).getFullYear(),c={wineName:"",harvest:2015,abv:13.5,price:3,liters:100,sottoZona:"",menzione:"",metodoProduttivo:"",content:"",isSameAddress:!1,address:W};return l.loading?Object(i.jsx)(I.a,{}):l.error?Object(i.jsxs)("div",{children:["Error...",l.error.message]}):Object(i.jsx)(p.c,{initialValues:c,validationSchema:m.c({wineName:m.e().required("Required"),harvest:m.b().positive("L'anno deve essere positivo").moreThan(1900,"L'anno deve essere maggiore di 1900").lessThan(d,"L'anno non pu\xf2 essere maggiore di ".concat(d)).required("Required"),abv:m.b().positive("La gradazione alcolica deve essere positiva").lessThan(22,"La gradazione alcolica non pu\xf2 essere maggiore di 22").required("Required"),price:m.b().positive("Il prezzo al litro deve essere positivo").lessThan(100,"Questo prezzo \xe8 al litro").required("Required"),liters:m.b().positive("La quantit\xe0 deve essere positiva").required("Required"),menzione:m.e(),metodoProduttivo:m.e(),content:m.e().required("Required"),isSameAddress:m.a().required("Required"),address:m.c().when("isSameAddress",{is:!0,then:m.c().shape({comune:m.e(),provincia:m.e(),regione:m.e()}),otherwise:m.c().shape({comune:m.e().required("Required"),provincia:m.e().required("Required"),regione:m.e().required("Required")})})}),onSubmit:t,children:function(e){var n=e.isValid,r=e.dirty,t=e.setFieldValue;return Object(i.jsxs)(p.b,{className:o===u.l.Buy?s.form:s.formSell,children:[Object(i.jsx)(C.a,{component:"h3",variant:"h5",color:o===u.l.Buy?"textSecondary":"primary",children:"Dati prodotto"}),Object(i.jsx)(y,{name:"wineName",label:"Vino",defaultWine:c.wineName,items:a,setFieldValue:t,labelTextColor:o===u.l.Buy?"#fff":"#6d1331",underlineColor:o===u.l.Buy?s.underline:s.underlineSell}),Object(i.jsx)(x.a,{name:"harvest",type:"number",label:"Vendemmia",min:"1900",max:"".concat(d),step:"1",underlineColor:o===u.l.Buy?s.underline:s.underlineSell,placeholder:"Vendemmia anno",labelTextColor:o===u.l.Buy?"#fff":"#6d1331",inputTextColor:o===u.l.Buy?s.input:s.inputSell}),Object(i.jsx)(v,{name:"abv",type:"number",label:"Gradazione alcolica",min:"0",max:"22",step:"0.5",placeholder:"Esempio 13.5 vol",adornment:"%",underlineColor:o===u.l.Buy?s.underline:s.underlineSell,labelTextColor:o===u.l.Buy?"#fff":"#6d1331",inputTextColor:o===u.l.Buy?s.input:s.inputSell}),Object(i.jsx)(v,{name:"price",type:"number",label:"Prezzo richiesto al litro",min:"0",max:"100",step:"0.1",placeholder:"Esempio 3.5 euro",adornment:"\u20ac",underlineColor:o===u.l.Buy?s.underline:s.underlineSell,labelTextColor:o===u.l.Buy?"#fff":"#6d1331",inputTextColor:o===u.l.Buy?s.input:s.inputSell}),Object(i.jsx)(v,{name:"liters",type:"number",label:"Litri richiesti",min:"0",max:"999999",step:"1",placeholder:"Esempio 1000 litri",adornment:"l",underlineColor:o===u.l.Buy?s.underline:s.underlineSell,labelTextColor:o===u.l.Buy?"#fff":"#6d1331",inputTextColor:o===u.l.Buy?s.input:s.inputSell}),Object(i.jsx)(w,{name:"menzione",label:"Menzione del vino",options:Object.values(u.d),underlineColor:o===u.l.Buy?s.underline:s.underlineSell,labelColor:o===u.l.Buy?"#fff":"#6d1331",textColor:o===u.l.Buy?s.input:s.inputSell}),Object(i.jsx)(w,{name:"metodoProduttivo",label:"Metodo produttivo del vino",options:Object.values(u.g),underlineColor:o===u.l.Buy?s.underline:s.underlineSell,labelColor:o===u.l.Buy?"#fff":"#6d1331",textColor:o===u.l.Buy?s.input:s.inputSell}),Object(i.jsx)(x.a,{name:"content",type:"text",multiline:!0,label:"Descrizione",placeholder:"Vino veramente buono",underlineColor:o===u.l.Buy?s.underline:s.underlineSell,labelTextColor:o===u.l.Buy?"#fff":"#6d1331",inputTextColor:o===u.l.Buy?s.input:s.inputSell}),Object(i.jsx)(T.a,{name:"isSameAddress",label:"Indirizzo uguale a quello usato in registrazione",labelColor:o===u.l.Buy?"#fff":"#6d1331"}),Object(i.jsx)(F,{setFieldValue:t}),Object(i.jsx)(g.a,{className:o===u.l.Buy?s.submit:s.submitSell,type:"submit",disabled:!r||!n,children:"Submit"})]})}})},E=r(438),D=r(437),M=r(93),_=r(454);n.default=function(){var e,n,r=Object(c.c)(),t=Object(R.c)(),p="/buy"===Object(d.d)().pathname?u.l.Buy:u.l.Sell,m=Object(u.P)(),b=Object(u.r)({onError:function(e){return Object(c.d)({type:"error",message:"".concat(e.message)})},onCompleted:function(e){var n,r=e.createAd;if(null===r||void 0===r||null===(n=r.errors)||void 0===n?void 0:n.length){var i=r.errors.map((function(e){return null===e||void 0===e?void 0:e.text}));Object(c.d)({type:"error",message:"".concat(i.toString())})}else Object(c.d)({type:"success",message:"ad created"}),Object(d.c)("/annunci")},update:function(e,n){var r,i;Object(M.a)(e,null===(r=n.data)||void 0===r||null===(i=r.createAd)||void 0===i?void 0:i.response)}}),j=Object(s.a)(b,2),v=j[0],x=j[1],O=x.loading,f=x.client,h=function(){var i=Object(a.a)(o.a.mark((function i(t){var a,s,m;return o.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return t.isSameAddress&&(null===r||void 0===r?void 0:r.address)?e={regione:r.address.regione,provincia:r.address.provincia,comune:r.address.comune}:n=t.address,s={wineName:t.wineName,typeAd:p,typeProduct:u.m.AdWine,content:t.content,harvest:t.harvest,abv:t.abv,priceFrom:t.price,priceTo:t.price,litersFrom:t.liters,litersTo:t.liters,address:t.isSameAddress?e:n},Object(c.e)(Object(l.a)({},s)),m=null===r||void 0===r||null===(a=r.ads)||void 0===a?void 0:a.find((function(e){return"AdWine"===e.__typename&&e.wineName===s.wineName&&e.harvest===s.harvest&&e.typeAd===p&&!0===e.isActive})),i.next=6,f.query({query:u.b,variables:{wineName:s.wineName,typeProduct:u.m.AdWine,typeAd:p,offset:0,limit:4,orderBy:u.j.CreatedAtDesc}});case 6:if(!m){i.next=10;break}Object(d.c)("/annunci"),i.next=12;break;case 10:return i.next=12,v({variables:{input:s}});case 12:case"end":return i.stop()}}),i)})));return function(e){return i.apply(this,arguments)}}(),y=p===u.l.Buy?"comprare":"vendere",g=p===u.l.Buy?"acquirente":"venditore";return O?Object(i.jsx)(I.a,{}):Object(i.jsxs)(D.a,{component:"main",maxWidth:"xs",children:[Object(i.jsx)(E.a,{}),Object(i.jsx)(_.a,{}),Object(i.jsxs)("div",{className:t.paper,children:[Object(i.jsxs)(C.a,{component:"h1",variant:"h4",color:"primary",children:["Che cosa vuoi ",y,"?"]}),Object(i.jsxs)(C.a,{component:"p",color:"primary",children:["Inserisci i dati del prodotto che desideri ",y,", noi cercheremo per te il giusto ",g,"."]}),Object(i.jsx)(k,{wines:m,onSubmit:h,adType:p})]})]})}}}]);
//# sourceMappingURL=15.39cb8c9a.chunk.js.map