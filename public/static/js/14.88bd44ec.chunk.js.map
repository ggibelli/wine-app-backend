{"version":3,"sources":["components/BackButton.tsx","../node_modules/@material-ui/icons/ArrowBackIos.js","../node_modules/@material-ui/icons/MailOutline.js","components/MessageListEl.tsx","pages/Messages.tsx"],"names":["BackButton","aria-label","color","size","startIcon","onClick","navigate","_interopRequireDefault","require","_interopRequireWildcard","Object","defineProperty","exports","value","default","React","_default","createElement","d","MessageListEl","messages","id","me","myInfo","messagesForMe","filter","message","sentTo","_id","messagesFromMe","sentBy","unreadMessages","isViewed","length","recipient","firstName","ad","negotiation","wineName","ListItem","button","component","itemProps","ref","to","ListItemIcon","Badge","badgeContent","ListItemText","primary","Divider","Messages","useMessagesQuery","fetchPolicy","onError","error","notification","type","data","loading","messagesForNegotiationObj","_","groupBy","messagesForNegotiation","entries","sort","a","b","localeCompare","Loading","Container","maxWidth","CssBaseline","List","map","el"],"mappings":"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","file":"static/js/14.88bd44ec.chunk.js","sourcesContent":["import Button from '@material-ui/core/Button';\nimport * as React from 'react';\n// import { searchedWine } from '../cache';\nimport { navigate } from '@reach/router';\nimport ArrowBackIosIcon from '@material-ui/icons/ArrowBackIos';\n// import { TypeAd } from '../generated/graphql';\n\nexport const BackButton: React.FC = () => {\n  // // const searchedWineCache = searchedWine();\n  // // const { pathname } = useLocation();\n  // // if (searchedWineCache?.typeAd === TypeAd.Buy && pathname !== '/buy') {\n  // //   return (\n  // //     <Button\n  // //       component={Link}\n  // //       to='/buy'\n  // //       //variant='contained'\n  // //       color='primary'\n  // //       size='large'\n  // //       startIcon={<ArrowBackIosIcon />}\n  // //     >\n  // //       Compra\n  // //     </Button>\n  // //   );\n  // // } else if (\n  // //   searchedWineCache?.typeAd === TypeAd.Sell &&\n  // //   pathname !== '/sell'\n  // // ) {\n  //   return (\n  //     <Button\n  //       component={Link}\n  //       to='/sell'\n  //       //variant='contained'\n  //       color='primary'\n  //       size='large'\n  //       startIcon={<ArrowBackIosIcon />}\n  //     >\n  //       Vendi\n  //     </Button>\n  //   );\n  // } else\n  return (\n    <Button\n      aria-label='previous-page'\n      color='primary'\n      size='large'\n      startIcon={<ArrowBackIosIcon />}\n      onClick={() => navigate(-1)}\n    >\n      Torna indietro\n    </Button>\n  );\n};\n","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar React = _interopRequireWildcard(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M11.67 3.87L9.9 2.1 0 12l9.9 9.9 1.77-1.77L3.54 12z\"\n}), 'ArrowBackIos');\n\nexports.default = _default;","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar React = _interopRequireWildcard(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 14H4V8l8 5 8-5v10zm-8-7L4 6h16l-8 5z\"\n}), 'MailOutline');\n\nexports.default = _default;","/* eslint-disable @typescript-eslint/restrict-template-expressions */\nimport * as React from 'react';\nimport Divider from '@material-ui/core/Divider';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport MailOutlineIcon from '@material-ui/icons/MailOutline';\nimport Badge from '@material-ui/core/Badge';\nimport { Link as RouterLink } from '@reach/router';\nimport { myInfo } from '../cache';\nimport { MessagesQuery } from '../generated/graphql';\n\nexport const MessageListEl: React.FC<{\n  id: string;\n  messages: MessagesQuery['messages'];\n}> = ({ messages, id }) => {\n  const me = myInfo();\n  if (!messages) return null;\n  const messagesForMe = messages.filter(\n    (message) => message.sentTo._id === me?._id\n  );\n  const messagesFromMe = messages.filter(\n    (message) => message.sentBy._id === me?._id\n  );\n  const unreadMessages = messagesForMe?.filter((message) => !message.isViewed)\n    .length;\n  const recipient = messagesForMe.length\n    ? messagesForMe[0].sentBy.firstName\n    : messagesFromMe[0].sentTo.firstName;\n  // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment\n  const ad = messagesForMe.length\n    ? //@ts-expect-error I know is a adWine\n      (messagesForMe[0].negotiation.ad.wineName as string)\n    : //@ts-expect-error I know is a adWine\n      (messagesFromMe[0].negotiation.ad.wineName as string);\n\n  return (\n    <>\n      <ListItem\n        button\n        // eslint-disable-next-line react/display-name\n        component={React.forwardRef((itemProps, ref) => (\n          //ts ignore because followed the mui docs\n\n          <RouterLink\n            to={`/messaggi/${id}`}\n            // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n            //@ts-ignore\n            ref={ref}\n            {...itemProps}\n          />\n        ))}\n      >\n        <ListItemIcon>\n          <Badge badgeContent={unreadMessages} color='primary'>\n            <MailOutlineIcon />\n          </Badge>\n        </ListItemIcon>\n        <ListItemText\n          primary={\n            recipient === 'Amministratore'\n              ? 'Amministratore'\n              : `Cantina ${recipient} - ${ad}`\n          }\n        />\n      </ListItem>\n      <Divider />\n    </>\n  );\n};\n","import * as React from 'react';\nimport CssBaseline from '@material-ui/core/CssBaseline';\nimport Container from '@material-ui/core/Container';\nimport List from '@material-ui/core/List';\nimport { useMessagesQuery } from '../generated/graphql';\nimport _ from 'lodash';\nimport { MessageListEl } from '../components/MessageListEl';\nimport { notification } from '../cache';\nimport { RouteComponentProps } from '@reach/router';\nimport { BackButton } from '../components/BackButton';\nimport { Loading } from '../components/Loading';\n\nconst Messages: React.FC<RouteComponentProps> = () => {\n  const { data, loading, error } = useMessagesQuery({\n    fetchPolicy: 'network-only',\n    onError: (error) => {\n      notification({\n        type: 'error',\n        message: error.message,\n      });\n    },\n  });\n  const messages = data?.messages && data?.messages;\n  const messagesForNegotiationObj = _.groupBy(\n    messages,\n    (message) => message.negotiation._id\n  );\n  const messagesForNegotiation = Object.entries(\n    messagesForNegotiationObj\n  ).sort((a, b) => a[0].localeCompare(b[0]));\n  if (loading) {\n    return <Loading />;\n  }\n  if (error) return <div>error</div>;\n  if (!messagesForNegotiation.length) return <div>non ci sono messaggi</div>;\n  if (!messages) return null;\n  return (\n    <Container component='main' maxWidth='sm'>\n      <CssBaseline />\n      <BackButton />\n      <List>\n        {messagesForNegotiation.map((el) => (\n          <div key={el[0]}>\n            <MessageListEl messages={el[1]} id={el[0]} />\n          </div>\n        ))}\n      </List>\n    </Container>\n  );\n};\n\nexport default Messages;\n"],"sourceRoot":""}