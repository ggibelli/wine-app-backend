{"version":3,"sources":["../node_modules/@material-ui/icons/ExpandMore.js","containers/InfiniteScrollFetch.tsx","utils/useIntersectionHook.tsx","containers/CloseNegotiationButton.tsx","containers/CancelNegotiationButton.tsx","components/NegotiationModals/CloseNegotiationModal.tsx","containers/CreateReview.tsx","components/ReviewModal/index.tsx","../node_modules/@material-ui/core/esm/DialogTitle/DialogTitle.js","../node_modules/@material-ui/icons/Send.js","components/Chat/MessageChat.tsx","components/Chat/index.tsx","pages/Message.tsx"],"names":["_interopRequireDefault","require","_interopRequireWildcard","Object","defineProperty","exports","value","default","React","_default","createElement","d","useStyles","makeStyles","createStyles","root","display","flexDirection","alignItems","InfiniteScroll","props","classes","message","useLocation","pathname","split","rootMargin","threshold","entry","setEntry","node","setNode","observer","current","disconnect","window","IntersectionObserver","currentObserver","observe","useIntersect","ref","isOk","setIsOk","intersectionRatio","fetchMore","setIsLoading","isVisible","isLoading","className","CircularProgress","id","children","style","height","CloseNegotiationButton","handleClose","useUpdateNegotiationMutation","onCompleted","closedNegotiation","updateNegotiation","errors","length","errorMessages","map","error","text","notification","type","toString","onError","closeNegotiation","loading","handleCloseNegotiation","a","variables","negotiation","_id","isConcluded","Button","aria-label","disabled","onClick","CancelNegotiationButton","useDeleteNegotiationMutation","deleteNegotiation","update","cache","data","updateRemovedNeg","response","CloseNegotiationModal","isBuy","isMessage","open","setOpen","fullWidth","buyButton","sellButton","Dialog","onClose","aria-labelledby","DialogContent","DialogActions","color","CreateReview","review","closeModal","useCreateReviewMutation","createdReview","createReview","labels","0.5","1","1.5","2","2.5","3","3.5","4","4.5","5","CreateReviewModal","idUser","idNegotiation","setValue","hover","setHover","setReview","useStylesHook","classesTextField","useStylesForms","classesStars","useStyleRating","TypeAd","Sell","Buy","DialogTitle","name","precision","onChange","event","newValue","onChangeActive","newHover","Box","ml","TextField","multiline","rows","helperText","target","InputLabelProps","InputProps","inputSell","underline","underlineSell","label","placeholder","forUser","rating","content","_props$disableTypogra","disableTypography","other","_objectWithoutProperties","_extends","clsx","Typography","component","variant","withStyles","margin","padding","flex","MessageChat","me","myInfo","isMyMessage","sentBy","borderTopLeft","borderTopRight","data-testid","p","m","bgcolor","borderBottomLeftRadius","borderBottomRightRadius","borderTopRightRadius","borderTopLeftRadius","Grid","container","justify","align","dateSent","Chat","propsMessage","messageContent","setMessageContent","divRef","scroll","top","document","body","offsetHeight","left","behavior","messages","recipient","sentTo","overflowY","handleFetchMore","borderWidth","borderColor","backgroundColor","paddingTop","rowsMax","inputProps","endAdornment","InputAdornment","position","IconButton","newMessage","handleCreate","Message","useParams","useMessagesNegotiationQuery","fetchPolicy","offset","limit","messagesForNegotiation","setSortedMessage","reverse","sortedMessage","isFirstRender","setIsFirstRender","useCreateMessageMutation","console","createdMessage","messageCreated","createMessage","sortedNewMessages","pageCount","undefined","Loading","Container","maxWidth","CssBaseline"],"mappings":"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","file":"static/js/8.81b6daac.chunk.js","sourcesContent":["\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar React = _interopRequireWildcard(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z\"\n}), 'ExpandMore');\n\nexports.default = _default;","import { useLocation } from '@reach/router';\nimport * as React from 'react';\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\nimport { useIntersect } from '../utils/useIntersectionHook';\nimport { makeStyles, createStyles } from '@material-ui/core';\nimport CircularProgress from '@material-ui/core/CircularProgress';\n\ninterface InfiniteScrollProps {\n  children: React.ReactNode;\n  fetchMore: () => void;\n  isVisible: boolean;\n  isLoading: boolean;\n  setIsLoading?: React.Dispatch<React.SetStateAction<boolean>>;\n}\n\nconst useStyles = makeStyles(() =>\n  createStyles({\n    root: {\n      display: 'flex',\n      flexDirection: 'column',\n      alignItems: 'center',\n    },\n  })\n);\n\nexport const InfiniteScroll: React.FC<InfiniteScrollProps> = (props) => {\n  const classes = useStyles();\n  const { pathname } = useLocation();\n  const message = pathname.split('/')[1] === 'messaggi';\n  const [ref, entry] = useIntersect({ threshold: 0 });\n  const [isOk, setIsOk] = React.useState<boolean>(true);\n  React.useEffect(() => {\n    if (entry && entry?.intersectionRatio > 0 && isOk) {\n      void props.fetchMore();\n      props.setIsLoading && props.setIsLoading(true);\n      setIsOk(false);\n    } else if (entry?.intersectionRatio === 0 && !isOk) {\n      setIsOk(true);\n      props.setIsLoading && props.setIsLoading(false);\n    }\n  }, [entry?.intersectionRatio]);\n  if (message) {\n    return (\n      <>\n        {props.isVisible ? (\n          props.isLoading ? (\n            <div className={classes.root}>\n              <CircularProgress />\n            </div>\n          ) : (\n            <div className={classes.root} id='page-bottom-boundary' ref={ref}>\n              {' '}\n              <ExpandMoreIcon />\n            </div>\n          )\n        ) : null}\n        {props.children}\n      </>\n    );\n  }\n\n  return (\n    <div className={classes.root}>\n      {props.children}\n      {props.isVisible ? (\n        props.isLoading ? (\n          <CircularProgress />\n        ) : (\n          <div id='page-bottom-boundary' ref={ref} style={{ height: 30 }}>\n            {' '}\n            <ExpandMoreIcon />\n          </div>\n        )\n      ) : null}\n    </div>\n  );\n};\n","import * as React from 'react';\n\nexport const useIntersect = ({\n  root = null,\n  rootMargin = '0px',\n  threshold = 0,\n}): [\n  React.Dispatch<React.SetStateAction<HTMLDivElement | null>>,\n  IntersectionObserverEntry | null\n] => {\n  const [entry, setEntry] = React.useState<IntersectionObserverEntry | null>(\n    null\n  );\n  const [node, setNode] = React.useState<HTMLDivElement | null>(null);\n\n  const observer = React.useRef<IntersectionObserver | null>(null);\n  React.useEffect(() => {\n    if (observer.current) {\n      observer.current.disconnect();\n    }\n    observer.current = new window.IntersectionObserver(\n      ([entry]) => setEntry(entry),\n      { root, rootMargin, threshold }\n    );\n\n    const { current: currentObserver } = observer;\n\n    if (node) {\n      currentObserver.observe(node);\n    }\n    return () => currentObserver.disconnect();\n  }, [node, root, rootMargin, threshold]);\n  return [setNode, entry];\n};\n","import Button from '@material-ui/core/Button';\nimport * as React from 'react';\nimport { notification } from '../cache';\nimport { useUpdateNegotiationMutation } from '../generated/graphql';\n\nexport const CloseNegotiationButton: React.FC<{\n  id: string;\n  handleClose: () => void;\n}> = ({ id, handleClose }) => {\n  const [closeNegotiation, { loading }] = useUpdateNegotiationMutation({\n    onCompleted: (closedNegotiation) => {\n      if (closedNegotiation.updateNegotiation?.errors?.length) {\n        const errorMessages = closedNegotiation.updateNegotiation?.errors.map(\n          (error) => error?.text\n        );\n        notification({\n          type: 'error',\n          message: `${errorMessages.toString()}`,\n        });\n      } else {\n        notification({\n          message: 'trattativa chiusa con successo',\n          type: 'success',\n        });\n      }\n    },\n    onError: (error) => notification({ type: 'error', message: error.message }),\n  });\n\n  const handleCloseNegotiation = async () => {\n    handleClose();\n    await closeNegotiation({\n      variables: { negotiation: { _id: id, isConcluded: true } },\n    });\n  };\n\n  return (\n    <Button\n      aria-label='close-negotiation'\n      disabled={loading}\n      onClick={handleCloseNegotiation}\n    >\n      Dichiara chiusa la trattativa\n    </Button>\n  );\n};\n","import Button from '@material-ui/core/Button';\nimport * as React from 'react';\nimport { notification } from '../cache';\nimport { useDeleteNegotiationMutation } from '../generated/graphql';\nimport { updateRemovedNeg } from '../utils/updateCache';\n\nexport const CancelNegotiationButton: React.FC<{\n  id: string;\n  handleClose: () => void;\n}> = ({ id, handleClose }) => {\n  const [closeNegotiation, { loading }] = useDeleteNegotiationMutation({\n    onCompleted: (closedNegotiation) => {\n      if (closedNegotiation.deleteNegotiation?.errors?.length) {\n        const errorMessages = closedNegotiation.deleteNegotiation?.errors.map(\n          (error) => error?.text\n        );\n        notification({\n          type: 'error',\n          message: `${errorMessages.toString()}`,\n        });\n      } else {\n        notification({\n          message: 'trattativa cancellata con successo',\n          type: 'info',\n        });\n      }\n    },\n    onError: (error) => notification({ type: 'error', message: error.message }),\n    update: (cache, { data }) => {\n      updateRemovedNeg(cache, data?.deleteNegotiation?.response);\n    },\n  });\n\n  const handleCloseNegotiation = async () => {\n    handleClose();\n    await closeNegotiation({\n      variables: { id },\n    });\n  };\n\n  return (\n    <Button\n      aria-label='cancel-negotiation'\n      disabled={loading}\n      onClick={handleCloseNegotiation}\n    >\n      Cancella la trattativa\n    </Button>\n  );\n};\n","import * as React from 'react';\nimport Button from '@material-ui/core/Button';\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport { CloseNegotiationButton } from '../../containers/CloseNegotiationButton';\nimport { CancelNegotiationButton } from '../../containers/CancelNegotiationButton';\nimport { useStyles } from '../../utils/styleHook';\n\nexport const CloseNegotiationModal: React.FC<{\n  id: string;\n  isBuy?: boolean;\n  isMessage?: boolean;\n}> = ({ id, isBuy, isMessage }) => {\n  const classes = useStyles();\n  const [open, setOpen] = React.useState<boolean>(false);\n  const handleModal = () => {\n    setOpen(true);\n  };\n  const handleClose = () => {\n    setOpen(false);\n  };\n  isBuy = !!isMessage;\n  return (\n    <>\n      <Button\n        fullWidth\n        aria-label='close-negotiation-popup'\n        className={isBuy ? classes.buyButton : classes.sellButton}\n        onClick={handleModal}\n      >\n        Chiudi trattativa\n      </Button>\n      <div style={{ display: 'none' }}>\n        <Dialog\n          open={open}\n          onClose={handleClose}\n          aria-labelledby='close-negotiation'\n        >\n          <DialogContent>\n            <CancelNegotiationButton id={id} handleClose={handleClose} />\n            <CloseNegotiationButton id={id} handleClose={handleClose} />\n          </DialogContent>\n          <DialogActions>\n            <Button onClick={handleClose} color='primary'>\n              Cancel\n            </Button>\n          </DialogActions>\n        </Dialog>\n      </div>\n    </>\n  );\n};\n","import Button from '@material-ui/core/Button';\nimport * as React from 'react';\nimport { notification } from '../cache';\nimport { useCreateReviewMutation, ReviewInput } from '../generated/graphql';\n\nexport const CreateReview: React.FC<{\n  review: ReviewInput;\n  disabled: boolean;\n  closeModal?: () => void;\n}> = ({ review, disabled, closeModal }) => {\n  const [createReview, { loading }] = useCreateReviewMutation({\n    onCompleted: (createdReview) => {\n      if (createdReview.createReview?.errors?.length) {\n        const errorMessages = createdReview.createReview?.errors.map(\n          (error) => error?.text\n        );\n        notification({\n          type: 'error',\n          message: `${errorMessages.toString()}`,\n        });\n      } else {\n        notification({\n          type: 'success',\n          message: 'Recensione creata con successo',\n        });\n      }\n    },\n\n    onError: (error) => notification({ type: 'error', message: error.message }),\n  });\n\n  const handleCreateReview = () => {\n    closeModal && closeModal();\n    void createReview({\n      variables: {\n        review,\n      },\n    });\n  };\n\n  return (\n    <Button\n      disabled={disabled || loading}\n      aria-label='review'\n      onClick={handleCreateReview}\n      color='primary'\n    >\n      Recensisci\n    </Button>\n  );\n};\n","import Button from '@material-ui/core/Button';\nimport * as React from 'react';\nimport { TypeAd } from '../../generated/graphql';\nimport {\n  StyledRating,\n  useStyles as useStylesHook,\n  useStylesForms,\n  useStyleRating,\n} from '../../utils/styleHook';\nimport Box from '@material-ui/core/Box';\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport TextField from '@material-ui/core/TextField';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport { CreateReview } from '../../containers/CreateReview';\n\nconst labels: { [index: string]: string } = {\n  0.5: 'Useless',\n  1: 'Useless+',\n  1.5: 'Poor',\n  2: 'Poor+',\n  2.5: 'Ok',\n  3: 'Ok+',\n  3.5: 'Good',\n  4: 'Good+',\n  4.5: 'Excellent',\n  5: 'Excellent+',\n};\n\nexport const CreateReviewModal: React.FC<{\n  idNegotiation: string;\n  idUser: string;\n  type: TypeAd;\n  isMessage?: boolean;\n}> = ({ idUser, idNegotiation, type, isMessage }) => {\n  const [open, setOpen] = React.useState<boolean>(false);\n  const [value, setValue] = React.useState<number | null>(2);\n  const [hover, setHover] = React.useState<number>(-1);\n  const [review, setReview] = React.useState<string>('');\n  const handleChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n    setReview(event.target.value);\n  };\n  const classes = useStylesHook();\n  const classesTextField = useStylesForms();\n  const classesStars = useStyleRating();\n  const handleModal = () => {\n    setOpen(true);\n  };\n  const handleClose = () => {\n    setOpen(false);\n  };\n  type = isMessage ? TypeAd.Sell : type;\n  return (\n    <>\n      <Button\n        fullWidth\n        aria-label='review'\n        className={type === TypeAd.Buy ? classes.buyButton : classes.sellButton}\n        onClick={handleModal}\n      >\n        Lascia una recensione\n      </Button>\n      <div style={{ display: 'none' }}>\n        <Dialog\n          open={open}\n          onClose={handleClose}\n          aria-labelledby='form-dialog-title'\n        >\n          <DialogTitle id='form-dialog-title'>\n            Recensisci la trattativa\n          </DialogTitle>\n\n          <DialogContent>\n            <div className={classesStars.root}>\n              <StyledRating\n                name='hover-feedback'\n                value={value}\n                precision={0.5}\n                onChange={(event, newValue) => {\n                  setValue(newValue);\n                }}\n                onChangeActive={(event, newHover) => {\n                  setHover(newHover);\n                }}\n              />\n              {value !== null && (\n                <Box ml={2}>{labels[hover !== -1 ? hover : value]}</Box>\n              )}\n            </div>\n            <TextField\n              color='primary'\n              multiline\n              rows={4}\n              value={review}\n              error={review.length > 0 && review.length <= 5}\n              helperText='Lunghezza minima 5 caratteri'\n              onChange={handleChange}\n              InputLabelProps={{\n                style: { color: '#6d1331' },\n              }}\n              InputProps={{\n                className: classesTextField.inputSell,\n                classes: {\n                  underline: classesTextField.underlineSell,\n                },\n              }}\n              id='outlined-multiline-flexible'\n              label='Recensione'\n              placeholder='Ottima persona con cui....'\n            />\n          </DialogContent>\n          <DialogActions>\n            <Button\n              aria-label='close-modal'\n              onClick={handleClose}\n              color='primary'\n            >\n              Cancel\n            </Button>\n            <CreateReview\n              disabled={review.length <= 5}\n              review={{\n                forUser: idUser,\n                rating: value as number,\n                negotiation: idNegotiation,\n                content: review,\n                type: type,\n              }}\n              closeModal={handleClose}\n            />\n          </DialogActions>\n        </Dialog>\n      </div>\n    </>\n  );\n};\n","import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport * as React from 'react';\nimport PropTypes from 'prop-types';\nimport clsx from 'clsx';\nimport withStyles from '../styles/withStyles';\nimport Typography from '../Typography';\nexport var styles = {\n  /* Styles applied to the root element. */\n  root: {\n    margin: 0,\n    padding: '16px 24px',\n    flex: '0 0 auto'\n  }\n};\nvar DialogTitle = /*#__PURE__*/React.forwardRef(function DialogTitle(props, ref) {\n  var children = props.children,\n      classes = props.classes,\n      className = props.className,\n      _props$disableTypogra = props.disableTypography,\n      disableTypography = _props$disableTypogra === void 0 ? false : _props$disableTypogra,\n      other = _objectWithoutProperties(props, [\"children\", \"classes\", \"className\", \"disableTypography\"]);\n\n  return /*#__PURE__*/React.createElement(\"div\", _extends({\n    className: clsx(classes.root, className),\n    ref: ref\n  }, other), disableTypography ? children : /*#__PURE__*/React.createElement(Typography, {\n    component: \"h2\",\n    variant: \"h6\"\n  }, children));\n});\nprocess.env.NODE_ENV !== \"production\" ? DialogTitle.propTypes = {\n  // ----------------------------- Warning --------------------------------\n  // | These PropTypes are generated from the TypeScript type definitions |\n  // |     To update them edit the d.ts file and run \"yarn proptypes\"     |\n  // ----------------------------------------------------------------------\n\n  /**\n   * The content of the component.\n   */\n  children: PropTypes.node,\n\n  /**\n   * Override or extend the styles applied to the component.\n   * See [CSS API](#css) below for more details.\n   */\n  classes: PropTypes.object,\n\n  /**\n   * @ignore\n   */\n  className: PropTypes.string,\n\n  /**\n   * If `true`, the children won't be wrapped by a typography component.\n   * For instance, this can be useful to render an h4 instead of the default h2.\n   */\n  disableTypography: PropTypes.bool\n} : void 0;\nexport default withStyles(styles, {\n  name: 'MuiDialogTitle'\n})(DialogTitle);","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar React = _interopRequireWildcard(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M2.01 21L23 12 2.01 3 2 10l15 2-15 2z\"\n}), 'Send');\n\nexports.default = _default;","import { Typography } from '@material-ui/core';\nimport Box from '@material-ui/core/Box';\nimport Grid from '@material-ui/core/Grid';\nimport * as React from 'react';\nimport { myInfo } from '../../cache';\nimport { MessageDetailsFragment } from '../../generated/graphql';\n\nexport const MessageChat: React.FC<{\n  message: MessageDetailsFragment | null;\n}> = ({ message }) => {\n  if (!message) return null;\n  const me = myInfo();\n  const isMyMessage = message.sentBy._id === me?._id;\n  const borderTopLeft = isMyMessage ? 12 : 0;\n  const borderTopRight = isMyMessage ? 0 : 12;\n  return (\n    <Box\n      data-testid='message-box'\n      display='flex'\n      flexDirection={isMyMessage ? 'row-reverse' : 'row'}\n      p={1}\n      m={1}\n    >\n      <Box\n        p={1}\n        color='white'\n        bgcolor={isMyMessage ? '#6d1331' : '#707070'}\n        style={{\n          borderBottomLeftRadius: 12,\n          borderBottomRightRadius: 12,\n          borderTopRightRadius: borderTopRight,\n          borderTopLeftRadius: borderTopLeft,\n        }}\n      >\n        <Typography variant='body1'>{message.content}</Typography>\n        <Grid container justify='flex-end'>\n          <Typography align='right' variant='caption'>\n            {message.dateSent}\n          </Typography>\n        </Grid>\n      </Box>\n    </Box>\n  );\n};\n","import TextField from '@material-ui/core/TextField';\nimport * as React from 'react';\nimport {\n  MessageInput,\n  MessagesNegotiationQuery,\n} from '../../generated/graphql';\nimport { MessageChat } from './MessageChat';\nimport SendIcon from '@material-ui/icons/Send';\nimport InputAdornment from '@material-ui/core/InputAdornment';\nimport { IconButton } from '@material-ui/core';\nimport { myInfo } from '../../cache';\nimport { InfiniteScroll } from '../../containers/InfiniteScrollFetch';\nimport { DeepExtractType } from 'ts-deep-extract-types';\nimport { CreateReviewModal } from '../../components/ReviewModal';\nimport { CloseNegotiationModal } from '../NegotiationModals/CloseNegotiationModal';\n\ninterface PropMessages {\n  propsMessage: {\n    isLoading: boolean;\n    messages: DeepExtractType<\n      MessagesNegotiationQuery,\n      ['messagesForNegotiation']\n    >['messages'];\n    isVisible: boolean;\n    handleCreate: (message: MessageInput) => Promise<void>;\n    handleFetchMore: () => Promise<void>;\n  };\n}\n\nexport const Chat: React.FC<PropMessages> = ({ propsMessage }) => {\n  const me = myInfo();\n  const [messageContent, setMessageContent] = React.useState<string>('');\n  const [isLoading, setIsLoading] = React.useState<boolean>(false);\n  const divRef = React.useRef<null | HTMLDivElement>(null);\n  React.useEffect(() => {\n    if (divRef.current) {\n      if (isLoading) return;\n      divRef.current.scroll({\n        top: document.body.offsetHeight + 1000000,\n        left: 0,\n        behavior: 'smooth',\n      });\n    }\n    // const timeoutId = timerIdRef.current;\n    return () => {\n      // clearTimeout(timeoutId);\n    };\n  }, [propsMessage.messages]);\n  const message = propsMessage.messages ? propsMessage.messages[0] : null;\n  if (!message) {\n    return null;\n  }\n  const handleChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n    setMessageContent(event.target.value);\n  };\n  const recipient =\n    message.sentBy._id === me?._id ? message.sentTo._id : message.sentBy._id;\n  const handleCreateMessage = () => {\n    const newMessage = {\n      content: messageContent,\n      sentTo: recipient,\n      negotiation: message.negotiation._id,\n    };\n    void propsMessage.handleCreate(newMessage);\n\n    setMessageContent('');\n  };\n  if (!propsMessage.messages) return null;\n  return (\n    <>\n      <div\n        style={{\n          height: '75vh',\n          margin: 0,\n          padding: 0,\n          overflowY: 'scroll',\n        }}\n        ref={divRef}\n      >\n        <InfiniteScroll\n          fetchMore={propsMessage.handleFetchMore}\n          isLoading={propsMessage.isLoading}\n          isVisible={propsMessage.isVisible}\n          setIsLoading={setIsLoading}\n        >\n          {propsMessage.messages?.map((message) => (\n            <MessageChat key={message?._id} message={message} />\n          ))}\n        </InfiniteScroll>\n      </div>\n      <hr style={{ borderWidth: 1, borderColor: '#6d1331' }} />\n      <div\n        style={{\n          height: '10vh',\n          backgroundColor: '#fff',\n          paddingTop: 0,\n        }}\n      >\n        {message.negotiation.isConcluded ? (\n          <CreateReviewModal\n            idNegotiation={message.negotiation._id}\n            idUser={recipient}\n            isMessage\n            type={message.negotiation.type}\n          />\n        ) : (\n          <CloseNegotiationModal id={message.negotiation._id} isMessage />\n        )}\n        <TextField\n          fullWidth\n          multiline\n          rowsMax={2}\n          variant='outlined'\n          name='content'\n          type='text'\n          placeholder=''\n          label=''\n          value={messageContent}\n          onChange={handleChange}\n          inputProps={{ 'aria-label': 'input-message' }}\n          InputProps={{\n            endAdornment: (\n              <InputAdornment position='end'>\n                <IconButton\n                  aria-label='send'\n                  disabled={!messageContent}\n                  onClick={handleCreateMessage}\n                >\n                  <SendIcon />\n                </IconButton>\n              </InputAdornment>\n            ),\n          }}\n        />\n      </div>\n    </>\n  );\n};\n","import * as React from 'react';\nimport CssBaseline from '@material-ui/core/CssBaseline';\nimport Container from '@material-ui/core/Container';\nimport { RouteComponentProps } from '@reach/router';\nimport {\n  MessagesNegotiationQuery,\n  useMessagesNegotiationQuery,\n  useCreateMessageMutation,\n  MessageInput,\n} from '../generated/graphql';\nimport { useParams } from '@reach/router';\nimport { notification } from '../cache';\nimport { Chat } from '../components/Chat';\nimport { DeepExtractType } from 'ts-deep-extract-types';\nimport { Loading } from '../components/Loading';\n\nconst Message: React.FC<RouteComponentProps> = () => {\n  // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment\n  const { id }: { id: string } = useParams();\n  const { data, loading, error, fetchMore } = useMessagesNegotiationQuery({\n    fetchPolicy: 'network-only',\n    variables: { id, offset: 0, limit: 20 },\n    onCompleted: ({ messagesForNegotiation }) => {\n      setSortedMessage([...(messagesForNegotiation?.messages as [])].reverse());\n    },\n  });\n  React.useEffect(() => {\n    if (sortedMessage?.length)\n      setSortedMessage(\n        [...(data?.messagesForNegotiation?.messages as [])].reverse()\n      );\n  }, [data]);\n  const [isFirstRender, setIsFirstRender] = React.useState<boolean>(true);\n  const [isLoading, setIsLoading] = React.useState<boolean>(false);\n  const [sortedMessage, setSortedMessage] = React.useState<\n    DeepExtractType<\n      MessagesNegotiationQuery,\n      ['messagesForNegotiation']\n    >['messages']\n  >([]);\n  const message = data?.messagesForNegotiation?.messages?.length\n    ? data?.messagesForNegotiation.messages[0]\n    : null;\n  const [createMessage] = useCreateMessageMutation({\n    onError: (error) => {\n      console.error(error);\n      notification({ type: 'error', message: error.message });\n    },\n    onCompleted: (createdMessage) => {\n      const messageCreated = createdMessage?.createMessage?.response;\n      if (createdMessage.createMessage?.errors?.length) {\n        const errorMessages = createdMessage.createMessage?.errors.map(\n          (error) => error?.text\n        );\n        notification({\n          type: 'error',\n          message: `${errorMessages.toString()}`,\n        });\n        return;\n      }\n\n      if (sortedMessage?.length) {\n        setSortedMessage([...sortedMessage, messageCreated] as DeepExtractType<\n          MessagesNegotiationQuery,\n          ['messagesForNegotiation']\n        >['messages']);\n      }\n    },\n  });\n\n  const handleFetchMore = async () => {\n    if (isFirstRender) {\n      setIsFirstRender(false);\n      return;\n    }\n    if (sortedMessage?.length && fetchMore) {\n      setIsLoading(true);\n      try {\n        const { data } = await fetchMore({\n          variables: {\n            offset: sortedMessage.length,\n          },\n        });\n        const sortedNewMessages =\n          data.messagesForNegotiation?.messages?.reverse();\n        setSortedMessage([...(sortedNewMessages as []), ...sortedMessage]);\n        setIsLoading(false);\n      } catch (e) {\n        setIsLoading(false);\n\n        console.error(e);\n      }\n    }\n  };\n  const handleCreate = async (message: MessageInput) => {\n    await createMessage({\n      variables: { message },\n    });\n  };\n  const propsMessage = {\n    isLoading: isLoading,\n    messages: sortedMessage,\n    isVisible:\n      data?.messagesForNegotiation?.messages?.length !==\n      data?.messagesForNegotiation?.pageCount,\n    handleCreate,\n    handleFetchMore,\n  };\n  if (loading || propsMessage.isVisible === undefined) {\n    return <Loading />;\n  }\n  if (error) {\n    return <div>error</div>;\n  }\n  if (!message) return <div>niente mess ancora</div>;\n\n  if (!data?.messagesForNegotiation?.messages?.length) {\n    return null;\n  }\n  return (\n    <Container component='main' maxWidth='sm'>\n      <CssBaseline />\n      <Chat propsMessage={propsMessage} />\n    </Container>\n  );\n};\n\nexport default Message;\n"],"sourceRoot":""}